#include<syslog.h>

#include<sys/types.h>
#include<sys/select.h>
#include<unistd.h>


#include<stdio.h>

#include<netinet/in.h>


#include<sys/param.h>
#include<sys/time.h>





#include<stdlib.h>
#include<sys/stat.h>


#include<pwd.h>




#include<arpa/inet.h>
#include<inttypes.h>
#include<sys/socket.h>
#include<poll.h>
#include<time.h>
#include<errno.h>
#include<ctype.h>
#include<string.h>


#include<limits.h>
#include<fcntl.h>


#include<pthread.h>
#define ALLID  ((ID)-1)
#define ALLIDS(idl)         ((idl)->b_nmax == ALLIDSBLOCK)
#define ALLIDSBLOCK 0 
#define APPROX_PREFIX '~'  
#define BACKEND_OPT_DBLOCK_INSIDE_TXN          0x02
#define BACKEND_OPT_MANAGE_ENTRY_BEFORE_DBLOCK 0x04
#define BACKEND_OPT_NO_RUV_UPDATE              0x01
#define BDB_BACKEND           "libback-ldbm" 
#define BDB_CL_FILENAME       "replication_changelog.db"
#define BDB_DNFORMAT          "dn-4514"      
#define BDB_DNFORMAT_VERSION  "1"            
#define BDB_IMPL              "bdb"
#define BDB_NEWIDL            "newidl"       
#define BDB_RDNFORMAT         "rdn-format"   
#define BDB_RDNFORMAT_VERSION "3"            
#define BE_CHANGELOG_FILE     "replication_changelog"
#define BE_INDEX_ADD           1
#define BE_INDEX_DEL           2
#define BE_INDEX_DONT_ENCRYPT 16                       
#define BE_INDEX_EQUALITY     32                       
#define BE_INDEX_NORMALIZED SLAPI_ATTR_FLAG_NORMALIZED 
#define BE_INDEX_PRESENCE      4                       
#define BE_INDEX_TOMBSTONE     8                       
#define CACHE_ADD(cache, p, a) cache_add((cache), (void *)(p), (void **)(a))
#define CACHE_LOCK(cache)      cache_lock((cache))
#define CACHE_REMOVE(cache, p) cache_remove((cache), (void *)(p))
#define CACHE_RETURN(cache, p) cache_return((cache), (void **)(p))
#define CACHE_TYPE_DN    1
#define CACHE_TYPE_ENTRY 0
#define CACHE_UNLOCK(cache)    cache_unlock((cache))
#define CHANGELOG_BACKUPDIR ".repl_changelog_backup"
#define CONT_PREFIX   '\\' 
#define DBLAYER_ARCHIVE_MODE                0x8
#define DBLAYER_AUX_ID2ENTRY_TMP 0x1
#define DBLAYER_CLEAN_RECOVER_MODE        0x100
#define DBLAYER_EXPORT_MODE                 0x4
#define DBLAYER_IMPORT_MODE                 0x1
#define DBLAYER_INDEX_MODE                 0x80
#define DBLAYER_NORMAL_MODE                 0x2
#define DBLAYER_NO_DBTHREADS_MODE        0x1000
#define DBLAYER_RESTORE_MASK (DBLAYER_RESTORE_MODE | DBLAYER_RESTORE_NO_RECOVERY_MODE)
#define DBLAYER_RESTORE_MODE               0x10
#define DBLAYER_RESTORE_NO_RECOVERY_MODE   0x20
#define DBLAYER_TEST_MODE                  0x40
#define DBLOCK_INSIDE_TXN(li)          (li->li_backend_opt_level & BACKEND_OPT_DBLOCK_INSIDE_TXN)
#define DBOPEN_CREATE   0x1 
#define DBOPEN_TRUNCATE 0x2 
#define DBT_EQ(L, R) \
    ((L)->dsize == (R)->dsize && !memcmp((L)->dptr, (R)->dptr, (L)->dsize))
#define DBT_FREE_PAYLOAD(d) slapi_ch_free(&((d).data))
#define DBVERSION_ACTION 0x2
#define DBVERSION_ALL 0xffffffff
#define DBVERSION_COMPATIBLE 0x10
#define DBVERSION_DNFORMAT 0x4
#define DBVERSION_FILENAME "DBVERSION"
#define DBVERSION_NEED_DN2RDN       0x1000  
#define DBVERSION_NEED_IDL_NEW2OLD   0x200
#define DBVERSION_NEED_IDL_OLD2NEW   0x100
#define DBVERSION_NEED_RDN2DN       0x2000  
#define DBVERSION_NEWIDL 0x1
#define DBVERSION_NEW_IDL     0x2
#define DBVERSION_NOT_SUPPORTED 0x10000000
#define DBVERSION_NO_UPGRADE           0x0
#define DBVERSION_OLD_IDL     0x1
#define DBVERSION_RDNFORMAT 0x2
#define DBVERSION_RDN_FORMAT  0x4
#define DBVERSION_SOL        0x40
#define DBVERSION_TYPE   0x1
#define DBVERSION_UPGRADABLE 0x20
#define DBVERSION_UPGRADE_3_4        0x400  
#define DBVERSION_UPGRADE_4_4        0x800  
#define DBVERSION_UPGRADE_4_5       0x4000  
#define DB_BUFFER_SMALL ENOMEM

#define DEFAULT_ALLIDSTHRESHOLD  4000
#define DEFAULT_BLOCKSIZE 8192
#define DEFAULT_CACHE_ENTRIES    -1 
#define DEFAULT_CACHE_SIZE       (uint64_t)0
#define DEFAULT_CACHE_SIZE_STR   "0"
#define DEFAULT_DBCACHE_SIZE     33554432
#define DEFAULT_DBCACHE_SIZE_STR "33554432"
#define DEFAULT_DNCACHE_MAXCOUNT -1 
#define DEFAULT_DNCACHE_SIZE     (uint64_t)16777216
#define DEFAULT_DNCACHE_SIZE_STR "16777216"
#define DEFAULT_IDL_TUNE         1
#define DEFAULT_IMPORT_INDEX_BUFFER_SIZE 0
#define DEFAULT_MODE             0600
#define DEFAULT_SEARCH_TUNE      0
#define ENTRY_STATE_CREATING   0x2  
#define ENTRY_STATE_DELETED    0x1  
#define ENTRY_STATE_INVALID    0x8  
#define ENTRY_STATE_NOTINCACHE 0x4  
#define EQ_PREFIX     '='  
#define FILTER_TEST_THRESHOLD (NIDS)10
#define GIGABYTE (1024 * MEGABYTE)
#define HASHLOC(mem, node) (u_long) & (((mem *)0L)->node)
#define ID2ENTRY "id2entry" 
#define IDLIST_MIN_BLOCK_SIZE 8
#define IDL_FETCH_RETRY_COUNT  5           
#define IDL_INSERT_ALLIDS     2
#define IDL_INSERT_NORMAL     1
#define IDL_INSERT_NOW_ALLIDS 3
#define IDL_NIDS(idl)       (idl ? (idl)->b_nids : (NIDS)0)
#define ID_FMT "%u" 
#define ID_WARNING_THRESHOLD (MAXID * 0.9)
#define IMPORT_SUBCOUNT_HASHTABLE_SIZE 500 
#define INDBLOCK    0 
#define INDEX_ALLIDS_FLAG_AND 0x01
#define INDEX_ANY (INDEX_PRESENCE | INDEX_EQUALITY | INDEX_APPROX | INDEX_SUB | INDEX_RULES | INDEX_VLV | INDEX_SUBTREE)
#define INDEX_APPROX    0x04
#define INDEX_ATTR_SUBSTRBEGIN  "nsSubStrBegin"
#define INDEX_ATTR_SUBSTREND    "nsSubStrEnd"
#define INDEX_ATTR_SUBSTRMIDDLE "nsSubStrMiddle"
#define INDEX_EQUALITY  0x02
#define INDEX_FROMINIT  0x20
#define INDEX_OFFLINE 0x1000 
#define INDEX_PRESENCE  0x01
#define INDEX_RULES     0x40
#define INDEX_SUB       0x08
#define INDEX_SUBSTRBEGIN  0
#define INDEX_SUBSTREND    2
#define INDEX_SUBSTRMIDDLE 1
#define INDEX_SUBTREE  0x100
#define INDEX_UNKNOWN   0x10
#define INDEX_VLV       0x80
#define INDIRECT_BLOCK(idl) ((idl)->b_nids == INDBLOCK)
#define INITIALUSN       (PRUint64)(-1)
#define INSTANCE_CHANGELOG_SUFFIX "-changelog"
#define INSTANCE_DB_SUFFIX        "-db"
#define INST_FLAG_BUSY     0x0001 
#define INST_FLAG_READONLY 0x0002 
#define IS_INDEXED(a) (a & INDEX_ANY)
#define LDBM_ALLIDSLIMIT_AT "nsIDListScanLimit"
#define LDBM_ANCESTORID_STR                "ancestorid"
#define LDBM_CACHE_RETRY_COUNT 1000        
#define LDBM_DATABASE_TYPE_NAME "ldbm database"
#define LDBM_ENTRYDN_STR                   SLAPI_ATTR_ENTRYDN
#define LDBM_ENTRYRDN_STR                  "entryrdn"
#define LDBM_ERROR_FOUND_DUPDN 9999
#define LDBM_FILENAME_SUFFIX LDBM_SUFFIX
#define LDBM_LOOKTHROUGHLIMIT_AT "nsLookThroughLimit"
#define LDBM_NUMSUBORDINATES_STR           "numsubordinates"
#define LDBM_OS_ERR_IS_DISKFULL(err) ((err) == ENOSPC || (err) == EFBIG)
#define LDBM_PAGEDALLIDSLIMIT_AT "nsPagedIDListScanLimit"
#define LDBM_PAGEDLOOKTHROUGHLIMIT_AT "nsPagedLookThroughLimit"
#define LDBM_PARENTID_STR                  SLAPI_ATTR_PARENTID
#define LDBM_PSEUDO_ATTR_DEFAULT ".default"
#define LDBM_RANGELOOKTHROUGHLIMIT_AT "nsRangeSearchLookThroughLimit"
#define LDBM_SUFFIX     ".db"
#define LDBM_SUFFIX_OLD ".db4"
#define LDBM_TOMBSTONE_NUMSUBORDINATES_STR "tombstonenumsubordinates"
#define LDBM_VERSION      "Netscape-ldbm/7.0"         
#define LDBM_VERSION_30   "Netscape-ldbm/3.0"
#define LDBM_VERSION_31   "Netscape-ldbm/3.1"
#define LDBM_VERSION_40   "Netscape-ldbm/4.0"
#define LDBM_VERSION_50   "Netscape-ldbm/5.0"
#define LDBM_VERSION_60   "Netscape-ldbm/6.0"         
#define LDBM_VERSION_61   "Netscape-ldbm/6.1"         
#define LDBM_VERSION_62   "Netscape-ldbm/6.2"         
#define LDBM_VERSION_BASE "Netscape-ldbm/"
#define LDBM_VERSION_MAXBUF 64
#define LDBM_VERSION_NEW  "Netscape-ldbm/7.0_NEW"     
#define LDBM_VERSION_OLD  "Netscape-ldbm/7.0_CLASSIC" 
#define LI_BDB_IMPL         0x20
#define LI_DEFAULT_IMPL_FLAG  LI_BDB_IMPL 
#define LI_FORCE_MOD_CONFIG 0x10
#define LI_LMDB_IMPL        0x40
#define LMDB_IMPL             "lmdb"
#define MANAGE_ENTRY_BEFORE_DBLOCK(li) (li->li_backend_opt_level & BACKEND_OPT_MANAGE_ENTRY_BEFORE_DBLOCK)
#define MAXDBCACHE 20
#define MAXID  ((ID)-3)
#define MEGABYTE (1024 * 1024)
#define MINCACHESIZE             (uint64_t)512000
#define MKDIR(path, mode) mkdir((path), (mode))
#define NEW_IDL_DEFAULT  0
#define NEW_IDL_NOOP     1 
#define NEW_IDL_NO_ALLID 2 
#define NOID   ((ID)-2)
#define NO_RUV_UPDATE(li)              (li->li_backend_opt_level & BACKEND_OPT_NO_RUV_UPDATE)
#define PARENTUPDATE_ADD      0x1
#define PARENTUPDATE_CREATE_TOMBSTONE 0x10
#define PARENTUPDATE_DEL      0x2
#define PARENTUPDATE_DELETE_TOMBSTONE 0x20
#define PARENTUPDATE_MASK (PARENTUPDATE_ADD | PARENTUPDATE_DEL | PARENTUPDATE_RESURECT)
#define PARENTUPDATE_RESURECT 0x4
#define PARENTUPDATE_TOMBSTONE_MASK (PARENTUPDATE_CREATE_TOMBSTONE | PARENTUPDATE_DELETE_TOMBSTONE)
#define PRES_PREFIX   '+'
#define RETRY_CACHE_LOCK       2           
#define RETRY_TIMES 50
#define RULE_PREFIX   ':'  
#define SERIALLOCK(li) (li->li_fat_lock)
#define SIGNEDINITIALUSN (-1)
#define SLAPD_LDBM_MIN_MAXIDS 4000
#define SR_FLAG_CAN_SKIP_FILTER_TEST 1 
#define SUBLEN 3
#define SUB_PREFIX    '*'  
#define TOMBSTONE_INCLUDED 0x1 



#define dptr  data
#define dsize size
#define CONDIF_DB_ONLINE_IMPORT_ENCRYPT "nsslapd-online-import-encrypt"
#define CONFIG_BACKEND_IMPLEMENT "nsslapd-backend-implement"
#define CONFIG_BACKEND_OPT_LEVEL "nsslapd-backend-opt-level"
#define CONFIG_BYPASS_FILTER_TEST "nsslapd-search-bypass-filter-test"
#define CONFIG_CACHE_AUTOSIZE "nsslapd-cache-autosize"
#define CONFIG_CACHE_AUTOSIZE_SPLIT "nsslapd-cache-autosize-split"
#define CONFIG_DBCACHESIZE "nsslapd-dbcachesize"
#define CONFIG_DBNCACHE "nsslapd-dbncache"
#define CONFIG_DB_CACHE "nsslapd-db-cache"
#define CONFIG_DB_CHECKPOINT_INTERVAL "nsslapd-db-checkpoint-interval"
#define CONFIG_DB_CIRCULAR_LOGGING "nsslapd-db-circular-logging"
#define CONFIG_DB_COMPACTDB_INTERVAL "nsslapd-db-compactdb-interval"
#define CONFIG_DB_DEADLOCK_POLICY "nsslapd-db-deadlock-policy"
#define CONFIG_DB_DEBUG "nsslapd-db-debug"
#define CONFIG_DB_DEBUG_CHECKPOINTING "nsslapd-db-debug-checkpointing"
#define CONFIG_DB_DURABLE_TRANSACTIONS "nsslapd-db-durable-transaction"
#define CONFIG_DB_HOME_DIRECTORY "nsslapd-db-home-directory"
#define CONFIG_DB_IDL_DIVISOR "nsslapd-db-idl-divisor"
#define CONFIG_DB_INDEX_PAGE_SIZE "nsslapd-db-index-page-size" 
#define CONFIG_DB_LOCK "nsslapd-db-locks"
#define CONFIG_DB_LOCKDOWN "nsslapd-db-lockdown"
#define CONFIG_DB_LOGBUF_SIZE "nsslapd-db-logbuf-size"
#define CONFIG_DB_LOGDIRECTORY "nsslapd-db-logdirectory"
#define CONFIG_DB_LOGFILE_SIZE "nsslapd-db-logfile-size"
#define CONFIG_DB_NAMED_REGIONS "nsslapd-db-named-regions"
#define CONFIG_DB_OLD_IDL_MAXIDS "nsslapd-db-old-idl-maxids"
#define CONFIG_DB_PAGE_SIZE "nsslapd-db-page-size"
#define CONFIG_DB_PRIVATE_IMPORT_MEM "nsslapd-db-private-import-mem"
#define CONFIG_DB_PRIVATE_MEM "nsslapd-db-private-mem"
#define CONFIG_DB_SHM_KEY "nsslapd-db-shm-key"
#define CONFIG_DB_SPIN_COUNT "nsslapd-db-spin-count"
#define CONFIG_DB_TRANSACTION_BATCH "nsslapd-db-transaction-batch-val"
#define CONFIG_DB_TRANSACTION_BATCH_MAX_SLEEP "nsslapd-db-transaction-batch-max-wait"
#define CONFIG_DB_TRANSACTION_BATCH_MIN_SLEEP "nsslapd-db-transaction-batch-min-wait"
#define CONFIG_DB_TRANSACTION_LOGGING "nsslapd-db-transaction-logging"
#define CONFIG_DB_TRANSACTION_WAIT "nsslapd-db-transaction-wait"
#define CONFIG_DB_TRICKLE_PERCENTAGE "nsslapd-db-trickle-percentage"
#define CONFIG_DB_TX_MAX "nsslapd-db-tx-max"
#define CONFIG_DB_VERBOSE "nsslapd-db-verbose"
#define CONFIG_DIRECTORY "nsslapd-directory"
#define CONFIG_ENTRYRDN_NOANCESTORID "nsslapd-noancestorid"
#define CONFIG_ENTRYRDN_SWITCH "nsslapd-subtree-rename-switch"
#define CONFIG_EXCLUDE_FROM_EXPORT "nsslapd-exclude-from-export"
#define CONFIG_EXCLUDE_FROM_EXPORT_DEFAULT_VALUE \
    "entrydn entryid dncomp parentid numSubordinates tombstonenumsubordinates entryusn"
#define CONFIG_FLAG_ALLOW_RUNNING_CHANGE 4
#define CONFIG_FLAG_ALWAYS_SHOW 2
#define CONFIG_FLAG_PREVIOUSLY_SET 1
#define CONFIG_FLAG_SKIP_DEFAULT_SETTING 8
#define CONFIG_IDLISTSCANLIMIT "nsslapd-idlistscanlimit"
#define CONFIG_IDL_SWITCH "nsslapd-idl-switch"
#define CONFIG_IDL_UPDATE "nsslapd-idl-update"
#define CONFIG_IMPORT_CACHESIZE "nsslapd-import-cachesize"
#define CONFIG_IMPORT_CACHE_AUTOSIZE "nsslapd-import-cache-autosize"
#define CONFIG_INDEX_BUFFER_SIZE "nsslapd-index-buffer-size"
#define CONFIG_INSTANCE "nsslapd-instance"
#define CONFIG_INSTANCE_CACHEMEMSIZE "nsslapd-cachememsize"
#define CONFIG_INSTANCE_CACHESIZE "nsslapd-cachesize"
#define CONFIG_INSTANCE_DIR "nsslapd-directory"
#define CONFIG_INSTANCE_DNCACHEMEMSIZE "nsslapd-dncachememsize"
#define CONFIG_INSTANCE_READONLY "nsslapd-readonly"
#define CONFIG_INSTANCE_REQUIRE_INDEX "nsslapd-require-index"
#define CONFIG_INSTANCE_REQUIRE_INTERNALOP_INDEX "nsslapd-require-internalop-index"
#define CONFIG_INSTANCE_SUFFIX "nsslapd-suffix"
#define CONFIG_LDBM_DN "cn=config,cn=ldbm database,cn=plugins,cn=config"
#define CONFIG_LOOKTHROUGHLIMIT "nsslapd-lookthroughlimit"
#define CONFIG_MAXPASSBEFOREMERGE "nsslapd-maxpassbeforemerge"
#define CONFIG_MODE "nsslapd-mode"
#define CONFIG_PAGEDIDLISTSCANLIMIT "nsslapd-pagedidlistscanlimit"
#define CONFIG_PAGEDLOOKTHROUGHLIMIT "nsslapd-pagedlookthroughlimit"
#define CONFIG_PHASE_INITIALIZATION 1
#define CONFIG_PHASE_INTERNAL 4
#define CONFIG_PHASE_RUNNING 3
#define CONFIG_PHASE_STARTUP 2
#define CONFIG_RANGELOOKTHROUGHLIMIT "nsslapd-rangelookthroughlimit"
#define CONFIG_SERIAL_LOCK "nsslapd-serial-lock"
#define CONFIG_TYPE_INT 3       
#define CONFIG_TYPE_INT_OCTAL 5 
#define CONFIG_TYPE_LONG 4      
#define CONFIG_TYPE_ONOFF 1     
#define CONFIG_TYPE_SIZE_T 6    
#define CONFIG_TYPE_STRING 2    
#define CONFIG_TYPE_UINT64 7    
#define CONFIG_USE_LEGACY_ERRORCODE "nsslapd-do-not-use-vlv-error"
#define CONFIG_USE_VLV_INDEX "nsslapd-search-use-vlv-index"
#define LDBM_INSTANCE_CONFIG_DONT_WRITE 1

#define FE_RC_SENT_RESULT 1

#define DSE_BACKEND "frontend-internal"
#define DSE_OPERATION_READ 0x100
#define DSE_OPERATION_WRITE 0x200
#define DSE_SCHEMA "schema-internal"
#define FILTER_STRCPY_ESCAPE_RECHARS 0x01
#define LDAP_DEBUG_ACL        0x00000080  
#define LDAP_DEBUG_ACLSUMMARY 0x00040000  
#define LDAP_DEBUG_ALERT      0x00400000  
#define LDAP_DEBUG_ALL_LEVELS 0xFFFFFF
#define LDAP_DEBUG_ANY        0x00004000  
#define LDAP_DEBUG_ARGS       0x00000004  
#define LDAP_DEBUG_BACKLDBM   0x00080000  
#define LDAP_DEBUG_BER        0x00000010  
#define LDAP_DEBUG_CACHE      0x00008000  
#define LDAP_DEBUG_CONFIG     0x00000040  
#define LDAP_DEBUG_CONNS      0x00000008  
#define LDAP_DEBUG_CRIT       0x00800000  
#define LDAP_DEBUG_DEBUG      0x10000000  
#define LDAP_DEBUG_EMERG      0x00200000  
#define LDAP_DEBUG_ERR        0x01000000  
#define LDAP_DEBUG_FILTER     0x00000020  
#define LDAP_DEBUG_HOUSE      0x00001000  
#define LDAP_DEBUG_INFO       0x08000000  
#define LDAP_DEBUG_NOTICE     0x04000000  
#define LDAP_DEBUG_NUNCSTANS  0x00100000  
#define LDAP_DEBUG_PACKETS    0x00000002  
#define LDAP_DEBUG_PARSE      0x00000800  
#define LDAP_DEBUG_PLUGIN     0x00010000  
#define LDAP_DEBUG_REPL       0x00002000  
#define LDAP_DEBUG_SHELL      0x00000400  
#define LDAP_DEBUG_STATS      0x00000100  
#define LDAP_DEBUG_STATS2     0x00000200  
#define LDAP_DEBUG_TIMING     0x00020000  
#define LDAP_DEBUG_TRACE      0x00000001  
#define LDAP_DEBUG_WARNING    0x02000000  
#define SLAPI_SYNTAXLENGTH_NONE (-1) 

#define BSD_TIME 1 
#define CTIME(c, b, l) ctime(c)
#define EHOSTUNREACH WSAEHOSTUNREACH
#define EMSGSIZE WSAEMSGSIZE
#define EWOULDBLOCK WSAEWOULDBLOCK
#define FD_CLR(n, p) ((p)->fds_bits[(n) / NFDBITS] &= ~(1 << ((n) % NFDBITS)))
#define FD_ISSET(n, p) ((p)->fds_bits[(n) / NFDBITS] & (1 << ((n) % NFDBITS)))
#define FD_SET(n, p) ((p)->fds_bits[(n) / NFDBITS] |= (1 << ((n) % NFDBITS)))
#define FD_SETSIZE 32
#define FD_ZERO(p) bzero((char *)(p), sizeof(*(p)))
#define GETATTR(fd, tiop) ioctl((fd), TIOCGETP, (caddr_t)(tiop))
#define GETFLAGS(tio) (tio).sg_flags
#define GETHOSTBYADDR(a, al, t, h, b, bl, e) \
    gethostbyaddr(a, al, t)
#define GETHOSTBYADDR_BUF_T GETHOSTBYADDR_buf_t






#define MAXPATHLEN _MAX_PATH


#define NFDBITS 32
#define OPENLOG_OPTIONS LOG_PID

#define SAFEMEMCPY(d, s, n) BlockMoveData((Ptr)s, (Ptr)d, n)
#define SETATTR(fd, tiop) ioctl((fd), TIOCSETP, (caddr_t)(tiop))
#define SETFLAGS(tio, flags) (tio).sg_flags = (flags)
#define SIG_FN void 
#define STRTOK(s1, s2, l) strtok(s1, s2)


#define TERMFLAG_TYPE int
#define TERMIO_TYPE struct sgttyb
#define TOLOWER(c) (isascii(c) && isupper(c) ? _tolower(c) : c)
#define TOUPPER(c) (isascii(c) && islower(c) ? _toupper(c) : c)





#define WAITSTATUSTYPE union wait
#define WAIT_FLAGS (WNOHANG | WUNTRACED | WCONTINUED)

#define bzero(a, b) memset(a, 0, b)
#define getpid _getpid
#define ioctl ioctlsocket
#define sleep(a) Sleep(a * 1000)
#define strcasecmp strcmpi
#define strncasecmp _strnicmp
#define AVL_INORDER 2
#define AVL_NOMORE -6
#define AVL_POSTORDER 3
#define AVL_PREORDER 1
#define EH 0
#define LH -1
#define NULLAVL ((Avlnode *)NULL)
#define RH 1


#define avl_getone(x) (x == 0 ? 0 : (x)->avl_data)
#define avl_onenode(x) (x == 0 || ((x)->avl_left == 0 && (x)->avl_right == 0))
#define ATTRIBUTE_DELETED  3
#define ATTRIBUTE_NOTFOUND 1
#define ATTRIBUTE_PRESENT  2
#define ATTR_NSDS5_REPLCONFLICT "nsds5ReplConflict"
#define CHAIN_ROOT_UPDATE_LOCAL    1
#define CHAIN_ROOT_UPDATE_REFERRAL 2
#define CHAIN_ROOT_UPDATE_REJECT   0
#define COMPONENT_BASE_DN "cn=components,cn=config"
#define COMPONENT_CERT_AUTH "cn=certificate-based authentication," COMPONENT_BASE_DN
#define COMPONENT_PWPOLICY "cn=password policy," COMPONENT_BASE_DN
#define COMPONENT_RESLIMIT "cn=resource limits," COMPONENT_BASE_DN
#define COMPONENT_ROLES "cn=roles," COMPONENT_BASE_DN
#define COMPONENT_SASL "cn=sasl," COMPONENT_BASE_DN
#define CSN_COMPARE_SKIP_SUBSEQ 0x1
#define CSN_STRSIZE (_CSN_VALIDCSN_STRLEN + 1)
#define CSN_TYPE_ATTRIBUTE_DELETED   0x03
#define CSN_TYPE_NONE                0x01
#define CSN_TYPE_UNKNOWN             0x00
#define CSN_TYPE_VALUE_DELETED       0x05
#define CSN_TYPE_VALUE_DISTINGUISHED 0x06
#define CSN_TYPE_VALUE_UPDATED       0x04
#define DSE_SCHEMA_LOCKED            0x0020  
#define DSE_SCHEMA_NO_BACKEND 0x0004  
#define DSE_SCHEMA_NO_CHECK   0x0002  
#define DSE_SCHEMA_NO_GLOCK          0x0010  
#define DSE_SCHEMA_NO_LOAD    0x0001  
#define DSE_SCHEMA_USER_DEFINED_ONLY 0x0100  
#define DSE_SCHEMA_USE_PRIV_SCHEMA   0x0200  
#define ENTRY_DNCSN_INCREASING 0x1 
#define LAST_REV_ENTRY 2
#define LDAP_FILTER_EQUALITY_FAST 0xaaL
#define LDAP_MOD_IGNORE 0x100
#define LS_INCRSIZE 256
#define MAX_REPLICA_ID 65535
#define NDN_DEFAULT_SIZE 20971520 
#define OBJSET_ALREADY_EXISTS 1
#define OBJSET_NO_SUCH_OBJECT 2
#define OBJSET_SUCCESS 0
#define OC_CONSUMER "consumer"
#define OC_SUPPLIER "supplier"
#define OP_FLAG_ACTION_INVOKE_FOR_REPLOP 0x000400
#define OP_FLAG_ACTION_LOG_ACCESS 0x000040
#define OP_FLAG_ACTION_LOG_AUDIT 0x000080
#define OP_FLAG_ACTION_LOG_CHANGES 0x000200
#define OP_FLAG_ACTION_NOLOG 0x008000            
#define OP_FLAG_ACTION_SCHEMA_CHECK 0x000100
#define OP_FLAG_ACTION_SKIP_PWDPOLICY 0x02000000 
#define OP_FLAG_BULK_IMPORT 0x800000             
#define OP_FLAG_CENOTAPH_ENTRY 0x004000
#define OP_FLAG_GET_EFFECTIVE_RIGHTS 0x000004
#define OP_FLAG_INTERNAL SLAPI_OP_FLAG_INTERNAL 
#define OP_FLAG_NEVER_CACHE 0x200000             
#define OP_FLAG_NEVER_CHAIN SLAPI_OP_FLAG_NEVER_CHAIN         
#define OP_FLAG_NOOP 0x01000000                  
#define OP_FLAG_PAGED_RESULTS 0x040000           
#define OP_FLAG_PS 0x000001
#define OP_FLAG_PS_CHANGESONLY 0x000002
#define OP_FLAG_REPLICATED 0x000008             
#define OP_FLAG_REPL_FIXUP 0x000010             
#define OP_FLAG_REPL_RUV 0x020000                
#define OP_FLAG_RESURECT_ENTRY 0x002000
#define OP_FLAG_REVERSE_CANDIDATE_ORDER 0x100000 
#define OP_FLAG_SERVER_SIDE_SORTING 0x080000     
#define OP_FLAG_SKIP_MODIFIED_ATTRS 0x010000     
#define OP_FLAG_TOMBSTONE_ENTRY SLAPI_OP_FLAG_TOMBSTONE_ENTRY 
#define OP_FLAG_TOMBSTONE_FIXUP 0x400000         
#define PLUGIN_BASE_DN "cn=plugins,cn=config"
#define PRLDAP_SET_PORT(myaddr, myport) \
    ((myaddr)->raw.family == PR_AF_INET6 ? ((myaddr)->ipv6.port = PR_htons(myport)) : ((myaddr)->inet.port = PR_htons(myport)))
#define READ_ONLY_REPLICA_ID MAX_REPLICA_ID
#define REV_STARTED 1
#define SLAPI_COMPONENT_NAME_LDAPSDK "LDAP sdk"
#define SLAPI_COMPONENT_NAME_NSPR    "Netscape Portable Runtime"
#define SLAPI_DRYRUN             0x10             
#define SLAPI_ENTRY_LDAPSUBENTRY 2
#define SLAPI_ENTRY_VATTR_NOT_RESOLVED    -1
#define SLAPI_ENTRY_VATTR_RESOLVED_ABSENT -2
#define SLAPI_ENTRY_VATTR_RESOLVED_EXISTS  0
#define SLAPI_MB_CREDENTIALS "nsmultiplexorcredentials"
#define SLAPI_MTN_LOCAL    0x1
#define SLAPI_MTN_PRIVATE  0x2
#define SLAPI_MTN_READONLY 0x4
#define SLAPI_PLUGIN_DATABASE 1
#define SLAPI_PLUGIN_DB_ABANDON_FN                208
#define SLAPI_PLUGIN_DB_ABORT_FN                  221
#define SLAPI_PLUGIN_DB_ADD_FN                    206
#define SLAPI_PLUGIN_DB_ARCHIVE2DB_FN             222
#define SLAPI_PLUGIN_DB_BEGIN_FN                  219
#define SLAPI_PLUGIN_DB_BIND_FN                   200
#define SLAPI_PLUGIN_DB_COMMIT_FN                 220
#define SLAPI_PLUGIN_DB_COMPARE_FN                203
#define SLAPI_PLUGIN_DB_CONFIG_FN                 209
#define SLAPI_PLUGIN_DB_CTRL_INFO_FN              292
#define SLAPI_PLUGIN_DB_DB2ARCHIVE_FN             223
#define SLAPI_PLUGIN_DB_DB2INDEX_FN               228
#define SLAPI_PLUGIN_DB_DB2LDIF_FN                218
#define SLAPI_PLUGIN_DB_DBVERIFY_FN               236
#define SLAPI_PLUGIN_DB_DELETE_FN                 207
#define SLAPI_PLUGIN_DB_ENTRY_FN                  214
#define SLAPI_PLUGIN_DB_FREE_RESULT_SET_FN        225
#define SLAPI_PLUGIN_DB_GET_INFO_FN               290
#define SLAPI_PLUGIN_DB_LDIF2DB_FN                217
#define SLAPI_PLUGIN_DB_MODIFY_FN                 204
#define SLAPI_PLUGIN_DB_MODRDN_FN                 205
#define SLAPI_PLUGIN_DB_NEXT_SEARCH_ENTRY_EXT_FN  229
#define SLAPI_PLUGIN_DB_NEXT_SEARCH_ENTRY_FN      224
#define SLAPI_PLUGIN_DB_NO_ACL                    250
#define SLAPI_PLUGIN_DB_PREV_SEARCH_RESULTS_FN    239
#define SLAPI_PLUGIN_DB_REFERRAL_FN               215
#define SLAPI_PLUGIN_DB_RESULT_FN                 216
#define SLAPI_PLUGIN_DB_RMDB_FN                   280
#define SLAPI_PLUGIN_DB_SEARCH_FN                 202
#define SLAPI_PLUGIN_DB_SEARCH_RESULTS_RELEASE_FN 238
#define SLAPI_PLUGIN_DB_SEQ_FN                    213
#define SLAPI_PLUGIN_DB_SET_INFO_FN               291
#define SLAPI_PLUGIN_DB_TEST_FN                   227
#define SLAPI_PLUGIN_DB_UNBIND_FN                 201
#define SLAPI_PLUGIN_DB_UPGRADEDB_FN              235
#define SLAPI_PLUGIN_DB_UPGRADEDNFORMAT_FN        240
#define SLAPI_PLUGIN_DB_WIRE_IMPORT_FN            234
#define SLAPI_PLUGIN_DEFAULT_CONFIG "cn=plugin default config,cn=config"
#define SLAPI_REP_CREDENTIALS "nsds5ReplicaCredentials"
#define SLAPI_RTN_BIT_FETCH_EXISTING_DN_ENTRY       0
#define SLAPI_RTN_BIT_FETCH_EXISTING_UNIQUEID_ENTRY 4
#define SLAPI_RTN_BIT_FETCH_NEWPARENT_ENTRY         2
#define SLAPI_RTN_BIT_FETCH_PARENT_ENTRY            1
#define SLAPI_RTN_BIT_FETCH_TARGET_ENTRY            3
#define SLAPI_SHUTDOWN_DISKFULL 2
#define SLAPI_SHUTDOWN_EXIT     3
#define SLAPI_SHUTDOWN_SIGNAL   1
#define SLAPI_UPGRADEDB_DN2RDN    0x4  
#define SLAPI_UPGRADEDB_FORCE     0x1  
#define SLAPI_UPGRADEDB_SKIPINIT  0x2  
#define SLAPI_UPGRADEDNFORMAT     0x8  
#define SLAPI_UPGRADEDNFORMAT_V1 0x20 
#define UID_UPDATE_INTERVAL 600000 
#define UID_UPDATE_SHUTDOWN -1     
#define VALUE_DELETED  3
#define VALUE_NOTFOUND 1
#define VALUE_PRESENT  2

#define _CSN_REPLID_STRSIZE 4
#define _CSN_SEQNUM_STRSIZE 4
#define _CSN_SUBSEQNUM_STRSIZE 4
#define _CSN_TSTAMP_STRSIZE 8
#define _CSN_VALIDCSN_STRLEN (_CSN_TSTAMP_STRSIZE + _CSN_SEQNUM_STRSIZE + \
                              _CSN_REPLID_STRSIZE + _CSN_SUBSEQNUM_STRSIZE)

#define slapi_log_err(level, subsystem, fmt, ...)
#define SLAPI_BIND_FAIL_OR_ANONYMOUS 1 
#define SLAPI_CONFIG_ARGC 42     
#define SLAPI_CONFIG_ARGV 43     
#define SLAPI_CONFIG_FILENAME 40 
#define SLAPI_CONFIG_LINENO 41   
#define SLAPI_CONN_AUTHTYPE 144  
#define SLAPI_CONN_CLIENTIP 145 
#define SLAPI_CONN_SERVERIP 146 

#define SLAPI_REQUESTOR_ISUPDATEDN SLAPI_IS_REPLICATED_OPERATION

#define ACLPLUGIN_ACCESS_DEFAULT              0
#define ACLPLUGIN_ACCESS_GET_EFFECTIVE_RIGHTS 5
#define ACLPLUGIN_ACCESS_MODRDN               4
#define ACLPLUGIN_ACCESS_READ_ON_ATTR         2
#define ACLPLUGIN_ACCESS_READ_ON_ENTRY        1
#define ACLPLUGIN_ACCESS_READ_ON_VLV          3
#define BACK_CRYPT_OUTBUFF_EXTLEN 16
#define BERLEN_T "lu"
#define BERTAG_T "lu"
#define BV_HAS_DATA(bv) ((bv != NULL) && (bv->bv_len > 0) && (bv->bv_val != NULL))
#define DEFINETOSTR(xxx) #xxx
#define DSE_FLAG_PLUGIN 0x0004
#define DSE_FLAG_POSTOP 0x0002
#define DSE_FLAG_PREOP  0x0001
#define ESC_AND_NORM_NEXT_VAL "__ESC__AND__NORM__NEXT__VAL__"
#define ESC_NEXT_VAL "__ESC__NEXT__VAL__"
#define LBER_END_OF_SEQORSET ((ber_tag_t)-2) 
#define LBER_OVERFLOW ((ber_tag_t)-3) 
#define LBER_SOCKET int
#define LDAP_ALL_OPERATIONAL_ATTRS "+"
#define LDAP_ALL_USER_ATTRS LDAP_ALL_USER_ATTRIBUTES
#define LDAP_CHANGETYPE_ADD LDAP_CONTROL_PERSSIT_ENTRY_CHANGE_ADD
#define LDAP_CHANGETYPE_ANY (1 | 2 | 4 | 8)
#define LDAP_CHANGETYPE_DELETE LDAP_CONTROL_PERSSIT_ENTRY_CHANGE_DELETE
#define LDAP_CHANGETYPE_MODDN LDAP_CONTROL_PERSSIT_ENTRY_CHANGE_RENAME
#define LDAP_CHANGETYPE_MODIFY LDAP_CONTROL_PERSSIT_ENTRY_CHANGE_MODIFY
#define LDAP_CONTROL_AUTH_REQUEST "2.16.840.1.113730.3.4.16"
#define LDAP_CONTROL_ENTRYCHANGE LDAP_CONTROL_PERSIST_ENTRY_CHANGE_NOTICE
#define LDAP_CONTROL_PERSISTENTSEARCH LDAP_CONTROL_PERSIST_REQUEST
#define LDAP_CONTROL_POST_READ_ENTRY "1.3.6.1.1.13.2"
#define LDAP_CONTROL_PRE_READ_ENTRY "1.3.6.1.1.13.1"
#define LDAP_CONTROL_PROXIEDAUTH LDAP_CONTROL_PROXY_AUTHZ
#define LDAP_CONTROL_PROXYAUTH "2.16.840.1.113730.3.4.12" 
#define LDAP_CONTROL_PWEXPIRED "2.16.840.1.113730.3.4.4"
#define LDAP_CONTROL_PWEXPIRING "2.16.840.1.113730.3.4.5"
#define LDAP_CONTROL_SYNC LDAP_SYNC_OID       ".1"
#define LDAP_CONTROL_SYNC_DONE LDAP_SYNC_OID  ".3"
#define LDAP_CONTROL_SYNC_STATE LDAP_SYNC_OID ".2"
#define LDAP_FEATURE_ALL_OP_ATTRS "1.3.6.1.4.1.4203.1.5.1"
#define LDAP_FILTER_EXTENDED LDAP_FILTER_EXT
#define LDAP_INDEX_RANGE_ERROR 0x3D 
#define LDAP_PORT_MAX 65535 
#define LDAP_PWPOLICY_ACCTLOCKED       1
#define LDAP_PWPOLICY_CHGAFTERRESET    2
#define LDAP_PWPOLICY_INVALIDPWDSYNTAX 5
#define LDAP_PWPOLICY_MUSTSUPPLYOLDPWD 4
#define LDAP_PWPOLICY_PWDEXPIRED       0
#define LDAP_PWPOLICY_PWDINHISTORY     8
#define LDAP_PWPOLICY_PWDMODNOTALLOWED 3
#define LDAP_PWPOLICY_PWDTOOSHORT      6
#define LDAP_PWPOLICY_PWDTOOYOUNG      7
#define LDAP_REQ_ABANDON  ((ber_tag_t)0x50U)  
#define LDAP_REQ_ADD      ((ber_tag_t)0x68U)    
#define LDAP_REQ_BIND     ((ber_tag_t)0x60U)   
#define LDAP_REQ_COMPARE  ((ber_tag_t)0x6eU)  
#define LDAP_REQ_DELETE   ((ber_tag_t)0x4aU) 
#define LDAP_REQ_EXTENDED ((ber_tag_t)0x77U) 
#define LDAP_REQ_MODDN    ((ber_tag_t)0x6cU)  
#define LDAP_REQ_MODIFY   ((ber_tag_t)0x66U) 
#define LDAP_REQ_MODRDN   LDAP_REQ_MODDN
#define LDAP_REQ_RENAME   LDAP_REQ_MODDN
#define LDAP_REQ_SEARCH   ((ber_tag_t)0x63U) 
#define LDAP_REQ_UNBIND   ((ber_tag_t)0x42U) 
#define LDAP_SASL_EXTERNAL "EXTERNAL" 
#define LDAP_SORT_CONTROL_MISSING 0x3C 
#define LDAP_SYNC_ADD                         1
#define LDAP_SYNC_DELETE                      3
#define LDAP_SYNC_INFO LDAP_SYNC_OID          ".4"
#define LDAP_SYNC_MODIFY                      2
#define LDAP_SYNC_NEW_COOKIE                  4
#define LDAP_SYNC_NONE                        0x00
#define LDAP_SYNC_OID                         "1.3.6.1.4.1.4203.1.9.1"
#define LDAP_SYNC_PRESENT                     0
#define LDAP_SYNC_REFRESH_AND_PERSIST         0x03
#define LDAP_SYNC_REFRESH_DELETES             1
#define LDAP_SYNC_REFRESH_ONLY                0x01
#define LDAP_SYNC_REFRESH_PRESENTS            0
#define LDAP_SYNC_RESERVED                    0x02
#define LDAP_TAG_REFRESHDELETES               ((ber_tag_t)0x01U)
#define LDAP_TAG_REFRESHDONE                  ((ber_tag_t)0x01U)
#define LDAP_TAG_RELOAD_HINT                  ((ber_tag_t)0x01U)
#define LDAP_TAG_SYNC_COOKIE                  ((ber_tag_t)0x04U)
#define LDAP_TAG_SYNC_ID_SET                  ((ber_tag_t)0xa3U)
#define LDAP_TAG_SYNC_NEW_COOKIE              ((ber_tag_t)0x80U)
#define LDAP_TAG_SYNC_REFRESH_DELETE          ((ber_tag_t)0xa1U)
#define LDAP_TAG_SYNC_REFRESH_PRESENT         ((ber_tag_t)0xa2U)
#define LDAP_UTF8COPY(d, s) ((0x80 & *(unsigned char *)(s)) ? ldap_utf8copy(d, s) : ((*(d) = *(s)), 1))
#define LDAP_UTF8DEC(s) (s = ldap_utf8prev(s))
#define LDAP_UTF8GETC(s) ((0x80 & *(unsigned char *)(s)) ? ldap_utf8getcc((const char **)&s) : *s++)
#define LDAP_UTF8GETCC(s) ((0x80 & *(unsigned char *)(s)) ? ldap_utf8getcc(&s) : *s++)
#define LDAP_UTF8INC(s) ((0x80 & *(unsigned char *)(s)) ? s = ldap_utf8next(s) : ++s)
#define LDAP_UTF8LEN(s) ((0x80 & *(unsigned char *)(s)) ? ldap_utf8len(s) : 1)
#define LDAP_UTF8NEXT(s) ((0x80 & *(unsigned char *)(s)) ? ldap_utf8next(s) : (s) + 1)
#define LDAP_UTF8PREV(s) ldap_utf8prev(s)
#define LDAP_X_CONTROL_PWPOLICY_REQUEST LDAP_CONTROL_PASSWORDPOLICYREQUEST
#define LDAP_X_CONTROL_PWPOLICY_RESPONSE LDAP_CONTROL_PASSWORDPOLICYRESPONSE
#define LDIF_OPT_MINIMAL_ENCODING 0x04UL
#define LDIF_OPT_NOWRAP 0x01UL
#define LDIF_OPT_VALUE_IS_URL 0x02UL
#define NORM_NEXT_VAL "__NORM__NEXT__VAL__"
#define PSEUDO_ATTR_UNHASHEDUSERPASSWORD "unhashed#user#password"
#define RDN_IS_CONFLICT  0x2
#define RDN_IS_TOMBSTONE 0x1
#define SLAPD_AUTH_NONE   "none"
#define SLAPD_AUTH_OS     "OS"
#define SLAPD_AUTH_SASL   "SASL " 
#define SLAPD_AUTH_SIMPLE "simple"
#define SLAPD_AUTH_SSL    "SSL"
#define SLAPD_DEFAULT_THREAD_STACKSIZE 262144L
#define SLAPD_UNHASHED_PW_NOLOG 2
#define SLAPD_UNHASHED_PW_OFF   0
#define SLAPD_UNHASHED_PW_ON    1
#define SLAPI_ABANDON_MSGID 120
#define SLAPI_ACI_TARGET_CHECK 1946
#define SLAPI_ACL_ADD     0x20
#define SLAPI_ACL_ALL   0x087f
#define SLAPI_ACL_COMPARE 0x01
#define SLAPI_ACL_DELETE  0x10
#define SLAPI_ACL_MODDN 0x0800
#define SLAPI_ACL_PROXY   0x80
#define SLAPI_ACL_READ    0x04
#define SLAPI_ACL_SEARCH  0x02
#define SLAPI_ACL_SELF    0x40
#define SLAPI_ACL_WRITE   0x08
#define SLAPI_ADD_ENTRY                   60
#define SLAPI_ADD_EXISTING_DN_ENTRY       61
#define SLAPI_ADD_EXISTING_UNIQUEID_ENTRY 64
#define SLAPI_ADD_PARENT_ENTRY            62
#define SLAPI_ADD_PARENT_UNIQUEID         63
#define SLAPI_ADD_RESCONTROL 56 
#define SLAPI_ADD_TARGET                  SLAPI_TARGET_DN 
#define SLAPI_ADD_TARGET_SDN              SLAPI_TARGET_SDN
#define SLAPI_ARGC 147
#define SLAPI_ARGV 148
#define SLAPI_ATTR_DN                    "dn"
#define SLAPI_ATTR_DN_LENGTH                     2
#define SLAPI_ATTR_ENTRYDN               "entrydn"
#define SLAPI_ATTR_ENTRYDN_LENGTH                7
#define SLAPI_ATTR_ENTRYUSN              "entryusn"
#define SLAPI_ATTR_ENTRYUSN_LENGTH               8
#define SLAPI_ATTR_ENTRYUUID             "entryuuid"
#define SLAPI_ATTR_FLAG_COLLECTIVE 0x0080 
#define SLAPI_ATTR_FLAG_DISTRIBUTED_OPERATION 0x1000 
#define SLAPI_ATTR_FLAG_DSA_OPERATION 0x2000 
#define SLAPI_ATTR_FLAG_NOEXPOSE 0x0800 
#define SLAPI_ATTR_FLAG_NORMALIZED \
    (SLAPI_ATTR_FLAG_NORMALIZED_CES | SLAPI_ATTR_FLAG_NORMALIZED_CIS)
#define SLAPI_ATTR_FLAG_NORMALIZED_CES 0x0200 
#define SLAPI_ATTR_FLAG_NORMALIZED_CIS 0x0400 
#define SLAPI_ATTR_FLAG_NOUSERMOD 0x0100 
#define SLAPI_ATTR_FLAG_OBSOLETE 0x0040 
#define SLAPI_ATTR_FLAG_OPATTR 0x0002 
#define SLAPI_ATTR_FLAG_READONLY 0x0004 
#define SLAPI_ATTR_FLAG_SINGLE 0x0001 
#define SLAPI_ATTR_FLAG_STD_ATTR SLAPI_ATTR_FLAG_READONLY 
#define SLAPI_ATTR_NSCP_ENTRYDN          "nscpEntryDN"
#define SLAPI_ATTR_NSCP_ENTRYDN_LENGTH          11
#define SLAPI_ATTR_OBJECTCLASS           "objectclass"
#define SLAPI_ATTR_OBJECTCLASS_LENGTH           11
#define SLAPI_ATTR_PARENTID              "parentid"
#define SLAPI_ATTR_PARENTID_LENGTH               8
#define SLAPI_ATTR_RDN                   "rdn"
#define SLAPI_ATTR_RDN_LENGTH                    3
#define SLAPI_ATTR_TOMBSTONE_CSN         "nsTombstoneCSN"
#define SLAPI_ATTR_TOMBSTONE_CSN_LENGTH         14
#define SLAPI_ATTR_UNIQUEID              "nsuniqueid"
#define SLAPI_ATTR_UNIQUEID_LENGTH              10
#define SLAPI_ATTR_VALUE_PARENT_UNIQUEID "nsParentUniqueID"
#define SLAPI_ATTR_VALUE_PARENT_UNIQUEID_LENGTH 16
#define SLAPI_ATTR_VALUE_SUBENTRY        "ldapsubentry"
#define SLAPI_ATTR_VALUE_SUBENTRY_LENGTH        12
#define SLAPI_ATTR_VALUE_TOMBSTONE       "nsTombstone"
#define SLAPI_ATTR_VALUE_TOMBSTONE_LENGTH       11
#define SLAPI_BACKEND          130
#define SLAPI_BACKEND_COUNT    860
#define SLAPI_BACKEND_INSTANCE_NAME 178
#define SLAPI_BACKEND_TASK          179
#define SLAPI_BACK_TRANSACTION_NOT_SUPPORTED 1902
#define SLAPI_BERVAL_EQ(L, R) ((L)->bv_len == (R)->bv_len && \
                               !memcmp((L)->bv_val, (R)->bv_val, (L)->bv_len))
#define SLAPI_BE_ALL_BACKENDS   -1
#define SLAPI_BE_FLAG_DONT_BYPASS_FILTERTEST  0x10  
#define SLAPI_BE_FLAG_POST_IMPORT            0x100  
#define SLAPI_BE_FLAG_POST_RESTORE           0x200  
#define SLAPI_BE_FLAG_REMOTE_DATA              0x1  
#define SLAPI_BE_LASTMOD       137
#define SLAPI_BE_MAXNESTLEVEL 742
#define SLAPI_BE_NO_BACKEND     -2
#define SLAPI_BE_READONLY      136
#define SLAPI_BE_REMOTE_BACKEND -3
#define SLAPI_BE_STATE_DELETE  3  
#define SLAPI_BE_STATE_OFFLINE 2  
#define SLAPI_BE_STATE_ON      1  
#define SLAPI_BE_TYPE          135
#define SLAPI_BIND_ANONYMOUS  3  
#define SLAPI_BIND_CREDENTIALS   71  
#define SLAPI_BIND_FAIL       2  
#define SLAPI_BIND_METHOD        70
#define SLAPI_BIND_NO_BACKEND 5  
#define SLAPI_BIND_REFERRAL   4  
#define SLAPI_BIND_RET_SASLCREDS 73 
#define SLAPI_BIND_SASLMECHANISM 72 
#define SLAPI_BIND_SUCCESS    0  
#define SLAPI_BIND_TARGET        SLAPI_TARGET_DN 
#define SLAPI_BIND_TARGET_SDN    SLAPI_TARGET_SDN
#define SLAPI_BI_ERR_BUSY -23 
#define SLAPI_BI_STATE_ADD   3
#define SLAPI_BI_STATE_DONE  2
#define SLAPI_BI_STATE_START 1
#define SLAPI_BULK_IMPORT_ENTRY 182
#define SLAPI_BULK_IMPORT_STATE 192
#define SLAPI_CLIENT_DNS 745
#define SLAPI_COMPARE_TARGET     SLAPI_TARGET_DN 
#define SLAPI_COMPARE_TARGET_SDN SLAPI_TARGET_SDN
#define SLAPI_COMPARE_TYPE       80
#define SLAPI_COMPARE_VALUE      81
#define SLAPI_CONFIG_DIRECTORY 281
#define SLAPI_CONNECTION       131
#define SLAPI_CONN_AUTHMETHOD             746
#define SLAPI_CONN_CERT                   743
#define SLAPI_CONN_CLIENTNETADDR          850
#define SLAPI_CONN_CLIENTNETADDR_ACLIP    853
#define SLAPI_CONN_DN                     143
#define SLAPI_CONN_ID          139
#define SLAPI_CONN_IS_REPLICATION_SESSION 149
#define SLAPI_CONN_IS_SSL_SESSION         747
#define SLAPI_CONN_LOCAL_SSF              751
#define SLAPI_CONN_SASL_SSF               748
#define SLAPI_CONN_SERVERNETADDR          851
#define SLAPI_CONN_SSL_SSF                749
#define SLAPI_CONTROLS_ARG 58
#define SLAPI_DB2INDEX_ATTRS 186
#define SLAPI_DB2LDIF_DECRYPT           304
#define SLAPI_DB2LDIF_DUMP_UNIQUEID  176
#define SLAPI_DB2LDIF_FILE 184
#define SLAPI_DB2LDIF_PRINTKEY 183
#define SLAPI_DB2LDIF_SERVER_RUNNING 197
#define SLAPI_DBSIZE 199
#define SLAPI_DBVERIFY_DBDIR 1947
#define SLAPI_DELETE_BEPOSTOP_ENTRY    SLAPI_ENTRY_POST_OP
#define SLAPI_DELETE_BEPREOP_ENTRY     SLAPI_ENTRY_PRE_OP
#define SLAPI_DELETE_EXISTING_ENTRY    SLAPI_ADD_EXISTING_DN_ENTRY
#define SLAPI_DELETE_GLUE_PARENT_ENTRY SLAPI_ADD_PARENT_ENTRY
#define SLAPI_DELETE_TARGET            SLAPI_TARGET_DN 
#define SLAPI_DELETE_TARGET_SDN        SLAPI_TARGET_SDN
#define SLAPI_DESTROY_CONTENT 59
#define SLAPI_DSE_CALLBACK_DO_NOT_APPLY (0)
#define SLAPI_DSE_CALLBACK_ERROR        (-1)
#define SLAPI_DSE_CALLBACK_OK           (1)
#define SLAPI_DSE_DONT_CHECK_DUPS        284
#define SLAPI_DSE_DONT_WRITE_WHEN_ADDING 282
#define SLAPI_DSE_IS_PRIMARY_FILE        289
#define SLAPI_DSE_MERGE_WHEN_ADDING      283
#define SLAPI_DSE_REAPPLY_MODS           287
#define SLAPI_DSE_RETURNTEXT_SIZE 512 
#define SLAPI_DUMP_MINIMAL_ENCODING 16 
#define SLAPI_DUMP_NOOPATTRS 4 
#define SLAPI_DUMP_NOWRAP 8 
#define SLAPI_DUMP_RDN_ENTRY 32 
#define SLAPI_DUMP_STATEINFO 1 
#define SLAPI_DUMP_UNIQUEID 2 
#define SLAPI_ENTRY_FLAG_TOMBSTONE 1
#define SLAPI_ENTRY_POST_OP 53
#define SLAPI_ENTRY_PRE_OP  52
#define SLAPI_EXTMOD_PWPOLICY "Password Policy"
#define SLAPI_EXTOBJ_ENTRY_PW "UnhashedPW"
#define SLAPI_EXT_CONNECTION "Connection"
#define SLAPI_EXT_ENTRY      "Entry"
#define SLAPI_EXT_MTNODE     "Mapping Tree Node"
#define SLAPI_EXT_OPERATION  "Operation"
#define SLAPI_EXT_OP_REQ_OID   160 
#define SLAPI_EXT_OP_REQ_VALUE 161 
#define SLAPI_EXT_OP_RET_OID   162 
#define SLAPI_EXT_OP_RET_VALUE 163 
#define SLAPI_EXT_SET_ADD     0
#define SLAPI_EXT_SET_REPLACE 1
#define SLAPI_FAIL_DISKFULL -2
#define SLAPI_FAIL_GENERAL  -1
#define SLAPI_FILTER_SCAN_CONTINUE 1   
#define SLAPI_FILTER_SCAN_ERROR    -2  
#define SLAPI_FILTER_SCAN_NOMORE   0   
#define SLAPI_FILTER_SCAN_STOP     -1  
#define SLAPI_FILTER_UNKNOWN_FILTER_TYPE 2
#define SLAPI_IS_MMR_REPLICATED_OPERATION 153
#define SLAPI_IS_MOD_ADD(x)     (((x) & ~LDAP_MOD_BVALUES) == LDAP_MOD_ADD)
#define SLAPI_IS_MOD_DELETE(x)  (((x) & ~LDAP_MOD_BVALUES) == LDAP_MOD_DELETE)
#define SLAPI_IS_MOD_REPLACE(x) (((x) & ~LDAP_MOD_BVALUES) == LDAP_MOD_REPLACE)
#define SLAPI_IS_REPLICATED_OPERATION     142
#define SLAPI_LDAP_INIT_FLAG_SSL      1 
#define SLAPI_LDAP_INIT_FLAG_startTLS 2 
#define SLAPI_LDIF2DB_ENCRYPT           303
#define SLAPI_LDIF2DB_EXCLUDE 189
#define SLAPI_LDIF2DB_FILE 180
#define SLAPI_LDIF2DB_GENERATE_UNIQUEID 175
#define SLAPI_LDIF2DB_INCLUDE 188
#define SLAPI_LDIF2DB_NAMESPACEID       177
#define SLAPI_LDIF2DB_NOATTRINDEXES 187
#define SLAPI_LDIF2DB_REMOVEDUPVALS 185
#define SLAPI_LDIF_CHANGELOG  1761
#define SLAPI_LOG_ACL         8
#define SLAPI_LOG_ACLSUMMARY 17
#define SLAPI_LOG_ALERT      20
#define SLAPI_LOG_ARGS        3
#define SLAPI_LOG_BACKLDBM   16
#define SLAPI_LOG_BER         5
#define SLAPI_LOG_CACHE      13
#define SLAPI_LOG_CONFIG      7
#define SLAPI_LOG_CONNS       4
#define SLAPI_LOG_CRIT       21
#define SLAPI_LOG_DEBUG      26 
#define SLAPI_LOG_EMERG      19
#define SLAPI_LOG_ERR        22
#define SLAPI_LOG_FATAL       0
#define SLAPI_LOG_FILTER      6
#define SLAPI_LOG_HOUSE      11
#define SLAPI_LOG_INFO       25
#define SLAPI_LOG_NOTICE     24
#define SLAPI_LOG_NUNCSTANS  18
#define SLAPI_LOG_PACKETS     2
#define SLAPI_LOG_PARSE      10
#define SLAPI_LOG_PLUGIN     14
#define SLAPI_LOG_REPL       12
#define SLAPI_LOG_SHELL       9
#define SLAPI_LOG_TIMING     15
#define SLAPI_LOG_TRACE       1
#define SLAPI_LOG_WARNING    23
#define SLAPI_MANAGEDSAIT 1000
#define SLAPI_MATCHINGRULE_DESC     3
#define SLAPI_MATCHINGRULE_NAME     1
#define SLAPI_MATCHINGRULE_OBSOLETE 5
#define SLAPI_MATCHINGRULE_OID      2
#define SLAPI_MATCHINGRULE_SYNTAX   4
#define SLAPI_MODIFY_EXISTING_ENTRY SLAPI_ADD_EXISTING_DN_ENTRY
#define SLAPI_MODIFY_MODS           90
#define SLAPI_MODIFY_TARGET         SLAPI_TARGET_DN 
#define SLAPI_MODIFY_TARGET_SDN     SLAPI_TARGET_SDN
#define SLAPI_MODRDN_DELOLDRDN           101
#define SLAPI_MODRDN_EXISTING_ENTRY      SLAPI_ADD_EXISTING_DN_ENTRY
#define SLAPI_MODRDN_NEWPARENT_ENTRY     105
#define SLAPI_MODRDN_NEWRDN              100
#define SLAPI_MODRDN_NEWSUPERIOR         102 
#define SLAPI_MODRDN_NEWSUPERIOR_ADDRESS 107
#define SLAPI_MODRDN_NEWSUPERIOR_SDN     103 
#define SLAPI_MODRDN_PARENT_ENTRY        104
#define SLAPI_MODRDN_TARGET              SLAPI_TARGET_DN 
#define SLAPI_MODRDN_TARGET_ENTRY        106
#define SLAPI_MODRDN_TARGET_SDN          SLAPI_TARGET_SDN
#define SLAPI_MR_FILTER_DNATTRS 174 
#define SLAPI_MR_FILTER_ENTRY   170 
#define SLAPI_MR_FILTER_OID     173 
#define SLAPI_MR_FILTER_TYPE    171 
#define SLAPI_MR_FILTER_VALUE   172 
#define SLAPI_MR_SUBSTRLENS                   SLAPI_SYNTAX_SUBSTRLENS 
#define SLAPI_NENTRIES 195
#define SLAPI_OC_FLAG_ALLOWED  0x0002
#define SLAPI_OC_FLAG_REQUIRED 0x0001
#define SLAPI_OPERATION        132
#define SLAPI_OPERATION_ABANDON  0x00000100UL
#define SLAPI_OPERATION_ADD      0x00000010UL
#define SLAPI_OPERATION_ANY      0xFFFFFFFFUL
#define SLAPI_OPERATION_AUTHTYPE          741
#define SLAPI_OPERATION_BIND     0x00000001UL
#define SLAPI_OPERATION_COMPARE  0x00000080UL
#define SLAPI_OPERATION_DELETE   0x00000020UL
#define SLAPI_OPERATION_EXTENDED 0x00000200UL
#define SLAPI_OPERATION_ID                744
#define SLAPI_OPERATION_MODDN    0x00000040UL
#define SLAPI_OPERATION_MODIFY   0x00000008UL
#define SLAPI_OPERATION_MODRDN   SLAPI_OPERATION_MODDN
#define SLAPI_OPERATION_NONE     0x00000000UL
#define SLAPI_OPERATION_NOTES        57
#define SLAPI_OPERATION_PARAMETERS        138
#define SLAPI_OPERATION_SEARCH   0x00000004UL
#define SLAPI_OPERATION_SSF               750
#define SLAPI_OPERATION_TYPE              590
#define SLAPI_OPERATION_UNBIND   0x00000002UL
#define SLAPI_OPINITIATED_TIME            140
#define SLAPI_OP_EQUAL             3
#define SLAPI_OP_FLAG_BYPASS_REFERRALS 0x040000  
#define SLAPI_OP_FLAG_IGNORE_UNINDEXED 0x800000  
#define SLAPI_OP_FLAG_INTERNAL         0x000020  
#define SLAPI_OP_FLAG_NEVER_CACHE      0x200000  
#define SLAPI_OP_FLAG_NEVER_CHAIN      0x000800  
#define SLAPI_OP_FLAG_NO_ACCESS_CHECK  0x010000  
#define SLAPI_OP_FLAG_TOMBSTONE_ENTRY  0x001000  
#define SLAPI_OP_GREATER           5
#define SLAPI_OP_GREATER_OR_EQUAL  4
#define SLAPI_OP_LESS              1
#define SLAPI_OP_LESS_OR_EQUAL     2
#define SLAPI_OP_RANGE             0xff
#define SLAPI_OP_RANGE_NO_ALLIDS   0x200
#define SLAPI_OP_RANGE_NO_IDL_SORT 0x100
#define SLAPI_OP_SUBSTRING         6
#define SLAPI_ORIGINAL_TARGET    SLAPI_ORIGINAL_TARGET_DN
#define SLAPI_ORIGINAL_TARGET_DN 109
#define SLAPI_PAGED_RESULTS_COOKIE 1949
#define SLAPI_PAGED_RESULTS_INDEX  1945
#define SLAPI_PARENT_TXN                      190
#define SLAPI_PB_RESULT_TEXT   885
#define SLAPI_PLUGIN              3
#define SLAPI_PLUGIN_ACL                       7
#define SLAPI_PLUGIN_ACL_ALLOW_ACCESS 732
#define SLAPI_PLUGIN_ACL_INIT         730
#define SLAPI_PLUGIN_ACL_MODS_ALLOWED 733
#define SLAPI_PLUGIN_ACL_MODS_UPDATE  734
#define SLAPI_PLUGIN_ACL_SYNTAX_CHECK 731
#define SLAPI_PLUGIN_ADD_OP    199
#define SLAPI_PLUGIN_ARGC         7
#define SLAPI_PLUGIN_ARGV         6
#define SLAPI_PLUGIN_BEPOSTOPERATION           9
#define SLAPI_PLUGIN_BEPREOPERATION            8
#define SLAPI_PLUGIN_BETXNEXTENDEDOP          21
#define SLAPI_PLUGIN_BETXNPOSTOPERATION       20
#define SLAPI_PLUGIN_BETXNPREOPERATION        19
#define SLAPI_PLUGIN_BE_POST_ADD_FN    550
#define SLAPI_PLUGIN_BE_POST_DELETE_FN 553
#define SLAPI_PLUGIN_BE_POST_EXPORT_FN 556
#define SLAPI_PLUGIN_BE_POST_IMPORT_FN 557
#define SLAPI_PLUGIN_BE_POST_MODIFY_FN 551
#define SLAPI_PLUGIN_BE_POST_MODRDN_FN 552
#define SLAPI_PLUGIN_BE_POST_OPEN_FN   554
#define SLAPI_PLUGIN_BE_PRE_ADD_FN    450
#define SLAPI_PLUGIN_BE_PRE_CLOSE_FN  454
#define SLAPI_PLUGIN_BE_PRE_DELETE_FN 453
#define SLAPI_PLUGIN_BE_PRE_MODIFY_FN 451
#define SLAPI_PLUGIN_BE_PRE_MODRDN_FN 452
#define SLAPI_PLUGIN_BE_TXN_POST_ADD_FN    560
#define SLAPI_PLUGIN_BE_TXN_POST_DELETE_FN 563
#define SLAPI_PLUGIN_BE_TXN_POST_MODIFY_FN 561
#define SLAPI_PLUGIN_BE_TXN_POST_MODRDN_FN 562
#define SLAPI_PLUGIN_BE_TXN_PRE_ADD_FN              460
#define SLAPI_PLUGIN_BE_TXN_PRE_DELETE_FN           463
#define SLAPI_PLUGIN_BE_TXN_PRE_DELETE_TOMBSTONE_FN 464
#define SLAPI_PLUGIN_BE_TXN_PRE_MODIFY_FN           461
#define SLAPI_PLUGIN_BE_TXN_PRE_MODRDN_FN           462
#define SLAPI_PLUGIN_CLEANUP_FN   232
#define SLAPI_PLUGIN_CLOSE_FN     210
#define SLAPI_PLUGIN_CONFIG_AREA      816
#define SLAPI_PLUGIN_CONFIG_DN        817
#define SLAPI_PLUGIN_CONFIG_ENTRY SLAPI_ENTRY_PRE_OP
#define SLAPI_PLUGIN_CURRENT_VERSION SLAPI_PLUGIN_VERSION_03
#define SLAPI_PLUGIN_DEL_OP    202
#define SLAPI_PLUGIN_DESCRIPTION 12
#define SLAPI_PLUGIN_DESTROY_FN  11
#define SLAPI_PLUGIN_ENABLED          815
#define SLAPI_PLUGIN_ENTRY                    10
#define SLAPI_PLUGIN_ENTRY_FETCH_FUNC 813
#define SLAPI_PLUGIN_ENTRY_STORE_FUNC 814
#define SLAPI_PLUGIN_EXTENDEDOP                2
#define SLAPI_PLUGIN_EXTENDED_NOT_HANDLED          -2
#define SLAPI_PLUGIN_EXTENDED_NO_BACKEND_AVAILABLE -3
#define SLAPI_PLUGIN_EXTENDED_SENT_RESULT          -1
#define SLAPI_PLUGIN_EXT_OP_BACKEND_FN 1948
#define SLAPI_PLUGIN_EXT_OP_FN          300
#define SLAPI_PLUGIN_EXT_OP_NAMELIST    302
#define SLAPI_PLUGIN_EXT_OP_OIDLIST     301
#define SLAPI_PLUGIN_FAILURE -1 
#define SLAPI_PLUGIN_IDENTITY   13
#define SLAPI_PLUGIN_INDEX                    18
#define SLAPI_PLUGIN_INTERNAL_POSTOPERATION   13
#define SLAPI_PLUGIN_INTERNAL_POST_ADD_FN    520
#define SLAPI_PLUGIN_INTERNAL_POST_DELETE_FN 523
#define SLAPI_PLUGIN_INTERNAL_POST_MODIFY_FN 521
#define SLAPI_PLUGIN_INTERNAL_POST_MODRDN_FN 522
#define SLAPI_PLUGIN_INTERNAL_PREOPERATION    12
#define SLAPI_PLUGIN_INTERNAL_PRE_ADD_FN    420
#define SLAPI_PLUGIN_INTERNAL_PRE_BIND_FN   424
#define SLAPI_PLUGIN_INTERNAL_PRE_DELETE_FN 423
#define SLAPI_PLUGIN_INTERNAL_PRE_MODIFY_FN 421
#define SLAPI_PLUGIN_INTERNAL_PRE_MODRDN_FN 422
#define SLAPI_PLUGIN_INTOP_RESULT           15
#define SLAPI_PLUGIN_INTOP_SEARCH_ENTRIES   16
#define SLAPI_PLUGIN_INTOP_SEARCH_REFERRALS 17
#define SLAPI_PLUGIN_IS_COMPAT(x)                   \
    ((strcmp((x), SLAPI_PLUGIN_VERSION_01) == 0) || \
     (strcmp((x), SLAPI_PLUGIN_VERSION_02) == 0) || \
     (strcmp((x), SLAPI_PLUGIN_VERSION_03) == 0))
#define SLAPI_PLUGIN_IS_V2(x)                                    \
    ((strcmp((x)->plg_version, SLAPI_PLUGIN_VERSION_02) == 0) || \
     (strcmp((x)->plg_version, SLAPI_PLUGIN_VERSION_03) == 0))
#define SLAPI_PLUGIN_IS_V3(x) \
    (strcmp((x)->plg_version, SLAPI_PLUGIN_VERSION_03) == 0)
#define SLAPI_PLUGIN_LDBM_ENTRY_FETCH_STORE   17
#define SLAPI_PLUGIN_MATCHINGRULE              5
#define SLAPI_PLUGIN_MMR                      24
#define SLAPI_PLUGIN_MODRDN_OP 201
#define SLAPI_PLUGIN_MOD_OP    200
#define SLAPI_PLUGIN_MR_ASSERTION2KEYS_AVA 621
#define SLAPI_PLUGIN_MR_ASSERTION2KEYS_SUB 622
#define SLAPI_PLUGIN_MR_COMPARE            625
#define SLAPI_PLUGIN_MR_FILTER_AVA         618
#define SLAPI_PLUGIN_MR_FILTER_CREATE_FN  600
#define SLAPI_PLUGIN_MR_FILTER_INDEX_FN   603
#define SLAPI_PLUGIN_MR_FILTER_MATCH_FN   602
#define SLAPI_PLUGIN_MR_FILTER_RESET_FN   604
#define SLAPI_PLUGIN_MR_FILTER_REUSABLE    615
#define SLAPI_PLUGIN_MR_FILTER_SUB         619
#define SLAPI_PLUGIN_MR_FLAGS              623
#define SLAPI_PLUGIN_MR_INDEXER_CREATE_FN 601
#define SLAPI_PLUGIN_MR_INDEX_FN          605
#define SLAPI_PLUGIN_MR_INDEX_SV_FN       606
#define SLAPI_PLUGIN_MR_KEYS               614
#define SLAPI_PLUGIN_MR_NAMES              624
#define SLAPI_PLUGIN_MR_NORMALIZE          626
#define SLAPI_PLUGIN_MR_OID                610
#define SLAPI_PLUGIN_MR_QUERY_OPERATOR     616
#define SLAPI_PLUGIN_MR_TYPE               611
#define SLAPI_PLUGIN_MR_USAGE              617
#define SLAPI_PLUGIN_MR_USAGE_INDEX 0
#define SLAPI_PLUGIN_MR_USAGE_SORT  1
#define SLAPI_PLUGIN_MR_VALUE              612
#define SLAPI_PLUGIN_MR_VALUES             613
#define SLAPI_PLUGIN_MR_VALUES2KEYS        620
#define SLAPI_PLUGIN_NOOP    -2 
#define SLAPI_PLUGIN_NOOP_COMMIT -3 
#define SLAPI_PLUGIN_NOOP_TOMBSTONE -4  
#define SLAPI_PLUGIN_OBJECT      10
#define SLAPI_PLUGIN_OPRETURN     9
#define SLAPI_PLUGIN_POSTEXTOPERATION         23
#define SLAPI_PLUGIN_POSTOPERATION             4
#define SLAPI_PLUGIN_POSTSTART_FN 233
#define SLAPI_PLUGIN_POST_ABANDON_FN     509
#define SLAPI_PLUGIN_POST_ADD_FN         507
#define SLAPI_PLUGIN_POST_BIND_FN        501
#define SLAPI_PLUGIN_POST_COMPARE_FN     504
#define SLAPI_PLUGIN_POST_DELETE_FN      508
#define SLAPI_PLUGIN_POST_ENTRY_FN       510
#define SLAPI_PLUGIN_POST_EXTOP_FN       514
#define SLAPI_PLUGIN_POST_MODIFY_FN      505
#define SLAPI_PLUGIN_POST_MODRDN_FN      506
#define SLAPI_PLUGIN_POST_REFERRAL_FN    511
#define SLAPI_PLUGIN_POST_RESULT_FN      512
#define SLAPI_PLUGIN_POST_SEARCH_FAIL_FN 513
#define SLAPI_PLUGIN_POST_SEARCH_FN      503
#define SLAPI_PLUGIN_POST_UNBIND_FN      502
#define SLAPI_PLUGIN_PRECEDENCE 14
#define SLAPI_PLUGIN_PREEXTOPERATION          22
#define SLAPI_PLUGIN_PREOPERATION              3
#define SLAPI_PLUGIN_PRE_ABANDON_FN  409
#define SLAPI_PLUGIN_PRE_ADD_FN      407
#define SLAPI_PLUGIN_PRE_BIND_FN     401
#define SLAPI_PLUGIN_PRE_COMPARE_FN  404
#define SLAPI_PLUGIN_PRE_DELETE_FN   408
#define SLAPI_PLUGIN_PRE_ENTRY_FN    410
#define SLAPI_PLUGIN_PRE_EXTOP_FN    413
#define SLAPI_PLUGIN_PRE_MODIFY_FN   405
#define SLAPI_PLUGIN_PRE_MODRDN_FN   406
#define SLAPI_PLUGIN_PRE_REFERRAL_FN 411
#define SLAPI_PLUGIN_PRE_RESULT_FN   412
#define SLAPI_PLUGIN_PRE_SEARCH_FN   403
#define SLAPI_PLUGIN_PRE_UNBIND_FN   402
#define SLAPI_PLUGIN_PRIVATE      4
#define SLAPI_PLUGIN_PWD_STORAGE_SCHEME       14
#define SLAPI_PLUGIN_PWD_STORAGE_SCHEME_CMP_FN 802
#define SLAPI_PLUGIN_PWD_STORAGE_SCHEME_DB_PWD   812 
#define SLAPI_PLUGIN_PWD_STORAGE_SCHEME_DEC_FN 801 
#define SLAPI_PLUGIN_PWD_STORAGE_SCHEME_ENC_FN 800
#define SLAPI_PLUGIN_PWD_STORAGE_SCHEME_NAME     810 
#define SLAPI_PLUGIN_PWD_STORAGE_SCHEME_USER_PWD 811 
#define SLAPI_PLUGIN_REVER_PWD_STORAGE_SCHEME 16
#define SLAPI_PLUGIN_SHARED_CONFIG_AREA "nsslapd-pluginConfigArea"
#define SLAPI_PLUGIN_START_FN     212
#define SLAPI_PLUGIN_SUCCESS 0  
#define SLAPI_PLUGIN_SUPPORTED_VERSIONS "01,02,03"
#define SLAPI_PLUGIN_SYNTAX                    6
#define SLAPI_PLUGIN_SYNTAX_ASSERTION2KEYS_AVA 703
#define SLAPI_PLUGIN_SYNTAX_ASSERTION2KEYS_SUB 704
#define SLAPI_PLUGIN_SYNTAX_COMPARE            708
#define SLAPI_PLUGIN_SYNTAX_FILTER_AVA         700
#define SLAPI_PLUGIN_SYNTAX_FILTER_DATA       713
#define SLAPI_PLUGIN_SYNTAX_FILTER_NORMALIZED 712
#define SLAPI_PLUGIN_SYNTAX_FILTER_SUB         701
#define SLAPI_PLUGIN_SYNTAX_FLAGS              707
#define SLAPI_PLUGIN_SYNTAX_FLAG_ORDERING 2
#define SLAPI_PLUGIN_SYNTAX_FLAG_ORKEYS   1
#define SLAPI_PLUGIN_SYNTAX_NAMES              705
#define SLAPI_PLUGIN_SYNTAX_NORMALIZE         711
#define SLAPI_PLUGIN_SYNTAX_OID                706
#define SLAPI_PLUGIN_SYNTAX_VALIDATE          710
#define SLAPI_PLUGIN_SYNTAX_VALUES2KEYS        702
#define SLAPI_PLUGIN_TYPE         5
#define SLAPI_PLUGIN_TYPE_OBJECT              11
#define SLAPI_PLUGIN_VATTR_SP                 15
#define SLAPI_PLUGIN_VERSION      8
#define SLAPI_PLUGIN_VERSION_01 "01"
#define SLAPI_PLUGIN_VERSION_02 "02"
#define SLAPI_PLUGIN_VERSION_03 "03"
#define SLAPI_PWPOLICY    1001
#define SLAPI_RDN_SET_DN_INCLUDE_UNIQUEID 2
#define SLAPI_RDN_SET_DN_SKIP_UNIQUEID 1
#define SLAPI_REALATTRS_ONLY                       1
#define SLAPI_REQCONTROLS     51 
#define SLAPI_REQUESTOR_DN                141
#define SLAPI_REQUESTOR_ISROOT 133
#define SLAPI_REQUESTOR_NDN               156
#define SLAPI_REQUESTOR_SDN               852
#define SLAPI_RESCONTROLS    55
#define SLAPI_RESLIMIT_STATUS_INIT_FAILURE   2 
#define SLAPI_RESLIMIT_STATUS_INTERNAL_ERROR 5 
#define SLAPI_RESLIMIT_STATUS_NOVALUE        1 
#define SLAPI_RESLIMIT_STATUS_PARAM_ERROR    3 
#define SLAPI_RESLIMIT_STATUS_SUCCESS        0 
#define SLAPI_RESLIMIT_STATUS_UNKNOWN_HANDLE 4 
#define SLAPI_RESLIMIT_TYPE_INT 0
#define SLAPI_RESULT_CODE      881
#define SLAPI_RESULT_MATCHED   883
#define SLAPI_RESULT_TEXT      882
#define SLAPI_SCHEMA_FLAGS 285
#define SLAPI_SEARCH_ATTRS      116
#define SLAPI_SEARCH_ATTRSONLY  117
#define SLAPI_SEARCH_CTRLS 198
#define SLAPI_SEARCH_DEREF      111
#define SLAPI_SEARCH_ENTRY_COPY SLAPI_ENTRY_POST_OP
#define SLAPI_SEARCH_ENTRY_ORIG SLAPI_ENTRY_PRE_OP
#define SLAPI_SEARCH_FILTER     114
#define SLAPI_SEARCH_GERATTRS  1160
#define SLAPI_SEARCH_IS_AND     118
#define SLAPI_SEARCH_REFERRALS 196
#define SLAPI_SEARCH_REQATTRS  1161
#define SLAPI_SEARCH_RESULT_ENTRY     194
#define SLAPI_SEARCH_RESULT_ENTRY_EXT 1944
#define SLAPI_SEARCH_RESULT_SET 193
#define SLAPI_SEARCH_RESULT_SET_SIZE_ESTIMATE 1930
#define SLAPI_SEARCH_SCOPE      110
#define SLAPI_SEARCH_SIZELIMIT  112
#define SLAPI_SEARCH_STRFILTER  115
#define SLAPI_SEARCH_TARGET     SLAPI_TARGET_DN 
#define SLAPI_SEARCH_TARGET_SDN SLAPI_TARGET_SDN
#define SLAPI_SEARCH_TIMELIMIT  113
#define SLAPI_SEQ_ATTRNAME 151
#define SLAPI_SEQ_FIRST 1
#define SLAPI_SEQ_LAST  2
#define SLAPI_SEQ_NEXT  4
#define SLAPI_SEQ_PREV  3
#define SLAPI_SEQ_TYPE 150
#define SLAPI_SEQ_VAL 152
#define SLAPI_SKIP_MODIFIED_ATTRS         155
#define SLAPI_STR2ENTRY_ADDRDNVALS 2
#define SLAPI_STR2ENTRY_BIGENTRY 4
#define SLAPI_STR2ENTRY_DN_NORMALIZED 2048
#define SLAPI_STR2ENTRY_EXPAND_OBJECTCLASSES 64
#define SLAPI_STR2ENTRY_IGNORE_STATE 16
#define SLAPI_STR2ENTRY_INCLUDE_VERSION_STR 32
#define SLAPI_STR2ENTRY_NOT_WELL_FORMED_LDIF 128
#define SLAPI_STR2ENTRY_NO_ENTRYDN 1024
#define SLAPI_STR2ENTRY_NO_SCHEMA_LOCK 256
#define SLAPI_STR2ENTRY_REMOVEDUPVALS 1
#define SLAPI_STR2ENTRY_TOMBSTONE_CHECK 8
#define SLAPI_STR2ENTRY_USE_OBSOLETE_DNFORMAT 512
#define SLAPI_SYNTAX_SUBSTRLENS               709
#define SLAPI_TARGET_ADDRESS  48 
#define SLAPI_TARGET_DN       50 
#define SLAPI_TARGET_SDN      47 
#define SLAPI_TARGET_UNIQUEID 49 
#define SLAPI_TASK_CANCELLED 3
#define SLAPI_TASK_DESTROYING 0x01 
#define SLAPI_TASK_FINISHED  2
#define SLAPI_TASK_FLAGS            181
#define SLAPI_TASK_PUBLIC 1 
#define SLAPI_TASK_RUNNING   1
#define SLAPI_TASK_RUNNING_AS_TASK          0x0
#define SLAPI_TASK_RUNNING_FROM_COMMANDLINE 0x1
#define SLAPI_TASK_SETUP     0
#define SLAPI_TIMESTAMP_BUFSIZE 32
#define SLAPI_TXN                             191
#define SLAPI_TXN_RUV_MODS_FN                1901
#define SLAPI_TYPE_CMP_BASE 1
#define SLAPI_TYPE_CMP_EXACT 0
#define SLAPI_TYPE_CMP_SUBTYPE 2
#define SLAPI_TYPE_CMP_SUBTYPES 3
#define SLAPI_UNIQUEID_GENERATE_NAME_BASED 2 
#define SLAPI_UNIQUEID_GENERATE_NONE       0 
#define SLAPI_UNIQUEID_GENERATE_TIME_BASED 1 
#define SLAPI_URP_NAMING_COLLISION_DN 286
#define SLAPI_URP_TOMBSTONE_UNIQUEID  288
#define SLAPI_USERPWD_ATTR "userpassword"
#define SLAPI_USN_INCREMENT_FOR_TOMBSTONE 1950
#define SLAPI_VALUE_FLAG_DUPCHECK       0x10  
#define SLAPI_VALUE_FLAG_IGNOREERROR     0x2
#define SLAPI_VALUE_FLAG_PASSIN          0x1
#define SLAPI_VALUE_FLAG_PRESERVECSNSET  0x4
#define SLAPI_VALUE_FLAG_USENEWVALUE     0x8  
#define SLAPI_VIRTUALATTRS_LIST_OPERATIONAL_ATTRS  8  
#define SLAPI_VIRTUALATTRS_LOOP_DETECTED -2
#define SLAPI_VIRTUALATTRS_NOT_FOUND     -1
#define SLAPI_VIRTUALATTRS_ONLY                    2
#define SLAPI_VIRTUALATTRS_REALATTRS_ONLY    4
#define SLAPI_VIRTUALATTRS_REQUEST_POINTERS        4  
#define SLAPI_VIRTUALATTRS_RETURNED_COPIES   2
#define SLAPI_VIRTUALATTRS_RETURNED_POINTERS 1
#define SLAPI_VIRTUALATTRS_SUPPRESS_SUBTYPES      16  
#define SLAPI_VIRTUALATTRS_TYPE_NAME_MATCHED_EXACTLY_OR_ALIAS 1
#define SLAPI_VIRTUALATTRS_TYPE_NAME_MATCHED_SUBTYPE          2
#define SLAPI_VIRTUALATTRS_VALUES_CACHEABLE  8
#define STRINGIFYDEFINE(xxx) DEFINETOSTR(xxx)

#define ATTR_DATAVERSION "dataVersion"
#define ATTR_MOD_OPERATIONAL "operational"
#define ATTR_MOD_OVERRIDE    "override"
#define ATTR_MOD_SINGLE      "single"
#define ATTR_NETSCAPEMDSUFFIX "netscapemdsuffix"
#define ATTR_PLUGIN_ARG                    "nsslapd-pluginArg"
#define ATTR_PLUGIN_BACKEND                "nsslapd-backend"
#define ATTR_PLUGIN_BE_TXN                 "nsslapd-pluginbetxn"
#define ATTR_PLUGIN_BIND_SUBTREE           "nsslapd-bindSubtree"
#define ATTR_PLUGIN_CONFIG_AREA            "nsslapd-pluginConfigArea"
#define ATTR_PLUGIN_DEPENDS_ON_NAMED       "nsslapd-plugin-depends-on-named"
#define ATTR_PLUGIN_DEPENDS_ON_TYPE        "nsslapd-plugin-depends-on-type"
#define ATTR_PLUGIN_DESC                   "nsslapd-pluginDescription"
#define ATTR_PLUGIN_ENABLED                "nsslapd-pluginEnabled"
#define ATTR_PLUGIN_EXCLUDE_BIND_SUBTREE   "nsslapd-exclude-bindSubtree"
#define ATTR_PLUGIN_EXCLUDE_TARGET_SUBTREE "nsslapd-exclude-targetSubtree"
#define ATTR_PLUGIN_INITFN                 "nsslapd-pluginInitFunc"
#define ATTR_PLUGIN_INVOKE_FOR_REPLOP      "nsslapd-invokeForReplOp"
#define ATTR_PLUGIN_LOAD_GLOBAL            "nsslapd-pluginLoadGlobal"
#define ATTR_PLUGIN_LOAD_NOW               "nsslapd-pluginLoadNow"
#define ATTR_PLUGIN_LOG_ACCESS             "nsslapd-logAccess"
#define ATTR_PLUGIN_LOG_AUDIT              "nsslapd-logAudit"
#define ATTR_PLUGIN_PATH                   "nsslapd-pluginPath"
#define ATTR_PLUGIN_PLUGINID               "nsslapd-pluginId"
#define ATTR_PLUGIN_PRECEDENCE             "nsslapd-pluginPrecedence"
#define ATTR_PLUGIN_SCHEMA_CHECK           "nsslapd-schemaCheck"
#define ATTR_PLUGIN_TARGET_SUBTREE         "nsslapd-targetSubtree"
#define ATTR_PLUGIN_TYPE                   "nsslapd-pluginType"
#define ATTR_PLUGIN_VENDOR                 "nsslapd-pluginVendor"
#define ATTR_PLUGIN_VERSION                "nsslapd-pluginVersion"
#define ATTR_SCHEMA_UPDATE_ATTRIBUTE_ACCEPT "schemaUpdateAttributeAccept"
#define ATTR_SCHEMA_UPDATE_ATTRIBUTE_REJECT "schemaUpdateAttributeReject"
#define ATTR_SCHEMA_UPDATE_OBJECTCLASS_ACCEPT "schemaUpdateObjectclassAccept"
#define ATTR_SCHEMA_UPDATE_OBJECTCLASS_REJECT "schemaUpdateObjectclassReject"
#define ATTR_STANDARD_STRING "Standard Attribute"
#define ATTR_SYNTAX_ENUM_NEXT 0   
#define ATTR_SYNTAX_ENUM_REMOVE 2 
#define ATTR_SYNTAX_ENUM_STOP 1   
#define ATTR_SYNTAX_NORM_ORIG_ATTR 0x1 
#define ATTR_USERDEF_STRING  "User Defined Attribute"
#define ATTR_WITH_OCTETSTRING_SYNTAX "userPassword"
#define BE_LIST_SIZE 1000 
#define BINARY_SYNTAX_OID             "1.3.6.1.4.1.1466.115.121.1.5"
#define BITSTRING_SYNTAX_OID          "1.3.6.1.4.1.1466.115.121.1.6"
#define BOOLEAN_SYNTAX_OID            "1.3.6.1.4.1.1466.115.121.1.7"
#define CASEIGNOREMATCH_NAME      "caseIgnoreMatch"
#define CASEIGNOREMATCH_OID      "2.5.13.2"   
#define CFG_LOCK_READ(cfg) PR_Lock(cfg->cfg_lock)
#define CFG_LOCK_WRITE(cfg) PR_Lock(cfg->cfg_lock)
#define CFG_UNLOCK_READ(cfg) PR_Unlock(cfg->cfg_lock)
#define CFG_UNLOCK_WRITE(cfg) PR_Unlock(cfg->cfg_lock)
#define CHAR_OCTETSTRING (char)0x04
#define CONFIG_ACCESSCONTROL_ATTRIBUTE "nsslapd-accesscontrol"
#define CONFIG_ACCESSLOGLEVEL_ATTRIBUTE "nsslapd-accesslog-level"
#define CONFIG_ACCESSLOG_ATTRIBUTE "nsslapd-accesslog"
#define CONFIG_ACCESSLOG_BUFFERING_ATTRIBUTE "nsslapd-accesslog-logbuffering"
#define CONFIG_ACCESSLOG_LIST_ATTRIBUTE "nsslapd-accesslog-list"
#define CONFIG_ACCESSLOG_LOGEXPIRATIONTIMEUNIT_ATTRIBUTE "nsslapd-accesslog-logexpirationtimeunit"
#define CONFIG_ACCESSLOG_LOGEXPIRATIONTIME_ATTRIBUTE "nsslapd-accesslog-logexpirationtime"
#define CONFIG_ACCESSLOG_LOGGING_ENABLED_ATTRIBUTE "nsslapd-accesslog-logging-enabled"
#define CONFIG_ACCESSLOG_LOGROTATIONSYNCENABLED_ATTRIBUTE "nsslapd-accesslog-logrotationsync-enabled"
#define CONFIG_ACCESSLOG_LOGROTATIONSYNCHOUR_ATTRIBUTE "nsslapd-accesslog-logrotationsynchour"
#define CONFIG_ACCESSLOG_LOGROTATIONSYNCMIN_ATTRIBUTE "nsslapd-accesslog-logrotationsyncmin"
#define CONFIG_ACCESSLOG_LOGROTATIONTIMEUNIT_ATTRIBUTE "nsslapd-accesslog-logrotationtimeunit"
#define CONFIG_ACCESSLOG_LOGROTATIONTIME_ATTRIBUTE "nsslapd-accesslog-logrotationtime"
#define CONFIG_ACCESSLOG_MAXLOGDISKSPACE_ATTRIBUTE "nsslapd-accesslog-logmaxdiskspace"
#define CONFIG_ACCESSLOG_MAXLOGSIZE_ATTRIBUTE "nsslapd-accesslog-maxlogsize"
#define CONFIG_ACCESSLOG_MAXNUMOFLOGSPERDIR_ATTRIBUTE "nsslapd-accesslog-maxlogsperdir"
#define CONFIG_ACCESSLOG_MINFREEDISKSPACE_ATTRIBUTE "nsslapd-accesslog-logminfreediskspace"
#define CONFIG_ACCESSLOG_MODE_ATTRIBUTE "nsslapd-accesslog-mode"
#define CONFIG_ALLOWED_SASL_MECHS "nsslapd-allowed-sasl-mechanisms"
#define CONFIG_ALLOW_HASHED_PW_ATTRIBUTE "nsslapd-allow-hashed-passwords"
#define CONFIG_ANON_ACCESS_ATTRIBUTE "nsslapd-allow-anonymous-access"
#define CONFIG_ANON_LIMITS_DN_ATTRIBUTE "nsslapd-anonlimitsdn"
#define CONFIG_APPLY 1
#define CONFIG_ATTRIBUTE_ATTRIBUTE "nsslapd-attribute"
#define CONFIG_ATTRIBUTE_NAME_EXCEPTION_ATTRIBUTE "nsslapd-attribute-name-exceptions"
#define CONFIG_AUDITFAILFILE_ATTRIBUTE "nsslapd-auditfaillog"
#define CONFIG_AUDITFAILLOG_LIST_ATTRIBUTE "nsslapd-auditfaillog-list"
#define CONFIG_AUDITFAILLOG_LOGEXPIRATIONTIMEUNIT_ATTRIBUTE "nsslapd-auditfaillog-logexpirationtimeunit"
#define CONFIG_AUDITFAILLOG_LOGEXPIRATIONTIME_ATTRIBUTE "nsslapd-auditfaillog-logexpirationtime"
#define CONFIG_AUDITFAILLOG_LOGGING_ENABLED_ATTRIBUTE "nsslapd-auditfaillog-logging-enabled"
#define CONFIG_AUDITFAILLOG_LOGGING_HIDE_UNHASHED_PW "nsslapd-auditfaillog-logging-hide-unhashed-pw"
#define CONFIG_AUDITFAILLOG_LOGROTATIONSYNCENABLED_ATTRIBUTE "nsslapd-auditfaillog-logrotationsync-enabled"
#define CONFIG_AUDITFAILLOG_LOGROTATIONSYNCHOUR_ATTRIBUTE "nsslapd-auditfaillog-logrotationsynchour"
#define CONFIG_AUDITFAILLOG_LOGROTATIONSYNCMIN_ATTRIBUTE "nsslapd-auditfaillog-logrotationsyncmin"
#define CONFIG_AUDITFAILLOG_LOGROTATIONTIMEUNIT_ATTRIBUTE "nsslapd-auditfaillog-logrotationtimeunit"
#define CONFIG_AUDITFAILLOG_LOGROTATIONTIME_ATTRIBUTE "nsslapd-auditfaillog-logrotationtime"
#define CONFIG_AUDITFAILLOG_MAXLOGDISKSPACE_ATTRIBUTE "nsslapd-auditfaillog-logmaxdiskspace"
#define CONFIG_AUDITFAILLOG_MAXLOGSIZE_ATTRIBUTE "nsslapd-auditfaillog-maxlogsize"
#define CONFIG_AUDITFAILLOG_MAXNUMOFLOGSPERDIR_ATTRIBUTE "nsslapd-auditfaillog-maxlogsperdir"
#define CONFIG_AUDITFAILLOG_MINFREEDISKSPACE_ATTRIBUTE "nsslapd-auditfaillog-logminfreediskspace"
#define CONFIG_AUDITFAILLOG_MODE_ATTRIBUTE "nsslapd-auditfaillog-mode"
#define CONFIG_AUDITFILE_ATTRIBUTE "nsslapd-auditlog"
#define CONFIG_AUDITLOG_LIST_ATTRIBUTE "nsslapd-auditlog-list"
#define CONFIG_AUDITLOG_LOGEXPIRATIONTIMEUNIT_ATTRIBUTE "nsslapd-auditlog-logexpirationtimeunit"
#define CONFIG_AUDITLOG_LOGEXPIRATIONTIME_ATTRIBUTE "nsslapd-auditlog-logexpirationtime"
#define CONFIG_AUDITLOG_LOGGING_ENABLED_ATTRIBUTE "nsslapd-auditlog-logging-enabled"
#define CONFIG_AUDITLOG_LOGGING_HIDE_UNHASHED_PW "nsslapd-auditlog-logging-hide-unhashed-pw"
#define CONFIG_AUDITLOG_LOGROTATIONSYNCENABLED_ATTRIBUTE "nsslapd-auditlog-logrotationsync-enabled"
#define CONFIG_AUDITLOG_LOGROTATIONSYNCHOUR_ATTRIBUTE "nsslapd-auditlog-logrotationsynchour"
#define CONFIG_AUDITLOG_LOGROTATIONSYNCMIN_ATTRIBUTE "nsslapd-auditlog-logrotationsyncmin"
#define CONFIG_AUDITLOG_LOGROTATIONTIMEUNIT_ATTRIBUTE "nsslapd-auditlog-logrotationtimeunit"
#define CONFIG_AUDITLOG_LOGROTATIONTIME_ATTRIBUTE "nsslapd-auditlog-logrotationtime"
#define CONFIG_AUDITLOG_MAXLOGDISKSPACE_ATTRIBUTE "nsslapd-auditlog-logmaxdiskspace"
#define CONFIG_AUDITLOG_MAXLOGSIZE_ATTRIBUTE "nsslapd-auditlog-maxlogsize"
#define CONFIG_AUDITLOG_MAXNUMOFLOGSPERDIR_ATTRIBUTE "nsslapd-auditlog-maxlogsperdir"
#define CONFIG_AUDITLOG_MINFREEDISKSPACE_ATTRIBUTE "nsslapd-auditlog-logminfreediskspace"
#define CONFIG_AUDITLOG_MODE_ATTRIBUTE "nsslapd-auditlog-mode"
#define CONFIG_BAKDIR_ATTRIBUTE "nsslapd-bakdir"
#define CONFIG_BASEDN_ATTRIBUTE "nsslapd-certmap-basedn"
#define CONFIG_CERTDIR_ATTRIBUTE "nsslapd-certdir"
#define CONFIG_CN_USES_DN_SYNTAX_IN_DNS "nsslapd-cn-uses-dn-syntax-in-dns"
#define CONFIG_CONFIG_ATTRIBUTE "nsslapd-config"
#define CONFIG_CONNECTION_BUFFER "nsslapd-connection-buffer"
#define CONFIG_CONNECTION_NOCANON "nsslapd-connection-nocanon"
#define CONFIG_CONNTABLESIZE_ATTRIBUTE "nsslapd-conntablesize"
#define CONFIG_CSNLOGGING_ATTRIBUTE "nsslapd-csnlogging"
#define CONFIG_DATABASE_ATTRIBUTE "nsslapd-database"
#define CONFIG_DEFAULT_NAMING_CONTEXT "nsslapd-defaultnamingcontext"
#define CONFIG_DISK_GRACE_PERIOD "nsslapd-disk-monitoring-grace-period"
#define CONFIG_DISK_LOGGING_CRITICAL "nsslapd-disk-monitoring-logging-critical"
#define CONFIG_DISK_MONITORING "nsslapd-disk-monitoring"
#define CONFIG_DISK_THRESHOLD "nsslapd-disk-monitoring-threshold"
#define CONFIG_DISK_THRESHOLD_READONLY "nsslapd-disk-monitoring-readonly-on-threshold"
#define CONFIG_DN_VALIDATE_STRICT_ATTRIBUTE "nsslapd-dn-validate-strict"
#define CONFIG_DS4_COMPATIBLE_SCHEMA_ATTRIBUTE "nsslapd-ds4-compatible-schema"
#define CONFIG_DYNAMICCONF_ATTRIBUTE "nsslapd-dynamicconf"
#define CONFIG_DYNAMIC_PLUGINS "nsslapd-dynamic-plugins"
#define CONFIG_ENABLE_LDAPSSOTOKEN   "nsslapd-enable-ldapssotoken"
#define CONFIG_ENABLE_NUNC_STANS "nsslapd-enable-nunc-stans"
#define CONFIG_ENABLE_TURBO_MODE "nsslapd-enable-turbo-mode"
#define CONFIG_ENABLE_UPGRADE_HASH "nsslapd-enable-upgrade-hash"
#define CONFIG_ENQUOTE_SUP_OC_ATTRIBUTE "nsslapd-enquote-sup-oc"
#define CONFIG_ENTRYUSN_GLOBAL "nsslapd-entryusn-global"
#define CONFIG_ENTRYUSN_IMPORT_INITVAL "nsslapd-entryusn-import-initval"
#define CONFIG_ERRORLOG_ATTRIBUTE "nsslapd-errorlog"
#define CONFIG_ERRORLOG_LIST_ATTRIBUTE "nsslapd-errorlog-list"
#define CONFIG_ERRORLOG_LOGEXPIRATIONTIMEUNIT_ATTRIBUTE "nsslapd-errorlog-logexpirationtimeunit"
#define CONFIG_ERRORLOG_LOGEXPIRATIONTIME_ATTRIBUTE "nsslapd-errorlog-logexpirationtime"
#define CONFIG_ERRORLOG_LOGGING_ENABLED_ATTRIBUTE "nsslapd-errorlog-logging-enabled"
#define CONFIG_ERRORLOG_LOGROTATIONSYNCENABLED_ATTRIBUTE "nsslapd-errorlog-logrotationsync-enabled"
#define CONFIG_ERRORLOG_LOGROTATIONSYNCHOUR_ATTRIBUTE "nsslapd-errorlog-logrotationsynchour"
#define CONFIG_ERRORLOG_LOGROTATIONSYNCMIN_ATTRIBUTE "nsslapd-errorlog-logrotationsyncmin"
#define CONFIG_ERRORLOG_LOGROTATIONTIMEUNIT_ATTRIBUTE "nsslapd-errorlog-logrotationtimeunit"
#define CONFIG_ERRORLOG_LOGROTATIONTIME_ATTRIBUTE "nsslapd-errorlog-logrotationtime"
#define CONFIG_ERRORLOG_MAXLOGDISKSPACE_ATTRIBUTE "nsslapd-errorlog-logmaxdiskspace"
#define CONFIG_ERRORLOG_MAXLOGSIZE_ATTRIBUTE "nsslapd-errorlog-maxlogsize"
#define CONFIG_ERRORLOG_MAXNUMOFLOGSPERDIR_ATTRIBUTE "nsslapd-errorlog-maxlogsperdir"
#define CONFIG_ERRORLOG_MINFREEDISKSPACE_ATTRIBUTE "nsslapd-errorlog-logminfreediskspace"
#define CONFIG_ERRORLOG_MODE_ATTRIBUTE "nsslapd-errorlog-mode"
#define CONFIG_EXTERNAL_LIBS_DEBUG_ENABLED "nsslapd-external-libs-debug-enabled"
#define CONFIG_EXTRACT_PEM "nsslapd-extract-pemfiles"
#define CONFIG_FILENAME DSE_FILENAME
#define CONFIG_FORCE_SASL_EXTERNAL_ATTRIBUTE "nsslapd-force-sasl-external"
#define CONFIG_GLOBAL_BACKEND_LOCK "nsslapd-global-backend-lock"
#define CONFIG_GROUPEVALNESTLEVEL_ATTRIBUTE "nsslapd-groupevalnestlevel"
#define CONFIG_HASH_FILTERS_ATTRIBUTE "nsslapd-hash-filters"
#define CONFIG_IDLETIMEOUT_ATTRIBUTE "nsslapd-idletimeout"
#define CONFIG_IGNORE_TIME_SKEW "nsslapd-ignore-time-skew"
#define CONFIG_IGNORE_VATTRS "nsslapd-ignore-virtual-attrs"
#define CONFIG_INCLUDE_ATTRIBUTE "nsslapd-include"
#define CONFIG_INSTDIR_ATTRIBUTE "nsslapd-instancedir"
#define CONFIG_IOBLOCKTIMEOUT_ATTRIBUTE "nsslapd-ioblocktimeout"
#define CONFIG_LASTMOD_ATTRIBUTE "nsslapd-lastmod"
#define CONFIG_LDAPI_AUTH_DN_ATTRIBUTE "nsslapd-authenticateAsDN"
#define CONFIG_LDAPI_AUTH_MAP_BASE_ATTRIBUTE "nsslapd-ldapiDNMappingBase"
#define CONFIG_LDAPI_AUTH_USERNAME_ATTRIBUTE "nsslapd-ldapiUsername"
#define CONFIG_LDAPI_AUTO_DN_SUFFIX_ATTRIBUTE "nsslapd-ldapiautodnsuffix"
#define CONFIG_LDAPI_BIND_SWITCH_ATTRIBUTE "nsslapd-ldapiautobind"
#define CONFIG_LDAPI_FILENAME_ATTRIBUTE "nsslapd-ldapifilepath"
#define CONFIG_LDAPI_GIDNUMBER_TYPE_ATTRIBUTE "nsslapd-ldapigidnumbertype"
#define CONFIG_LDAPI_MAP_ENTRIES_ATTRIBUTE "nsslapd-ldapimaptoentries"
#define CONFIG_LDAPI_ROOT_DN_ATTRIBUTE "nsslapd-ldapimaprootdn"
#define CONFIG_LDAPI_SEARCH_BASE_DN_ATTRIBUTE "nsslapd-ldapientrysearchbase"
#define CONFIG_LDAPI_SWITCH_ATTRIBUTE "nsslapd-ldapilisten"
#define CONFIG_LDAPI_UIDNUMBER_TYPE_ATTRIBUTE "nsslapd-ldapiuidnumbertype"
#define CONFIG_LDAPSSOTOKEN_SECRET   "nsslapd-ldapssotoken-secret"
#define CONFIG_LDAPSSOTOKEN_TTL      "nsslapd-ldapssotoken-ttl-secs"
#define CONFIG_LDIFDIR_ATTRIBUTE "nsslapd-ldifdir"
#define CONFIG_LISTENHOST_ATTRIBUTE "nsslapd-listenhost"
#define CONFIG_LISTEN_BACKLOG_SIZE "nsslapd-listen-backlog-size"
#define CONFIG_LOCALHOST_ATTRIBUTE "nsslapd-localhost"
#define CONFIG_LOCALSSF_ATTRIBUTE "nsslapd-localssf"
#define CONFIG_LOCALUSER_ATTRIBUTE "nsslapd-localuser"
#define CONFIG_LOCKDIR_ATTRIBUTE "nsslapd-lockdir"
#define CONFIG_LOGGING_BACKEND "nsslapd-logging-backend"
#define CONFIG_LOGGING_HR_TIMESTAMPS "nsslapd-logging-hr-timestamps-enabled"
#define CONFIG_LOGLEVEL_ATTRIBUTE "nsslapd-errorlog-level"
#define CONFIG_MALLOC_MMAP_THRESHOLD "nsslapd-malloc-mmap-threshold"
#define CONFIG_MALLOC_MXFAST         "nsslapd-malloc-mxfast"
#define CONFIG_MALLOC_TRIM_THRESHOLD "nsslapd-malloc-trim-threshold"
#define CONFIG_MAXBERSIZE_ATTRIBUTE "nsslapd-maxbersize"
#define CONFIG_MAXDESCRIPTORS_ATTRIBUTE "nsslapd-maxdescriptors"
#define CONFIG_MAXSASLIOSIZE_ATTRIBUTE "nsslapd-maxsasliosize"
#define CONFIG_MAXSIMPLEPAGED_PER_CONN_ATTRIBUTE "nsslapd-maxsimplepaged-per-conn"
#define CONFIG_MAXTHREADSPERCONN_ATTRIBUTE "nsslapd-maxthreadsperconn"
#define CONFIG_MAX_FILTER_NEST_LEVEL_ATTRIBUTE "nsslapd-max-filter-nest-level"
#define CONFIG_MINSSF_ATTRIBUTE "nsslapd-minssf"
#define CONFIG_MINSSF_EXCLUDE_ROOTDSE "nsslapd-minssf-exclude-rootdse"
#define CONFIG_MODDN_ACI_ATTRIBUTE "nsslapd-moddn-aci"
#define CONFIG_NAGLE_ATTRIBUTE "nsslapd-nagle"
#define CONFIG_NDN_CACHE "nsslapd-ndn-cache-enabled"
#define CONFIG_NDN_CACHE_SIZE "nsslapd-ndn-cache-max-size"
#define CONFIG_OBJECTCLASS_ATTRIBUTE "nsslapd-objectclass"
#define CONFIG_OUTBOUND_LDAP_IO_TIMEOUT_ATTRIBUTE "nsslapd-outbound-ldap-io-timeout"
#define CONFIG_PAGEDSIZELIMIT_ATTRIBUTE "nsslapd-pagedsizelimit"
#define CONFIG_PLUGIN_ATTRIBUTE "nsslapd-plugin"
#define CONFIG_PLUGIN_BINDDN_TRACKING_ATTRIBUTE "nsslapd-plugin-binddn-tracking"
#define CONFIG_PLUGIN_LOGGING "nsslapd-plugin-logging"
#define CONFIG_PORT_ATTRIBUTE "nsslapd-port"
#define CONFIG_PWPOLICY_INHERIT_GLOBAL_ATTRIBUTE "nsslapd-pwpolicy-inherit-global"
#define CONFIG_PWPOLICY_LOCAL_ATTRIBUTE "nsslapd-pwpolicy-local"
#define CONFIG_PW_ADMIN_DN_ATTRIBUTE "passwordAdminDN"
#define CONFIG_PW_BAD_WORDS_ATTRIBUTE "passwordBadWords"
#define CONFIG_PW_CHANGE_ATTRIBUTE "passwordChange"
#define CONFIG_PW_CHECK_DICT_ATTRIBUTE "passwordDictCheck"
#define CONFIG_PW_DICT_PATH_ATTRIBUTE "passwordDictPath"
#define CONFIG_PW_EXP_ATTRIBUTE "passwordExp"
#define CONFIG_PW_GRACELIMIT_ATTRIBUTE "passwordGraceLimit"
#define CONFIG_PW_HISTORY_ATTRIBUTE "passwordHistory"
#define CONFIG_PW_INHISTORY_ATTRIBUTE "passwordInHistory"
#define CONFIG_PW_ISGLOBAL_ATTRIBUTE "passwordIsGlobalPolicy"
#define CONFIG_PW_IS_LEGACY "passwordLegacyPolicy"
#define CONFIG_PW_LOCKDURATION_ATTRIBUTE "passwordLockoutDuration"
#define CONFIG_PW_LOCKOUT_ATTRIBUTE "passwordLockout"
#define CONFIG_PW_MAXAGE_ATTRIBUTE "passwordMaxAge"
#define CONFIG_PW_MAXFAILURE_ATTRIBUTE "passwordMaxFailure"
#define CONFIG_PW_MAXREPEATS_ATTRIBUTE "passwordMaxRepeats"
#define CONFIG_PW_MAX_CLASS_CHARS_ATTRIBUTE "passwordMaxClassChars"
#define CONFIG_PW_MAX_SEQ_ATTRIBUTE "passwordMaxSequence"
#define CONFIG_PW_MAX_SEQ_SETS_ATTRIBUTE "passwordMaxSeqSets"
#define CONFIG_PW_MIN8BIT_ATTRIBUTE "passwordMin8Bit"
#define CONFIG_PW_MINAGE_ATTRIBUTE "passwordMinAge"
#define CONFIG_PW_MINALPHAS_ATTRIBUTE "passwordMinAlphas"
#define CONFIG_PW_MINCATEGORIES_ATTRIBUTE "passwordMinCategories"
#define CONFIG_PW_MINDIGITS_ATTRIBUTE "passwordMinDigits"
#define CONFIG_PW_MINLENGTH_ATTRIBUTE "passwordMinLength"
#define CONFIG_PW_MINLOWERS_ATTRIBUTE "passwordMinLowers"
#define CONFIG_PW_MINSPECIALS_ATTRIBUTE "passwordMinSpecials"
#define CONFIG_PW_MINTOKENLENGTH_ATTRIBUTE "passwordMinTokenLength"
#define CONFIG_PW_MINUPPERS_ATTRIBUTE "passwordMinUppers"
#define CONFIG_PW_MUSTCHANGE_ATTRIBUTE "passwordMustChange"
#define CONFIG_PW_PALINDROME_ATTRIBUTE "passwordPalindrome"
#define CONFIG_PW_RESETFAILURECOUNT_ATTRIBUTE "passwordResetFailureCount"
#define CONFIG_PW_SEND_EXPIRING "passwordSendExpiringTime"
#define CONFIG_PW_STORAGESCHEME_ATTRIBUTE "passwordStorageScheme"
#define CONFIG_PW_SYNTAX_ATTRIBUTE "passwordCheckSyntax"
#define CONFIG_PW_TRACK_LAST_UPDATE_TIME "passwordTrackUpdateTime"
#define CONFIG_PW_UNLOCK_ATTRIBUTE "passwordUnlock"
#define CONFIG_PW_USERATTRS_ATTRIBUTE "passwordUserAttributes"
#define CONFIG_PW_WARNING_ATTRIBUTE "passwordWarning"
#define CONFIG_READONLY_ATTRIBUTE "nsslapd-readonly"
#define CONFIG_REFERRAL_ATTRIBUTE "nsslapd-referral"
#define CONFIG_REFERRAL_MODE_ATTRIBUTE "nsslapd-referralmode"
#define CONFIG_REQUIRE_SECURE_BINDS_ATTRIBUTE "nsslapd-require-secure-binds"
#define CONFIG_RESERVEDESCRIPTORS_ATTRIBUTE "nsslapd-reservedescriptors"
#define CONFIG_RESULT_TWEAK_ATTRIBUTE "nsslapd-result-tweak"
#define CONFIG_RETURN_DEFAULT_OPATTR "nsslapd-return-default-opattr"
#define CONFIG_RETURN_EXACT_CASE_ATTRIBUTE "nsslapd-return-exact-case"
#define CONFIG_REWRITE_RFC1274_ATTRIBUTE "nsslapd-rewrite-rfc1274"
#define CONFIG_ROOTDN_ATTRIBUTE "nsslapd-rootdn"
#define CONFIG_ROOTPWSTORAGESCHEME_ATTRIBUTE "nsslapd-rootpwstoragescheme"
#define CONFIG_ROOTPW_ATTRIBUTE "nsslapd-rootpw"
#define CONFIG_RUNDIR_ATTRIBUTE "nsslapd-rundir"
#define CONFIG_SASLPATH_ATTRIBUTE "nsslapd-saslpath"
#define CONFIG_SASL_MAPPING_FALLBACK "nsslapd-sasl-mapping-fallback"
#define CONFIG_SASL_MAXBUFSIZE "nsslapd-sasl-max-buffer-size"
#define CONFIG_SCHEMACHECK_ATTRIBUTE "nsslapd-schemacheck"
#define CONFIG_SCHEMADIR_ATTRIBUTE "nsslapd-schemadir"
#define CONFIG_SCHEMAMOD_ATTRIBUTE "nsslapd-schemamod"
#define CONFIG_SCHEMAREPLACE_ATTRIBUTE "nsslapd-schemareplace"
#define CONFIG_SCHEMAREPLACE_STR_OFF "off"
#define CONFIG_SCHEMAREPLACE_STR_ON "on"
#define CONFIG_SCHEMAREPLACE_STR_REPLICATION_ONLY "replication-only"
#define CONFIG_SCHEMA_IGNORE_TRAILING_SPACES "nsslapd-schema-ignore-trailing-spaces"
#define CONFIG_SEARCH_RETURN_ORIGINAL_TYPE "nsslapd-search-return-original-type-switch"
#define CONFIG_SECURELISTENHOST_ATTRIBUTE "nsslapd-securelistenhost"
#define CONFIG_SECUREPORT_ATTRIBUTE "nsslapd-securePort"
#define CONFIG_SECURITY_ATTRIBUTE "nsslapd-security"
#define CONFIG_SIZELIMIT_ATTRIBUTE "nsslapd-sizelimit"
#define CONFIG_SLAPI_COUNTER_ATTRIBUTE "nsslapd-counters"
#define CONFIG_SNMP_INDEX_ATTRIBUTE "nsslapd-snmp-index"
#define CONFIG_SSL3CIPHERS_ATTRIBUTE "nsslapd-SSL3ciphers"
#define CONFIG_SSLCLIENTAUTH_ATTRIBUTE "nsslapd-SSLclientAuth"
#define CONFIG_SSL_CHECK_HOSTNAME_ATTRIBUTE "nsslapd-ssl-check-hostname"
#define CONFIG_SUBDIR_NAME "config"
#define CONFIG_SUFFIX_ATTRIBUTE "nsslapd-suffix"
#define CONFIG_SVRTAB_ATTRIBUTE "nsslapd-svrtab"
#define CONFIG_SYNTAXCHECK_ATTRIBUTE "nsslapd-syntaxcheck"
#define CONFIG_SYNTAXLOGGING_ATTRIBUTE "nsslapd-syntaxlogging"
#define CONFIG_THREADNUMBER_ATTRIBUTE "nsslapd-threadnumber"
#define CONFIG_TIMELIMIT_ATTRIBUTE "nsslapd-timelimit"
#define CONFIG_TLS_CHECK_CRL_ATTRIBUTE "nsslapd-tls-check-crl"
#define CONFIG_TMPDIR_ATTRIBUTE "nsslapd-tmpdir"
#define CONFIG_UNAUTH_BINDS_ATTRIBUTE "nsslapd-allow-unauthenticated-binds"
#define CONFIG_UNHASHED_PW_SWITCH_ATTRIBUTE "nsslapd-unhashed-pw-switch"
#define CONFIG_USERAT_ATTRIBUTE "nsslapd-userat"
#define CONFIG_USEROC_ATTRIBUTE "nsslapd-useroc"
#define CONFIG_VALIDATE_CERT_ATTRIBUTE "nsslapd-validate-cert"
#define CONFIG_VERIFY_FILTER_SCHEMA  "nsslapd-verify-filter-schema"
#define CONFIG_VERSIONSTRING_ATTRIBUTE "nsslapd-versionstring"
#define CONFIG_WORKINGDIR_ATTRIBUTE "nsslapd-workingdir"
#define CONNECTION_BUFFER_ADAPT 2
#define CONNECTION_BUFFER_OFF 0
#define CONNECTION_BUFFER_ON 1
#define CONN_FLAG_CLOSING 2 
#define CONN_FLAG_IMPORT 4  
#define CONN_FLAG_MAX_THREADS 1024 
#define CONN_FLAG_PAGEDRESULTS_ABANDONED 512  
#define CONN_FLAG_PAGEDRESULTS_PROCESSING 256 
#define CONN_FLAG_PAGEDRESULTS_UNINDEXED 128  
#define CONN_FLAG_PAGEDRESULTS_WITH_SORT 64 
#define CONN_FLAG_SASL_COMPLETE 32 
#define CONN_FLAG_SASL_CONTINUE 8 
#define CONN_FLAG_SSL 1     
#define CONN_FLAG_START_TLS 16 
#define CONN_GET_SORT_RESULT_CODE (-1)
#define COUNTRYSTRING_SYNTAX_OID      "1.3.6.1.4.1.1466.115.121.1.11"
#define DAEMON_LISTEN_SIZE 128
#define DAEMON_LISTEN_SIZE_STR "128"
#define DEFAULT_CONSUMER_POLICY DEFAULT_SUPPLIER_POLICY
#define DEFAULT_MALLOC_UNSET (-10)
#define DEFAULT_PASSWORD_SCHEME_NAME "DEFAULT"
#define DEFAULT_SUPPLIER_POLICY SUPPLIER_POLICY_1 SUPPLIER_POLICY_2
#define DEFBACKEND_NAME "DirectoryServerDefaultBackend"
#define DEFBACKEND_TYPE "default"
#define DELIVERYMETHOD_SYNTAX_OID     "1.3.6.1.4.1.1466.115.121.1.14"
#define DIRSTRING_SYNTAX_OID          "1.3.6.1.4.1.1466.115.121.1.15"

#define DNMATCH_NAME              "distinguishedNameMatch"
#define DNMATCH_OID              "2.5.13.1"   
#define DN_SYNTAX_OID                 "1.3.6.1.4.1.1466.115.121.1.12"
#define DSE_BACKFILE "dse.ldif.bak"
#define DSE_FILENAME "dse.ldif"
#define DSE_LDBM_FILENAME "ldbm.ldif"
#define DSE_LDBM_TMPFILE "ldbm.ldif.tmp"
#define DSE_STARTOKFILE "dse.ldif.startOK"
#define DSE_TMPFILE "dse.ldif.tmp"
#define EGG_FILTER "(objectclass=directory-team-extensible-object)"
#define EGG_OBJECT_CLASS "directory-team-extensible-object"
#define ENHANCEDGUIDE_SYNTAX_OID      "1.3.6.1.4.1.1466.115.121.1.21"
#define ENTRY_MAX_ATTRIBUTE_VALUE_COUNT 1073741824
#define ENTRY_POINT_DISCONNECT_SERVER 107
#define ENTRY_POINT_PS_SERVICE 105
#define ENTRY_POINT_PS_WAKEUP_ALL 102
#define ENTRY_POINT_SLAPD_SSL_CLIENT_INIT 108
#define ENTRY_POINT_SLAPD_SSL_INIT 109
#define ENTRY_POINT_SLAPD_SSL_INIT2 110
#define ENTRY_REPL_SCHEMA_CONSUMER "cn=consumerUpdatePolicy," ENTRY_REPL_SCHEMA_TOP
#define ENTRY_REPL_SCHEMA_SUPPLIER "cn=supplierUpdatePolicy," ENTRY_REPL_SCHEMA_TOP
#define ENTRY_REPL_SCHEMA_TOP "cn=replSchema, cn=config"
#define ETIME_BUFSIZ 42 
#define EXPORT_APPENDMODE 0x4
#define EXPORT_APPENDMODE_1 0x40
#define EXPORT_ID2ENTRY_ONLY 0x10
#define EXPORT_INTERNAL 0x100
#define EXPORT_MINIMAL_ENCODING 0x8
#define EXPORT_NOVERSION 0x20
#define EXPORT_NOWRAP 0x2
#define EXPORT_PRINTKEY 0x1
#define EXTOP_BULK_IMPORT_DONE_OID  "2.16.840.1.113730.3.5.8"
#define EXTOP_BULK_IMPORT_START_OID "2.16.840.1.113730.3.5.7"
#define EXTOP_LDAPSSOTOKEN_REQUEST_OID  "2.16.840.1.113730.3.5.14"
#define EXTOP_LDAPSSOTOKEN_RESPONSE_OID "2.16.840.1.113730.3.5.15"
#define EXTOP_LDAPSSOTOKEN_REVOKE_OID   "2.16.840.1.113730.3.5.16"
#define EXTOP_PASSWD_OID            "1.3.6.1.4.1.4203.1.11.1"
#define FACSIMILE_SYNTAX_OID          "1.3.6.1.4.1.1466.115.121.1.22"
#define FAX_SYNTAX_OID                "1.3.6.1.4.1.1466.115.121.1.23"
#define FLAG_ALL_NRDNS 2
#define FLAG_ALL_RDNS 1
#define FLAG_RDNS 0
#define GENERALIZEDTIME_SYNTAX_OID    "1.3.6.1.4.1.1466.115.121.1.24"
#define GET_THREAD_ID() thr_self()
#define GR_LOCK_READ()    slapi_rwlock_rdlock(grefs->ra_rwlock)
#define GR_LOCK_WRITE()   slapi_rwlock_wrlock(grefs->ra_rwlock)
#define GR_UNLOCK_READ()  slapi_rwlock_unlock(grefs->ra_rwlock)
#define GR_UNLOCK_WRITE() slapi_rwlock_unlock(grefs->ra_rwlock)
#define GTOD(t) gettimeofday(t, NULL)
#define GUIDE_SYNTAX_OID              "1.3.6.1.4.1.1466.115.121.1.25"
#define IA5STRING_SYNTAX_OID          "1.3.6.1.4.1.1466.115.121.1.26"
#define INDEX_SUBSTRLEN    3 
#define INTEGERMATCH_NAME         "integerMatch"
#define INTEGERMATCH_OID         "2.5.13.14"  
#define INTEGERORDERINGMATCH_NAME "integerOrderingMatch"
#define INTEGERORDERINGMATCH_OID "2.5.13.15"  
#define INTEGER_SYNTAX_OID            "1.3.6.1.4.1.1466.115.121.1.27"
#define INTFIRSTCOMPMATCH_NAME    "integerFirstComponentMatch"
#define INTFIRSTCOMPMATCH_OID    "2.5.13.29"  
#define JPEG_SYNTAX_OID               "1.3.6.1.4.1.1466.115.121.1.28"
#define LDAPI_INTERNAL 1
#define LDAP_AUTH_KRBV41 0x81L
#define LDAP_AUTH_KRBV42 0x82L
#define LDAP_CONTROL_AUTH_RESPONSE "2.16.840.1.113730.3.4.15"
#define LDAP_CONTROL_GET_EFFECTIVE_RIGHTS "1.3.6.1.4.1.42.2.27.9.5.2"
#define LDAP_CONTROL_PAGEDRESULTS "1.2.840.113556.1.4.319"
#define LDAP_CONTROL_REAL_ATTRS_ONLY "2.16.840.1.113730.3.4.17"
#define LDAP_CONTROL_VIRT_ATTRS_ONLY "2.16.840.1.113730.3.4.19"
#define LDAP_OFF 0
#define LDAP_ON 1

#define LDAP_UNDEFINED (-1)
#define LDAP_VIRTUAL_LIST_VIEW_ERROR 0x4C 
#define LDIF_CSNPREFIX_MAXLENGTH 6 
#define LITTLE_ENDIAN __LITTLE_ENDIAN
#define LOGGING_BACKEND_INTERNAL 0x1
#define LOGGING_BACKEND_JOURNALD 0x4
#define LOGGING_BACKEND_SYSLOG 0x2
#define LOG_INTERNAL_OP_CON_ID "Internal"
#define LOG_INTERNAL_OP_OP_ID  -1
#define MAX_ALLOWED_TIME_IN_SECS             2147483647
#define MAX_ALLOWED_TIME_IN_SECS_64 9223372036854775807
#define MAX_SERVICE_NAME 25
#define MAX_THREADS 512
#define MIN_THREADS 16
#define MTN_CONTROL_USE_ONE_BACKEND_EXT_OID "2.16.840.1.113730.3.4.20"
#define MTN_CONTROL_USE_ONE_BACKEND_OID     "2.16.840.1.113730.3.4.14"
#define NAMEANDOPTIONALUID_SYNTAX_OID "1.3.6.1.4.1.1466.115.121.1.34"
#define NOT_FIRST_TIME (time_t)1          
#define NO_TIME (time_t)0                 
#define NUMERICSTRING_SYNTAX_OID      "1.3.6.1.4.1.1466.115.121.1.36"
#define NUM_SNMP_INT_TBL_ROWS 5
#define OCTETSTRING_SYNTAX_OID        "1.3.6.1.4.1.1466.115.121.1.40"
#define OC_FLAG_OBSOLETE     8
#define OC_FLAG_REDEFINED_OC 4
#define OC_FLAG_STANDARD_OC  1
#define OC_FLAG_USER_OC      2
#define OC_KIND_ABSTRACT   0
#define OC_KIND_AUXILIARY  2
#define OC_KIND_STRUCTURAL 1
#define OC_STANDARD_STRING   "Standard ObjectClass"
#define OC_USERDEF_STRING    "User Defined ObjectClass"
#define OIDFIRSTCOMPMATCH_NAME    "objectIdentifierFirstComponentMatch"
#define OIDFIRSTCOMPMATCH_OID    "2.5.13.30"  
#define OID_SYNTAX_OID                "1.3.6.1.4.1.1466.115.121.1.38"
#define PLUGIN_DEFAULT_PRECEDENCE 50
#define PLUGIN_LIST_ACL                      10
#define PLUGIN_LIST_BACKEND_MAX               11
#define PLUGIN_LIST_BEPOSTOPERATION            4
#define PLUGIN_LIST_BEPREOPERATION             3
#define PLUGIN_LIST_BETXNPOSTOPERATION       21
#define PLUGIN_LIST_BETXNPREOPERATION        20
#define PLUGIN_LIST_BE_TXN_EXTENDED_OPERATION  8
#define PLUGIN_LIST_DATABASE                   0
#define PLUGIN_LIST_ENTRY                    13
#define PLUGIN_LIST_EXTENDED_OPERATION         7
#define PLUGIN_LIST_GLOBAL_MAX               23
#define PLUGIN_LIST_INDEX                    19
#define PLUGIN_LIST_INTERNAL_POSTOPERATION     6
#define PLUGIN_LIST_INTERNAL_PREOPERATION      5
#define PLUGIN_LIST_LDBM_ENTRY_FETCH_STORE   18
#define PLUGIN_LIST_MATCHINGRULE             11
#define PLUGIN_LIST_MMR                      22
#define PLUGIN_LIST_OBJECT                   14
#define PLUGIN_LIST_POSTEXTENDED_OPERATION    10
#define PLUGIN_LIST_POSTOPERATION              2
#define PLUGIN_LIST_PREEXTENDED_OPERATION      9
#define PLUGIN_LIST_PREOPERATION               1
#define PLUGIN_LIST_PWD_STORAGE_SCHEME       15
#define PLUGIN_LIST_REVER_PWD_STORAGE_SCHEME 17
#define PLUGIN_LIST_SYNTAX                   12
#define PLUGIN_LIST_VATTR_SP                 16 
#define PLUGIN_MAX_PRECEDENCE     99
#define PLUGIN_MIN_PRECEDENCE      1
#define POLL_FN PR_Poll
#define POLL_STRUCT PRPollDesc
#define POSTALADDRESS_SYNTAX_OID      "1.3.6.1.4.1.1466.115.121.1.41"
#define PRINTABLESTRING_SYNTAX_OID    "1.3.6.1.4.1.1466.115.121.1.44"
#define PSEUDO_ATTR_UNHASHEDUSERPASSWORD_OID "2.16.840.1.113730.3.1.2110"
#define PWD_PBE_DELIM '-'
#define REFERRAL_REMOVE_CMD "remove"
#define REFER_MODE_OFF 0
#define REFER_MODE_ON 1
#define REPL_DBTAG "repl"
#define REPL_DBTYPE "ldbm"
#define REPL_SCHEMA_AS_CONSUMER 0
#define REPL_SCHEMA_AS_SUPPLIER 1
#define REPL_SCHEMA_ATTRIBUTE 1
#define REPL_SCHEMA_OBJECTCLASS 0
#define REPL_SCHEMA_UPDATE_ACCEPT_VALUE 3
#define REPL_SCHEMA_UPDATE_NEVER 1
#define REPL_SCHEMA_UPDATE_ON_VALUE 2
#define REPL_SCHEMA_UPDATE_REJECT_VALUE 4
#define REPL_SCHEMA_UPDATE_UNKNOWN_VALUE 5
#define RLIM_TYPE int
#define RUV_STORAGE_ENTRY_UNIQUEID "ffffffff-ffffffff-ffffffff-ffffffff"
#define SCHEMA_SUBDIR_NAME "schema"
#define SIGNAL sigset
#define SLAPD_ACCESS_LOG 0x1
#define SLAPD_ANON_ACCESS_OFF 0
#define SLAPD_ANON_ACCESS_ON 1
#define SLAPD_ANON_ACCESS_ROOTDSE 2
#define SLAPD_AUDITFAIL_LOG 0x8
#define SLAPD_AUDIT_LOG 0x4
#define SLAPD_CONFIG_DN  "cn=config"
#define SLAPD_DEFAULT_ACCESSLOG_LEVEL 256
#define SLAPD_DEFAULT_ACCESSLOG_LEVEL_STR "256"
#define SLAPD_DEFAULT_ALLOW_ANON_ACCESS SLAPD_ANON_ACCESS_ON
#define SLAPD_DEFAULT_ALLOW_ANON_ACCESS_STR "on"
#define SLAPD_DEFAULT_CONNTABLESIZE 4093 
#define SLAPD_DEFAULT_DIRECTORY_MANAGER "cn=Directory Manager"
#define SLAPD_DEFAULT_DIR_MODE S_IRWXU
#define SLAPD_DEFAULT_DISK_GRACE_PERIOD 60
#define SLAPD_DEFAULT_DISK_GRACE_PERIOD_STR "60"
#define SLAPD_DEFAULT_DISK_THRESHOLD 2097152
#define SLAPD_DEFAULT_DISK_THRESHOLD_STR "2097152"
#define SLAPD_DEFAULT_ERRORLOG_LEVEL 266354688
#define SLAPD_DEFAULT_FE_ERRORLOG_LEVEL 16384 
#define SLAPD_DEFAULT_FE_ERRORLOG_LEVEL_STR "16384"
#define SLAPD_DEFAULT_FILE_MODE S_IRUSR | S_IWUSR
#define SLAPD_DEFAULT_GIDNUM_TYPE       "gidNumber"
#define SLAPD_DEFAULT_GROUPEVALNESTLEVEL 0
#define SLAPD_DEFAULT_GROUPEVALNESTLEVEL_STR "0"
#define SLAPD_DEFAULT_GROUPNESTLEVEL 5
#define SLAPD_DEFAULT_IDLE_TIMEOUT 3600 
#define SLAPD_DEFAULT_IDLE_TIMEOUT_STR "3600"
#define SLAPD_DEFAULT_IOBLOCK_TIMEOUT 10000 
#define SLAPD_DEFAULT_IOBLOCK_TIMEOUT_STR "10000"
#define SLAPD_DEFAULT_LDAPI_AUTO_DN     "cn=peercred,cn=external,cn=auth"
#define SLAPD_DEFAULT_LDAPI_MAPPING_DN  "cn=auto_bind,cn=config"
#define SLAPD_DEFAULT_LDAPI_SEARCH_BASE "dc=example,dc=com"
#define SLAPD_DEFAULT_LDAPSSOTOKEN_TTL 3600
#define SLAPD_DEFAULT_LDAPSSOTOKEN_TTL_STR "3600"
#define SLAPD_DEFAULT_LOCAL_SSF 71 
#define SLAPD_DEFAULT_LOCAL_SSF_STR "71"
#define SLAPD_DEFAULT_LOG_ACCESS_MAXDISKSPACE 500
#define SLAPD_DEFAULT_LOG_ACCESS_MAXDISKSPACE_STR "500"
#define SLAPD_DEFAULT_LOG_ACCESS_MAXNUMLOGS 10
#define SLAPD_DEFAULT_LOG_ACCESS_MAXNUMLOGS_STR "10"
#define SLAPD_DEFAULT_LOG_EXPTIME 1
#define SLAPD_DEFAULT_LOG_EXPTIME_STR "1"
#define SLAPD_DEFAULT_LOG_MAXDISKSPACE 100
#define SLAPD_DEFAULT_LOG_MAXDISKSPACE_STR "100"
#define SLAPD_DEFAULT_LOG_MAXLOGSIZE 100
#define SLAPD_DEFAULT_LOG_MAXLOGSIZE_STR "100"
#define SLAPD_DEFAULT_LOG_MAXNUMLOGS 2
#define SLAPD_DEFAULT_LOG_MAXNUMLOGS_STR "2"
#define SLAPD_DEFAULT_LOG_MINFREESPACE 5
#define SLAPD_DEFAULT_LOG_MINFREESPACE_STR "5"
#define SLAPD_DEFAULT_LOG_ROTATIONSYNCHOUR 0
#define SLAPD_DEFAULT_LOG_ROTATIONSYNCHOUR_STR "0"
#define SLAPD_DEFAULT_LOG_ROTATIONSYNCMIN 0
#define SLAPD_DEFAULT_LOG_ROTATIONSYNCMIN_STR "0"
#define SLAPD_DEFAULT_LOG_ROTATIONTIME 1
#define SLAPD_DEFAULT_LOG_ROTATIONTIME_STR "1"
#define SLAPD_DEFAULT_LOOKTHROUGHLIMIT 5000 
#define SLAPD_DEFAULT_MAXBERSIZE 2097152
#define SLAPD_DEFAULT_MAXBERSIZE_STR "2097152"
#define SLAPD_DEFAULT_MAXDESCRIPTORS 1048576
#define SLAPD_DEFAULT_MAXDESCRIPTORS_STR "1048576"
#define SLAPD_DEFAULT_MAXSIMPLEPAGED_PER_CONN (-1)
#define SLAPD_DEFAULT_MAXSIMPLEPAGED_PER_CONN_STR "-1"
#define SLAPD_DEFAULT_MAX_BERSIZE_STR "0"
#define SLAPD_DEFAULT_MAX_FILTER_NEST_LEVEL 40 
#define SLAPD_DEFAULT_MAX_FILTER_NEST_LEVEL_STR "40"
#define SLAPD_DEFAULT_MAX_SASLIO_SIZE 2097152  
#define SLAPD_DEFAULT_MAX_SASLIO_SIZE_STR "2097152"
#define SLAPD_DEFAULT_MAX_THREADS -1 
#define SLAPD_DEFAULT_MAX_THREADS_PER_CONN 5 
#define SLAPD_DEFAULT_MAX_THREADS_PER_CONN_STR "5"
#define SLAPD_DEFAULT_MAX_THREADS_STR "-1"
#define SLAPD_DEFAULT_MIN_SSF 0 
#define SLAPD_DEFAULT_MIN_SSF_STR "0"
#define SLAPD_DEFAULT_NDN_SIZE     20971520
#define SLAPD_DEFAULT_NDN_SIZE_STR "20971520"
#define SLAPD_DEFAULT_OUTBOUND_LDAP_IO_TIMEOUT 300000 
#define SLAPD_DEFAULT_OUTBOUND_LDAP_IO_TIMEOUT_STR "300000"
#define SLAPD_DEFAULT_PAGEDSIZELIMIT 0
#define SLAPD_DEFAULT_PAGEDSIZELIMIT_STR "0"
#define SLAPD_DEFAULT_PW_GRACELIMIT 0
#define SLAPD_DEFAULT_PW_GRACELIMIT_STR "0"
#define SLAPD_DEFAULT_PW_INHISTORY 6
#define SLAPD_DEFAULT_PW_INHISTORY_STR "6"
#define SLAPD_DEFAULT_PW_LOCKDURATION 3600
#define SLAPD_DEFAULT_PW_LOCKDURATION_STR "3600"
#define SLAPD_DEFAULT_PW_MAXAGE 8640000
#define SLAPD_DEFAULT_PW_MAXAGE_STR "8640000"
#define SLAPD_DEFAULT_PW_MAXFAILURE 3
#define SLAPD_DEFAULT_PW_MAXFAILURE_STR "3"
#define SLAPD_DEFAULT_PW_MAXREPEATS 0
#define SLAPD_DEFAULT_PW_MAXREPEATS_STR "0"
#define SLAPD_DEFAULT_PW_MAX_CLASS_CHARS_ATTRIBUTE 0
#define SLAPD_DEFAULT_PW_MAX_CLASS_CHARS_ATTRIBUTE_STR "0"
#define SLAPD_DEFAULT_PW_MAX_SEQ_ATTRIBUTE 0
#define SLAPD_DEFAULT_PW_MAX_SEQ_ATTRIBUTE_STR "0"
#define SLAPD_DEFAULT_PW_MAX_SEQ_SETS_ATTRIBUTE 0
#define SLAPD_DEFAULT_PW_MAX_SEQ_SETS_ATTRIBUTE_STR "0"
#define SLAPD_DEFAULT_PW_MIN8BIT 0
#define SLAPD_DEFAULT_PW_MIN8BIT_STR "0"
#define SLAPD_DEFAULT_PW_MINAGE 0
#define SLAPD_DEFAULT_PW_MINAGE_STR "0"
#define SLAPD_DEFAULT_PW_MINALPHAS 0
#define SLAPD_DEFAULT_PW_MINALPHAS_STR "0"
#define SLAPD_DEFAULT_PW_MINCATEGORIES 3
#define SLAPD_DEFAULT_PW_MINCATEGORIES_STR "3"
#define SLAPD_DEFAULT_PW_MINDIGITS 0
#define SLAPD_DEFAULT_PW_MINDIGITS_STR "0"
#define SLAPD_DEFAULT_PW_MINLENGTH 8
#define SLAPD_DEFAULT_PW_MINLENGTH_STR "8"
#define SLAPD_DEFAULT_PW_MINLOWERS 0
#define SLAPD_DEFAULT_PW_MINLOWERS_STR "0"
#define SLAPD_DEFAULT_PW_MINSPECIALS 0
#define SLAPD_DEFAULT_PW_MINSPECIALS_STR "0"
#define SLAPD_DEFAULT_PW_MINTOKENLENGTH 3
#define SLAPD_DEFAULT_PW_MINTOKENLENGTH_STR "3"
#define SLAPD_DEFAULT_PW_MINUPPERS 0
#define SLAPD_DEFAULT_PW_MINUPPERS_STR "0"
#define SLAPD_DEFAULT_PW_RESETFAILURECOUNT 600
#define SLAPD_DEFAULT_PW_RESETFAILURECOUNT_STR "600"
#define SLAPD_DEFAULT_PW_WARNING 86400
#define SLAPD_DEFAULT_PW_WARNING_STR "86400"
#define SLAPD_DEFAULT_RESERVE_FDS 64
#define SLAPD_DEFAULT_RESERVE_FDS_STR "64"
#define SLAPD_DEFAULT_SASL_MAXBUFSIZE 2097152
#define SLAPD_DEFAULT_SASL_MAXBUFSIZE_STR "2097152"
#define SLAPD_DEFAULT_SCHEMA_IGNORE_TRAILING_SPACES LDAP_OFF
#define SLAPD_DEFAULT_SIZELIMIT 2000 
#define SLAPD_DEFAULT_SIZELIMIT_STR "2000"
#define SLAPD_DEFAULT_SNMP_INDEX 0
#define SLAPD_DEFAULT_SNMP_INDEX_STR "0"
#define SLAPD_DEFAULT_SSLCLIENTAUTH SLAPD_SSLCLIENTAUTH_ALLOWED
#define SLAPD_DEFAULT_SSLCLIENTAUTH_STR "allowed"
#define SLAPD_DEFAULT_TIMELIMIT 3600 
#define SLAPD_DEFAULT_TIMELIMIT_STR "3600"
#define SLAPD_DEFAULT_UIDNUM_TYPE       "uidNumber"
#define SLAPD_DEFAULT_UNHASHED_PW_SWITCH SLAPD_UNHASHED_PW_OFF
#define SLAPD_DEFAULT_UNHASHED_PW_SWITCH_STR "off"
#define SLAPD_DEFAULT_VALIDATE_CERT SLAPD_VALIDATE_CERT_WARN
#define SLAPD_DEFAULT_VALIDATE_CERT_STR "warn"
#define SLAPD_END_TIME (time_t)2147483647 
#define SLAPD_ENTRYUSN_IMPORT_INIT      "0"
#define SLAPD_ERROR_LOG 0x2
#define SLAPD_EXEMODE_ARCHIVE2DB       5
#define SLAPD_EXEMODE_DB2ARCHIVE       4
#define SLAPD_EXEMODE_DB2INDEX         7
#define SLAPD_EXEMODE_DB2LDIF          2
#define SLAPD_EXEMODE_DBTEST           6
#define SLAPD_EXEMODE_DBVERIFY        12
#define SLAPD_EXEMODE_LDIF2DB          3
#define SLAPD_EXEMODE_PRINTVERSION    10
#define SLAPD_EXEMODE_REFERRAL         8
#define SLAPD_EXEMODE_SLAPD            1
#define SLAPD_EXEMODE_SUFFIX2INSTANCE  9
#define SLAPD_EXEMODE_UNKNOWN          0
#define SLAPD_EXEMODE_UPGRADEDB       11
#define SLAPD_EXEMODE_UPGRADEDNFORMAT 13
#define SLAPD_INIT_ACCESSLOG_ROTATIONUNIT    "day"
#define SLAPD_INIT_AUDITFAILLOG_ROTATIONUNIT "week"
#define SLAPD_INIT_AUDITLOG_ROTATIONUNIT     "week"
#define SLAPD_INIT_ERRORLOG_ROTATIONUNIT     "week"
#define SLAPD_INIT_LOGGING_BACKEND_INTERNAL "dirsrv-log"
#define SLAPD_INIT_LOG_EXPTIMEUNIT           "month"
#define SLAPD_INIT_LOG_MODE "600"
#define SLAPD_INVALID_SOCKET 0
#define SLAPD_INVALID_SOCKET_INDEX (-1)
#define SLAPD_LDAPI_DEFAULT_FILENAME "/var/run/ldapi"
#define SLAPD_LDAPI_DEFAULT_STATUS "off"
#define SLAPD_POLL_FLAGS (POLLIN)
#define SLAPD_PR_WOULD_BLOCK_ERROR(prerrno) \
    ((prerrno) == PR_WOULD_BLOCK_ERROR || (prerrno) == PR_IO_TIMEOUT_ERROR)
#define SLAPD_SCHEMA_DN  "cn=schema"
#define SLAPD_SHORT_VERSION_STR DS_PACKAGE_VERSION
#define SLAPD_SNMP_UPDATE_INTERVAL (10 * 1000) 
#define SLAPD_SSLCLIENTAUTH_ALLOWED  1 
#define SLAPD_SSLCLIENTAUTH_OFF      0
#define SLAPD_SSLCLIENTAUTH_REQUIRED 2 
#define SLAPD_SYSTEM_WOULD_BLOCK_ERROR(syserrno) \
    ((syserrno) == EAGAIN || (syserrno) == EWOULDBLOCK)
#define SLAPD_TYPICAL_ATTRIBUTE_NAME_MAX_LENGTH 256
#define SLAPD_VALIDATE_CERT_OFF 0
#define SLAPD_VALIDATE_CERT_ON 1
#define SLAPD_VALIDATE_CERT_WARN 2
#define SLAPD_VENDOR_NAME VENDOR
#define SLAPD_VERSION_STR CAPBRAND "-Directory/" DS_PACKAGE_VERSION
#define SLAPI_ATTR_FLAG_KEEP 0x8000                 
#define SLAPI_ATTR_FLAG_NOLOCKING 0x0020            
#define SLAPI_ATTR_FLAG_OVERRIDE 0x0010             
#define SLAPI_ATTR_FLAG_SYNTAX_IS_DN 0x020000       
#define SLAPI_ATTR_FLAG_SYNTAX_LOOKUP_DONE 0x010000 
#define SLAPI_CFG_USE_RWLOCK 0
#define SLAPI_OP_STATUS_ABANDONED     1 
#define SLAPI_OP_STATUS_PROCESSING    0 
#define SLAPI_OP_STATUS_RESULT_SENT   3   
#define SLAPI_OP_STATUS_WILL_COMPLETE 2 
#define SNMP_FIELD_LENGTH 100
#define SPACE_INSENSITIVE_STRING_SYNTAX_OID "2.16.840.1.113730.3.7.1"
#define START_TLS_OID "1.3.6.1.4.1.1466.20037"
#define SUPPLIER_POLICY_1 ATTR_SCHEMA_UPDATE_OBJECTCLASS_ACCEPT ": printer-uri-oid\n"
#define SUPPLIER_POLICY_2 ATTR_SCHEMA_UPDATE_ATTRIBUTE_ACCEPT ": PSEUDO_ATTR_UNHASHEDUSERPASSWORD_OID\n"
#define TELEPHONE_SYNTAX_OID          "1.3.6.1.4.1.1466.115.121.1.50"
#define TELETEXTERMID_SYNTAX_OID      "1.3.6.1.4.1.1466.115.121.1.51"
#define TELEXNUMBER_SYNTAX_OID        "1.3.6.1.4.1.1466.115.121.1.52"
#define TIMER_AVG_CHECK(x)                                     \
    do {                                                       \
        if (x##_count >= 1000) {                               \
            printf("timer %s: %d\n", #x, TIMER_AVG_GET_US(x)); \
            x##_total = x##_count = 0;                         \
        }                                                      \
    } while (0)
#define TIMER_AVG_DECL(x) \
    TIMER_DECL(x);        \
    static unsigned int x##_total, x##_count
#define TIMER_AVG_GET_US(x) (unsigned int)(x##_total / x##_count)
#define TIMER_AVG_START(x) \
    TIMER_START(x)
#define TIMER_AVG_STOP(x)                 \
    do {                                  \
        TIMER_STOP(x);                    \
        if (TIMER_GET_US(x) < 10000) {    \
            x##_count++;                  \
            x##_total += TIMER_GET_US(x); \
        }                                 \
    } while (0)
#define TIMER_DECL(x) struct timeval x##_start, x##_end
#define TIMER_GET_US(x) (unsigned)(((x##_end).tv_sec - (x##_start).tv_sec) * 100000L + \
                                   ((x##_end).tv_usec - (x##_start).tv_usec))
#define TIMER_START(x) GTOD(&(x##_start))
#define TIMER_STOP(x) GTOD(&(x##_end))
#define UID_SIZE 16 
#define VALUE_SORT_THRESHOLD 10
#define _MAX_SHADOW 99999
#define _SEC_PER_DAY 86400

#define be_abandon be_database->plg_abandon
#define be_add be_database->plg_add
#define be_archive2db be_database->plg_archive2db
#define be_bind be_database->plg_bind
#define be_cleanup be_database->plg_cleanup
#define be_close be_database->plg_close
#define be_compare be_database->plg_compare
#define be_config be_database->plg_config
#define be_ctrl_info be_database->plg_ctrl_info
#define be_db2archive be_database->plg_db2archive
#define be_db2index be_database->plg_db2index
#define be_db2ldif be_database->plg_db2ldif
#define be_dbsize be_database->plg_dbsize
#define be_dbtest be_database->plg_dbtest
#define be_delete be_database->plg_delete
#define be_entry_release be_database->plg_entry_release
#define be_get_info be_database->plg_get_info
#define be_init_instance be_database->plg_init_instance
#define be_ldif2db be_database->plg_ldif2db
#define be_modify be_database->plg_modify
#define be_modrdn be_database->plg_modrdn
#define be_next_search_entry be_database->plg_next_search_entry
#define be_next_search_entry_ext be_database->plg_next_search_entry_ext
#define be_poststart be_database->plg_poststart
#define be_prev_search_results be_database->plg_prev_search_results
#define be_result be_database->plg_result
#define be_rmdb be_database->plg_rmdb
#define be_search be_database->plg_search
#define be_search_results_release be_database->plg_search_results_release
#define be_seq be_database->plg_seq
#define be_set_info be_database->plg_set_info
#define be_start be_database->plg_start
#define be_unbind be_database->plg_unbind
#define be_upgradedb be_database->plg_upgradedb
#define be_upgradednformat be_database->plg_upgradednformat
#define be_wire_import be_database->plg_wire_import
#define f_and f_un.f_un_complex
#define f_ava f_un.f_un_ava
#define f_avtype f_un.f_un_ava.ava_type
#define f_avvalue f_un.f_un_ava.ava_value
#define f_list f_un.f_un_complex
#define f_mr f_un.f_un_extended
#define f_mr_dnAttrs f_un.f_un_extended.mrf_dnAttrs
#define f_mr_oid f_un.f_un_extended.mrf_oid
#define f_mr_type f_un.f_un_extended.mrf_type
#define f_mr_value f_un.f_un_extended.mrf_value
#define f_not f_un.f_un_complex
#define f_or f_un.f_un_complex
#define f_sub f_un.f_un_sub
#define f_sub_any f_un.f_un_sub.sf_any
#define f_sub_final f_un.f_un_sub.sf_final
#define f_sub_initial f_un.f_un_sub.sf_initial
#define f_sub_type f_un.f_un_sub.sf_type
#define f_type f_un.f_un_type
#define plg_abandon plg_un.plg_un_db.plg_un_db_abandon
#define plg_acl_access_allowed plg_un.plg_un_acl.plg_un_acl_access_allowed
#define plg_acl_init plg_un.plg_un_acl.plg_un_acl_init
#define plg_acl_mods_allowed plg_un.plg_un_acl.plg_un_acl_mods_allowed
#define plg_acl_mods_update plg_un.plg_un_acl.plg_un_acl_mods_update
#define plg_acl_syntax_check plg_un.plg_un_acl.plg_un_acl_syntax_check
#define plg_add plg_un.plg_un_db.plg_un_db_add
#define plg_add_schema plg_un.plg_un_db.plg_un_db_add_schema
#define plg_archive2db plg_un.plg_un_db.plg_un_db_archive2db
#define plg_be_exhandler plg_un.plg_un_pe.plg_un_pe_be_exhandler
#define plg_bepostadd plg_un.plg_un_bepost.plg_un_bepost_add
#define plg_bepostdelete plg_un.plg_un_bepost.plg_un_bepost_delete
#define plg_bepostexport plg_un.plg_un_bepost.plg_un_bepost_export
#define plg_bepostimport plg_un.plg_un_bepost.plg_un_bepost_import
#define plg_bepostmodify plg_un.plg_un_bepost.plg_un_bepost_modify
#define plg_bepostmodrdn plg_un.plg_un_bepost.plg_un_bepost_modrdn
#define plg_bepostopen plg_un.plg_un_bepost.plg_un_bepost_open
#define plg_bepreadd plg_un.plg_un_bepre.plg_un_bepre_add
#define plg_bepreclose plg_un.plg_un_bepre.plg_un_bepre_close
#define plg_bepredelete plg_un.plg_un_bepre.plg_un_bepre_delete
#define plg_bepremodify plg_un.plg_un_bepre.plg_un_bepre_modify
#define plg_bepremodrdn plg_un.plg_un_bepre.plg_un_bepre_modrdn
#define plg_betxnpostadd plg_un.plg_un_betxnpost.plg_un_betxnpost_add
#define plg_betxnpostdelete plg_un.plg_un_betxnpost.plg_un_betxnpost_delete
#define plg_betxnpostmodify plg_un.plg_un_betxnpost.plg_un_betxnpost_modify
#define plg_betxnpostmodrdn plg_un.plg_un_betxnpost.plg_un_betxnpost_modrdn
#define plg_betxnpreadd plg_un.plg_un_betxnpre.plg_un_betxnpre_add
#define plg_betxnpredelete plg_un.plg_un_betxnpre.plg_un_betxnpre_delete
#define plg_betxnpredeletetombstone plg_un.plg_un_betxnpre.plg_un_betxnpre_delete_tombstone
#define plg_betxnpremodify plg_un.plg_un_betxnpre.plg_un_betxnpre_modify
#define plg_betxnpremodrdn plg_un.plg_un_betxnpre.plg_un_betxnpre_modrdn
#define plg_bind plg_un.plg_un_db.plg_un_db_bind
#define plg_compare plg_un.plg_un_db.plg_un_db_compare
#define plg_config plg_un.plg_un_db.plg_un_db_config
#define plg_ctrl_info plg_un.plg_un_db.plg_un_db_ctrl_info
#define plg_db2archive plg_un.plg_un_db.plg_un_db_db2archive
#define plg_db2index plg_un.plg_un_db.plg_un_db_db2index
#define plg_db2ldif plg_un.plg_un_db.plg_un_db_db2ldif
#define plg_dbsize plg_un.plg_un_db.plg_un_db_dbsize
#define plg_dbtest plg_un.plg_un_db.plg_un_db_dbtest
#define plg_dbverify plg_un.plg_un_db.plg_un_db_verify
#define plg_delete plg_un.plg_un_db.plg_un_db_delete
#define plg_entry plg_un.plg_un_db.plg_un_db_entry
#define plg_entry_release plg_un.plg_un_db.plg_un_db_entry_release
#define plg_entryfetchfunc plg_un.plg_un_entry_fetch_store.plg_un_entry_fetch_func
#define plg_entrystorefunc plg_un.plg_un_entry_fetch_store.plg_un_entry_store_func
#define plg_exhandler plg_un.plg_un_pe.plg_un_pe_exhandler
#define plg_exnames plg_un.plg_un_pe.plg_un_pe_exnames
#define plg_exoids plg_un.plg_un_pe.plg_un_pe_exoids
#define plg_get_info plg_un.plg_un_db.plg_un_db_get_info
#define plg_init_instance plg_un.plg_un_db.plg_un_db_init_instance
#define plg_internal_post_add plg_un.plg_un_internal_post.plg_un_internal_post_add
#define plg_internal_post_delete plg_un.plg_un_internal_post.plg_un_internal_post_delete
#define plg_internal_post_modify plg_un.plg_un_internal_post.plg_un_internal_post_modify
#define plg_internal_post_modrdn plg_un.plg_un_internal_post.plg_un_internal_post_modrdn
#define plg_internal_pre_add plg_un.plg_un_internal_pre.plg_un_internal_pre_add
#define plg_internal_pre_bind plg_un.plg_un_internal_pre.plg_un_internal_pre_bind
#define plg_internal_pre_delete plg_un.plg_un_internal_pre.plg_un_internal_pre_delete
#define plg_internal_pre_modify plg_un.plg_un_internal_pre.plg_un_internal_pre_modify
#define plg_internal_pre_modrdn plg_un.plg_un_internal_pre.plg_un_internal_pre_modrdn
#define plg_ldif2db plg_un.plg_un_db.plg_un_db_ldif2db
#define plg_mmr_betxn_postop 		plg_un.plg_un_mmr.plg_un_mmr_betxn_postop
#define plg_mmr_betxn_preop 		plg_un.plg_un_mmr.plg_un_mmr_betxn_preop
#define plg_modify plg_un.plg_un_db.plg_un_db_modify
#define plg_modrdn plg_un.plg_un_db.plg_un_db_modrdn
#define plg_mr_assertion2keys_ava plg_un.plg_un_mr.plg_un_mr_assertion2keys_ava
#define plg_mr_assertion2keys_sub plg_un.plg_un_mr.plg_un_mr_assertion2keys_sub
#define plg_mr_compare plg_un.plg_un_mr.plg_un_mr_compare
#define plg_mr_filter_ava plg_un.plg_un_mr.plg_un_mr_filter_ava
#define plg_mr_filter_create plg_un.plg_un_mr.plg_un_mr_filter_create
#define plg_mr_filter_sub plg_un.plg_un_mr.plg_un_mr_filter_sub
#define plg_mr_flags plg_un.plg_un_mr.plg_un_mr_flags
#define plg_mr_indexer_create plg_un.plg_un_mr.plg_un_mr_indexer_create
#define plg_mr_names plg_un.plg_un_mr.plg_un_mr_names
#define plg_mr_normalize plg_un.plg_un_mr.plg_un_mr_normalize
#define plg_mr_values2keys plg_un.plg_un_mr.plg_un_mr_values2keys
#define plg_next_search_entry plg_un.plg_un_db.plg_un_db_next_search_entry
#define plg_next_search_entry_ext plg_un.plg_un_db.plg_un_db_next_search_entry_ext
#define plg_postabandon plg_un.plg_un_post.plg_un_post_abandon
#define plg_postadd plg_un.plg_un_post.plg_un_post_add
#define plg_postbind plg_un.plg_un_post.plg_un_post_bind
#define plg_postcompare plg_un.plg_un_post.plg_un_post_compare
#define plg_postdelete plg_un.plg_un_post.plg_un_post_delete
#define plg_postentry plg_un.plg_un_post.plg_un_post_entry
#define plg_postextop plg_un.plg_un_pe.plg_un_pe_post_exhandler
#define plg_postmodify plg_un.plg_un_post.plg_un_post_modify
#define plg_postmodrdn plg_un.plg_un_post.plg_un_post_modrdn
#define plg_postreferral plg_un.plg_un_post.plg_un_post_referral
#define plg_postresult plg_un.plg_un_post.plg_un_post_result
#define plg_postsearch plg_un.plg_un_post.plg_un_post_search
#define plg_postsearchfail plg_un.plg_un_post.plg_un_post_searchfail
#define plg_postunbind plg_un.plg_un_post.plg_un_post_unbind
#define plg_preabandon plg_un.plg_un_pre.plg_un_pre_abandon
#define plg_preadd plg_un.plg_un_pre.plg_un_pre_add
#define plg_prebind plg_un.plg_un_pre.plg_un_pre_bind
#define plg_precompare plg_un.plg_un_pre.plg_un_pre_compare
#define plg_predelete plg_un.plg_un_pre.plg_un_pre_delete
#define plg_preentry plg_un.plg_un_pre.plg_un_pre_entry
#define plg_preextop plg_un.plg_un_pe.plg_un_pe_pre_exhandler
#define plg_premodify plg_un.plg_un_pre.plg_un_pre_modify
#define plg_premodrdn plg_un.plg_un_pre.plg_un_pre_modrdn
#define plg_prereferral plg_un.plg_un_pre.plg_un_pre_referral
#define plg_preresult plg_un.plg_un_pre.plg_un_pre_result
#define plg_presearch plg_un.plg_un_pre.plg_un_pre_search
#define plg_preunbind plg_un.plg_un_pre.plg_un_pre_unbind
#define plg_prev_search_results plg_un.plg_un_db.plg_un_db_prev_search_results
#define plg_pwdstorageschemecmp plg_un.plg_un_pwd_storage_scheme.plg_un_pwd_storage_scheme_cmp
#define plg_pwdstorageschemedec plg_un.plg_un_pwd_storage_scheme.plg_un_pwd_storage_scheme_dec
#define plg_pwdstorageschemeenc plg_un.plg_un_pwd_storage_scheme.plg_un_pwd_storage_scheme_enc
#define plg_pwdstorageschemename plg_un.plg_un_pwd_storage_scheme.plg_un_pwd_storage_scheme_name
#define plg_referral plg_un.plg_un_db.plg_un_db_referral
#define plg_result plg_un.plg_un_db.plg_un_db_result
#define plg_rmdb plg_un.plg_un_db.plg_un_db_rmdb
#define plg_search plg_un.plg_un_db.plg_un_db_search
#define plg_search_results_release plg_un.plg_un_db.plg_un_db_search_results_release
#define plg_seq plg_un.plg_un_db.plg_un_db_seq
#define plg_set_info plg_un.plg_un_db.plg_un_db_set_info
#define plg_syntax_assertion2keys_ava plg_un.plg_un_syntax.plg_un_syntax_assertion2keys_ava
#define plg_syntax_assertion2keys_sub plg_un.plg_un_syntax.plg_un_syntax_assertion2keys_sub
#define plg_syntax_compare plg_un.plg_un_syntax.plg_un_syntax_compare
#define plg_syntax_filter_ava plg_un.plg_un_syntax.plg_un_syntax_filter_ava
#define plg_syntax_filter_sub plg_un.plg_un_syntax.plg_un_syntax_filter_sub
#define plg_syntax_flags plg_un.plg_un_syntax.plg_un_syntax_flags
#define plg_syntax_names plg_un.plg_un_syntax.plg_un_syntax_names
#define plg_syntax_normalize plg_un.plg_un_syntax.plg_un_syntax_normalize
#define plg_syntax_oid plg_un.plg_un_syntax.plg_un_syntax_oid
#define plg_syntax_validate plg_un.plg_un_syntax.plg_un_syntax_validate
#define plg_syntax_values2keys plg_un.plg_un_syntax.plg_un_syntax_values2keys
#define plg_unbind plg_un.plg_un_db.plg_un_db_unbind
#define plg_upgradedb plg_un.plg_un_db.plg_un_db_upgradedb
#define plg_upgradednformat plg_un.plg_un_db.plg_un_db_upgradednformat
#define plg_wire_import plg_un.plg_un_db.plg_un_db_wire_import
#define INLINE_DIRECTIVE __inline
#define strcmpi(x, y) strcmpi_fast(x, y)
#define tolower(x) tolower_fast(x)
#define toupper(x) toupper_fast(x)
#define MRF_ANY_TYPE  1
#define MRF_ANY_VALUE 2

#define PWD_HASH_PREFIX_END '}'
#define PWD_HASH_PREFIX_START '{'
#define PWD_MAX_NAME_LEN 13

#define I64(C) C##LL

#define unsigned64_t unsigned long long

#define SLAPD_DISCONNECT_ABORT SLAPD_DISCONNECT_ERROR_BASE + 0
#define SLAPD_DISCONNECT_BAD_BER_TAG SLAPD_DISCONNECT_ERROR_BASE + 1
#define SLAPD_DISCONNECT_BER_FLUSH SLAPD_DISCONNECT_ERROR_BASE + 4
#define SLAPD_DISCONNECT_BER_PEEK SLAPD_DISCONNECT_ERROR_BASE + 3
#define SLAPD_DISCONNECT_BER_TOO_BIG SLAPD_DISCONNECT_ERROR_BASE + 2
#define SLAPD_DISCONNECT_ERROR_BASE -5000
#define SLAPD_DISCONNECT_IDLE_TIMEOUT SLAPD_DISCONNECT_ERROR_BASE + 5
#define SLAPD_DISCONNECT_IO_TIMEOUT SLAPD_DISCONNECT_ERROR_BASE + 7
#define SLAPD_DISCONNECT_NTSSL_TIMEOUT SLAPD_DISCONNECT_ERROR_BASE + 11
#define SLAPD_DISCONNECT_PLUGIN SLAPD_DISCONNECT_ERROR_BASE + 8
#define SLAPD_DISCONNECT_POLL SLAPD_DISCONNECT_ERROR_BASE + 10
#define SLAPD_DISCONNECT_REVENTS SLAPD_DISCONNECT_ERROR_BASE + 6
#define SLAPD_DISCONNECT_SASL_FAIL SLAPD_DISCONNECT_ERROR_BASE + 12
#define SLAPD_DISCONNECT_UNBIND SLAPD_DISCONNECT_ERROR_BASE + 9




#define LDAPS_URL_PREFIX "ldaps://"
#define LDAPS_URL_PREFIX_LEN 8
#define LDAP_AUTH_KRBV41_30 0xa1L 
#define LDAP_AUTH_KRBV42_30 0xa2L 
#define LDAP_AUTH_SIMPLE_30 0xa0L 
#define LDAP_FILTER_AND 0xa0L 
#define LDAP_FILTER_APPROX 0xa8L 
#define LDAP_FILTER_EQUALITY 0xa3L 
#define LDAP_FILTER_EXTENDED_DNATTRS LDAP_FILTER_EXT_DNATTRS
#define LDAP_FILTER_EXTENDED_OID LDAP_FILTER_EXT_OID
#define LDAP_FILTER_EXTENDED_TYPE LDAP_FILTER_EXT_TYPE
#define LDAP_FILTER_EXTENDED_VALUE LDAP_FILTER_EXT_VALUE
#define LDAP_FILTER_GE 0xa5L 
#define LDAP_FILTER_LE 0xa6L 
#define LDAP_FILTER_NOT 0xa2L 
#define LDAP_FILTER_OR 0xa1L 
#define LDAP_FILTER_PRESENT 0x87L 
#define LDAP_FILTER_PRESENT_30 0xa7L 
#define LDAP_FILTER_SUBSTRINGS 0xa4L 
#define LDAP_REF_STR "Referral:\n"
#define LDAP_REF_STR_LEN 10
#define LDAP_REQ_ABANDON_30 0x70L
#define LDAP_REQ_DELETE_30 0x6aL
#define LDAP_REQ_UNBIND_30 0x62L
#define LDAP_SUBSTRING_ANY 0x81L 
#define LDAP_SUBSTRING_ANY_30 0xa1L     
#define LDAP_SUBSTRING_FINAL 0x82L 
#define LDAP_SUBSTRING_FINAL_30 0xa2L   
#define LDAP_SUBSTRING_INITIAL 0x80L 
#define LDAP_SUBSTRING_INITIAL_30 0xa0L 
#define LDAP_TAG_CONTROLS 0xa0L 
#define LDAP_TAG_EXOP_REQ_OID 0x80L 
#define LDAP_TAG_EXOP_REQ_VALUE 0x81L 
#define LDAP_TAG_EXOP_RES_OID 0x8aL 
#define LDAP_TAG_EXOP_RES_VALUE 0x8bL 
#define LDAP_TAG_LDAPDN 0x04L 
#define LDAP_TAG_MESSAGE 0x30L 
#define LDAP_TAG_MRA_DNATTRS 0x84L 
#define LDAP_TAG_MRA_OID 0x81L 
#define LDAP_TAG_MRA_TYPE 0x82L 
#define LDAP_TAG_MRA_VALUE 0x83L 
#define LDAP_TAG_MSGID 0x02L 
#define LDAP_TAG_NEWSUPERIOR 0x80L 
#define LDAP_TAG_PWP_ERROR 0x81L 
#define LDAP_TAG_PWP_GRCLOGINS 0x81L 
#define LDAP_TAG_PWP_SECSLEFT 0x80L 
#define LDAP_TAG_PWP_WARNING 0xA0 
#define LDAP_TAG_REFERRAL 0xa3L 
#define LDAP_TAG_SASL_RES_CREDS 0x87L 
#define LDAP_TAG_SK_MATCHRULE 0x80L 
#define LDAP_TAG_SK_REVERSE 0x81L 
#define LDAP_TAG_SR_ATTRTYPE 0x80L 
#define LDAP_TAG_VLV_BY_INDEX 0xa0L 
#define LDAP_TAG_VLV_BY_VALUE 0x81L 
#define LDAP_URL_PREFIX "ldap://"
#define LDAP_URL_PREFIX_LEN 7
#define LDAP_VERSION LDAP_VERSION2
#define LDAP_VERSION1 1
#define LDAP_VERSION2 2
#define LDAP_VERSION3 3
#define OLD_LDAP_AUTH_KRBV4 0x01L
#define OLD_LDAP_AUTH_KRBV42 0x02L
#define OLD_LDAP_AUTH_SIMPLE 0x00L
#define OLD_LDAP_FILTER_AND 0x00L
#define OLD_LDAP_FILTER_APPROX 0x08L
#define OLD_LDAP_FILTER_EQUALITY 0x03L
#define OLD_LDAP_FILTER_GE 0x05L
#define OLD_LDAP_FILTER_LE 0x06L
#define OLD_LDAP_FILTER_NOT 0x02L
#define OLD_LDAP_FILTER_OR 0x01L
#define OLD_LDAP_FILTER_PRESENT 0x07L
#define OLD_LDAP_FILTER_SUBSTRINGS 0x04L
#define OLD_LDAP_REQ_ABANDON 0x10L
#define OLD_LDAP_REQ_ADD 0x08L
#define OLD_LDAP_REQ_BIND 0x00L
#define OLD_LDAP_REQ_COMPARE 0x0eL
#define OLD_LDAP_REQ_DELETE 0x0aL
#define OLD_LDAP_REQ_MODDN 0x0cL
#define OLD_LDAP_REQ_MODIFY 0x06L
#define OLD_LDAP_REQ_MODRDN 0x0cL
#define OLD_LDAP_REQ_SEARCH 0x03L
#define OLD_LDAP_REQ_UNBIND 0x02L
#define OLD_LDAP_RES_ADD 0x09L
#define OLD_LDAP_RES_BIND 0x01L
#define OLD_LDAP_RES_COMPARE 0x0fL
#define OLD_LDAP_RES_DELETE 0x0bL
#define OLD_LDAP_RES_MODDN 0x0dL
#define OLD_LDAP_RES_MODIFY 0x07L
#define OLD_LDAP_RES_MODRDN 0x0dL
#define OLD_LDAP_RES_SEARCH_ENTRY 0x04L
#define OLD_LDAP_RES_SEARCH_RESULT 0x05L
#define OLD_LDAP_SUBSTRING_ANY 0x01L
#define OLD_LDAP_SUBSTRING_FINAL 0x02L
#define OLD_LDAP_SUBSTRING_INITIAL 0x00L
#define OLD_LDAP_TAG_MESSAGE 0x10L 

