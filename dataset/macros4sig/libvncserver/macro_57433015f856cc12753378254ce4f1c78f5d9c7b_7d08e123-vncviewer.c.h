#include<zlib.h>


#include<stdint.h>
#include<unistd.h>
#include<sys/time.h>
#include<string.h>
#include<arpa/inet.h>
#include<sys/select.h>
#include<time.h>
#include<stdlib.h>
#include<stdio.h>
#include<sys/timeb.h>
#include<termios.h>

#include<netinet/in.h>

#define DEFAULT_CONNECT_TIMEOUT 60
#define DEFAULT_READ_TIMEOUT 0
#define DEFAULT_SSH_CMD "/usr/bin/ssh"
#define DEFAULT_TUNNEL_CMD  \
  (DEFAULT_SSH_CMD " -f -L %L:localhost:%R %H sleep 20")
#define DEFAULT_VIA_CMD     \
  (DEFAULT_SSH_CMD " -f -L %L:%H:%R %G sleep 20")
#define FLASH_PORT_OFFSET 5400
#define LISTEN_PORT_OFFSET 5500

#define RFB_BUFFER_SIZE (640*480)
#define RFB_BUF_SIZE 8192
#define SERVER_PORT_OFFSET 5900
#define TUNNEL_PORT_OFFSET 5500
#define WIN32_LEAN_AND_MEAN 
#define ZLIB_BUFFER_SIZE 30000
#define rfbClientSwap16IfLE(s) \
    (*(char *)&client->endianTest ? ((((s) & 0xff) << 8) | (((s) >> 8) & 0xff)) : (s))
#define rfbClientSwap32IfLE(l) \
    (*(char *)&client->endianTest ? ((((l) >> 24) & 0x000000ff) | \
			     (((l) & 0x00ff0000) >> 8)  | \
			     (((l) & 0x0000ff00) << 8)  | \
			     (((l) & 0x000000ff) << 24))  : (l))
#define rfbClientSwap64IfLE(l) \
    (*(char *)&client->endianTest ? ((((l) >> 56 ) & 0x00000000000000ffULL) | \
			     (((l) & 0x00ff000000000000ULL) >> 40)  | \
			     (((l) & 0x0000ff0000000000ULL) >> 24)  | \
			     (((l) & 0x000000ff00000000ULL) >> 8)  | \
			     (((l) & 0x00000000ff000000ULL) << 8)  | \
			     (((l) & 0x0000000000ff0000ULL) << 24)  | \
			     (((l) & 0x000000000000ff00ULL) << 40)  | \
			     (((l) & 0x00000000000000ffULL) << 56))  : (l))
#define rfbCredentialTypeUser 2
#define rfbCredentialTypeX509 1
#define rfbX509CrlVerifyAll    2    
#define rfbX509CrlVerifyClient 1    
#define rfbX509CrlVerifyNone   0    
#define XK_0                   0x030
#define XK_1                   0x031
#define XK_2                   0x032
#define XK_3                   0x033
#define XK_3270_AltCursor      0xFD10
#define XK_3270_Attn           0xFD0E
#define XK_3270_BackTab        0xFD05
#define XK_3270_ChangeScreen   0xFD19
#define XK_3270_Copy           0xFD15
#define XK_3270_CursorBlink    0xFD0F
#define XK_3270_CursorSelect   0xFD1C
#define XK_3270_DeleteWord     0xFD1A
#define XK_3270_Duplicate      0xFD01
#define XK_3270_Enter          0xFD1E
#define XK_3270_EraseEOF       0xFD06
#define XK_3270_EraseInput     0xFD07
#define XK_3270_ExSelect       0xFD1B
#define XK_3270_FieldMark      0xFD02
#define XK_3270_Ident          0xFD13
#define XK_3270_Jump           0xFD12
#define XK_3270_KeyClick       0xFD11
#define XK_3270_Left2          0xFD04
#define XK_3270_PA1            0xFD0A
#define XK_3270_PA2            0xFD0B
#define XK_3270_PA3            0xFD0C
#define XK_3270_Play           0xFD16
#define XK_3270_PrintScreen    0xFD1D
#define XK_3270_Quit           0xFD09
#define XK_3270_Record         0xFD18
#define XK_3270_Reset          0xFD08
#define XK_3270_Right2         0xFD03
#define XK_3270_Rule           0xFD14
#define XK_3270_Setup          0xFD17
#define XK_3270_Test           0xFD0D
#define XK_4                   0x034
#define XK_5                   0x035
#define XK_6                   0x036
#define XK_7                   0x037
#define XK_8                   0x038
#define XK_9                   0x039
#define XK_A                   0x041
#define XK_AE                  0x0c6
#define XK_Aacute              0x0c1
#define XK_Abreve              0x1c3
#define XK_Acircumflex         0x0c2
#define XK_Adiaeresis          0x0c4
#define XK_Agrave              0x0c0
#define XK_Amacron             0x3c0
#define XK_Aogonek             0x1a1
#define XK_Arabic_ain                                  0x5d9
#define XK_Arabic_alef                                 0x5c7
#define XK_Arabic_alefmaksura                          0x5e9
#define XK_Arabic_beh                                  0x5c8
#define XK_Arabic_comma                                0x5ac
#define XK_Arabic_dad                                  0x5d6
#define XK_Arabic_dal                                  0x5cf
#define XK_Arabic_damma                                0x5ef
#define XK_Arabic_dammatan                             0x5ec
#define XK_Arabic_fatha                                0x5ee
#define XK_Arabic_fathatan                             0x5eb
#define XK_Arabic_feh                                  0x5e1
#define XK_Arabic_ghain                                0x5da
#define XK_Arabic_ha                                   0x5e7
#define XK_Arabic_hah                                  0x5cd
#define XK_Arabic_hamza                                0x5c1
#define XK_Arabic_hamzaonalef                          0x5c3
#define XK_Arabic_hamzaonwaw                           0x5c4
#define XK_Arabic_hamzaonyeh                           0x5c6
#define XK_Arabic_hamzaunderalef                       0x5c5
#define XK_Arabic_heh                                  0x5e7  
#define XK_Arabic_jeem                                 0x5cc
#define XK_Arabic_kaf                                  0x5e3
#define XK_Arabic_kasra                                0x5f0
#define XK_Arabic_kasratan                             0x5ed
#define XK_Arabic_khah                                 0x5ce
#define XK_Arabic_lam                                  0x5e4
#define XK_Arabic_maddaonalef                          0x5c2
#define XK_Arabic_meem                                 0x5e5
#define XK_Arabic_noon                                 0x5e6
#define XK_Arabic_qaf                                  0x5e2
#define XK_Arabic_question_mark                        0x5bf
#define XK_Arabic_ra                                   0x5d1
#define XK_Arabic_sad                                  0x5d5
#define XK_Arabic_seen                                 0x5d3
#define XK_Arabic_semicolon                            0x5bb
#define XK_Arabic_shadda                               0x5f1
#define XK_Arabic_sheen                                0x5d4
#define XK_Arabic_sukun                                0x5f2
#define XK_Arabic_switch        0xFF7E  
#define XK_Arabic_tah                                  0x5d7
#define XK_Arabic_tatweel                              0x5e0
#define XK_Arabic_teh                                  0x5ca
#define XK_Arabic_tehmarbuta                           0x5c9
#define XK_Arabic_thal                                 0x5d0
#define XK_Arabic_theh                                 0x5cb
#define XK_Arabic_waw                                  0x5e8
#define XK_Arabic_yeh                                  0x5ea
#define XK_Arabic_zah                                  0x5d8
#define XK_Arabic_zain                                 0x5d2
#define XK_Aring               0x0c5
#define XK_Atilde              0x0c3
#define XK_B                   0x042
#define XK_Byelorussian_SHORTU                         0x6be
#define XK_Byelorussian_shortu                         0x6ae
#define XK_C                   0x043
#define XK_Cabovedot           0x2c5
#define XK_Cacute              0x1c6
#define XK_Ccaron              0x1c8
#define XK_Ccedilla            0x0c7
#define XK_Ccircumflex         0x2c6
#define XK_Cyrillic_A                                  0x6e1
#define XK_Cyrillic_BE                                 0x6e2
#define XK_Cyrillic_CHE                                0x6fe
#define XK_Cyrillic_DE                                 0x6e4
#define XK_Cyrillic_DZHE                               0x6bf
#define XK_Cyrillic_E                                  0x6fc
#define XK_Cyrillic_EF                                 0x6e6
#define XK_Cyrillic_EL                                 0x6ec
#define XK_Cyrillic_EM                                 0x6ed
#define XK_Cyrillic_EN                                 0x6ee
#define XK_Cyrillic_ER                                 0x6f2
#define XK_Cyrillic_ES                                 0x6f3
#define XK_Cyrillic_GHE                                0x6e7
#define XK_Cyrillic_HA                                 0x6e8
#define XK_Cyrillic_HARDSIGN                           0x6ff
#define XK_Cyrillic_I                                  0x6e9
#define XK_Cyrillic_IE                                 0x6e5
#define XK_Cyrillic_IO                                 0x6b3
#define XK_Cyrillic_JE                                 0x6b8
#define XK_Cyrillic_KA                                 0x6eb
#define XK_Cyrillic_LJE                                0x6b9
#define XK_Cyrillic_NJE                                0x6ba
#define XK_Cyrillic_O                                  0x6ef
#define XK_Cyrillic_PE                                 0x6f0
#define XK_Cyrillic_SHA                                0x6fb
#define XK_Cyrillic_SHCHA                              0x6fd
#define XK_Cyrillic_SHORTI                             0x6ea
#define XK_Cyrillic_SOFTSIGN                           0x6f8
#define XK_Cyrillic_TE                                 0x6f4
#define XK_Cyrillic_TSE                                0x6e3
#define XK_Cyrillic_U                                  0x6f5
#define XK_Cyrillic_VE                                 0x6f7
#define XK_Cyrillic_YA                                 0x6f1
#define XK_Cyrillic_YERU                               0x6f9
#define XK_Cyrillic_YU                                 0x6e0
#define XK_Cyrillic_ZE                                 0x6fa
#define XK_Cyrillic_ZHE                                0x6f6
#define XK_Cyrillic_a                                  0x6c1
#define XK_Cyrillic_be                                 0x6c2
#define XK_Cyrillic_che                                0x6de
#define XK_Cyrillic_de                                 0x6c4
#define XK_Cyrillic_dzhe                               0x6af
#define XK_Cyrillic_e                                  0x6dc
#define XK_Cyrillic_ef                                 0x6c6
#define XK_Cyrillic_el                                 0x6cc
#define XK_Cyrillic_em                                 0x6cd
#define XK_Cyrillic_en                                 0x6ce
#define XK_Cyrillic_er                                 0x6d2
#define XK_Cyrillic_es                                 0x6d3
#define XK_Cyrillic_ghe                                0x6c7
#define XK_Cyrillic_ha                                 0x6c8
#define XK_Cyrillic_hardsign                           0x6df
#define XK_Cyrillic_i                                  0x6c9
#define XK_Cyrillic_ie                                 0x6c5
#define XK_Cyrillic_io                                 0x6a3
#define XK_Cyrillic_je                                 0x6a8
#define XK_Cyrillic_ka                                 0x6cb
#define XK_Cyrillic_lje                                0x6a9
#define XK_Cyrillic_nje                                0x6aa
#define XK_Cyrillic_o                                  0x6cf
#define XK_Cyrillic_pe                                 0x6d0
#define XK_Cyrillic_sha                                0x6db
#define XK_Cyrillic_shcha                              0x6dd
#define XK_Cyrillic_shorti                             0x6ca
#define XK_Cyrillic_softsign                           0x6d8
#define XK_Cyrillic_te                                 0x6d4
#define XK_Cyrillic_tse                                0x6c3
#define XK_Cyrillic_u                                  0x6d5
#define XK_Cyrillic_ve                                 0x6d7
#define XK_Cyrillic_ya                                 0x6d1
#define XK_Cyrillic_yeru                               0x6d9
#define XK_Cyrillic_yu                                 0x6c0
#define XK_Cyrillic_ze                                 0x6da
#define XK_Cyrillic_zhe                                0x6d6
#define XK_D                   0x044
#define XK_Dcaron              0x1cf
#define XK_Dstroke             0x1d0
#define XK_E                   0x045
#define XK_ENG                 0x3bd
#define XK_ETH                 0x0d0
#define XK_Eabovedot           0x3cc
#define XK_Eacute              0x0c9
#define XK_Ecaron              0x1cc
#define XK_Ecircumflex         0x0ca
#define XK_Ediaeresis          0x0cb
#define XK_Egrave              0x0c8
#define XK_Emacron             0x3aa
#define XK_Eogonek             0x1ca
#define XK_Eth                 0x0d0	
#define XK_EuroSign 0x20ac
#define XK_F                   0x046
#define XK_G                   0x047

#define XK_Gabovedot           0x2d5
#define XK_Gbreve              0x2ab
#define XK_Gcedilla            0x3ab
#define XK_Gcircumflex         0x2d8
#define XK_Greek_ALPHA                                 0x7c1
#define XK_Greek_ALPHAaccent                           0x7a1
#define XK_Greek_BETA                                  0x7c2
#define XK_Greek_CHI                                   0x7d7
#define XK_Greek_DELTA                                 0x7c4
#define XK_Greek_EPSILON                               0x7c5
#define XK_Greek_EPSILONaccent                         0x7a2
#define XK_Greek_ETA                                   0x7c7
#define XK_Greek_ETAaccent                             0x7a3
#define XK_Greek_GAMMA                                 0x7c3
#define XK_Greek_IOTA                                  0x7c9
#define XK_Greek_IOTAaccent                            0x7a4
#define XK_Greek_IOTAdieresis                          0x7a5
#define XK_Greek_KAPPA                                 0x7ca
#define XK_Greek_LAMBDA                                0x7cb
#define XK_Greek_LAMDA                                 0x7cb
#define XK_Greek_MU                                    0x7cc
#define XK_Greek_NU                                    0x7cd
#define XK_Greek_OMEGA                                 0x7d9
#define XK_Greek_OMEGAaccent                           0x7ab
#define XK_Greek_OMICRON                               0x7cf
#define XK_Greek_OMICRONaccent                         0x7a7
#define XK_Greek_PHI                                   0x7d6
#define XK_Greek_PI                                    0x7d0
#define XK_Greek_PSI                                   0x7d8
#define XK_Greek_RHO                                   0x7d1
#define XK_Greek_SIGMA                                 0x7d2
#define XK_Greek_TAU                                   0x7d4
#define XK_Greek_THETA                                 0x7c8
#define XK_Greek_UPSILON                               0x7d5
#define XK_Greek_UPSILONaccent                         0x7a8
#define XK_Greek_UPSILONdieresis                       0x7a9
#define XK_Greek_XI                                    0x7ce
#define XK_Greek_ZETA                                  0x7c6
#define XK_Greek_accentdieresis                        0x7ae
#define XK_Greek_alpha                                 0x7e1
#define XK_Greek_alphaaccent                           0x7b1
#define XK_Greek_beta                                  0x7e2
#define XK_Greek_chi                                   0x7f7
#define XK_Greek_delta                                 0x7e4
#define XK_Greek_epsilon                               0x7e5
#define XK_Greek_epsilonaccent                         0x7b2
#define XK_Greek_eta                                   0x7e7
#define XK_Greek_etaaccent                             0x7b3
#define XK_Greek_finalsmallsigma                       0x7f3
#define XK_Greek_gamma                                 0x7e3
#define XK_Greek_horizbar                              0x7af
#define XK_Greek_iota                                  0x7e9
#define XK_Greek_iotaaccent                            0x7b4
#define XK_Greek_iotaaccentdieresis                    0x7b6
#define XK_Greek_iotadieresis                          0x7b5
#define XK_Greek_kappa                                 0x7ea
#define XK_Greek_lambda                                0x7eb
#define XK_Greek_lamda                                 0x7eb
#define XK_Greek_mu                                    0x7ec
#define XK_Greek_nu                                    0x7ed
#define XK_Greek_omega                                 0x7f9
#define XK_Greek_omegaaccent                           0x7bb
#define XK_Greek_omicron                               0x7ef
#define XK_Greek_omicronaccent                         0x7b7
#define XK_Greek_phi                                   0x7f6
#define XK_Greek_pi                                    0x7f0
#define XK_Greek_psi                                   0x7f8
#define XK_Greek_rho                                   0x7f1
#define XK_Greek_sigma                                 0x7f2
#define XK_Greek_switch         0xFF7E  
#define XK_Greek_tau                                   0x7f4
#define XK_Greek_theta                                 0x7e8
#define XK_Greek_upsilon                               0x7f5
#define XK_Greek_upsilonaccent                         0x7b8
#define XK_Greek_upsilonaccentdieresis                 0x7ba
#define XK_Greek_upsilondieresis                       0x7b9
#define XK_Greek_xi                                    0x7ee
#define XK_Greek_zeta                                  0x7e6
#define XK_H                   0x048
#define XK_Hcircumflex         0x2a6
#define XK_Hebrew_switch        0xFF7E  
#define XK_Hstroke             0x2a1
#define XK_I                   0x049
#define XK_Iabovedot           0x2a9
#define XK_Iacute              0x0cd
#define XK_Icircumflex         0x0ce
#define XK_Idiaeresis          0x0cf
#define XK_Igrave              0x0cc
#define XK_Imacron             0x3cf
#define XK_Iogonek             0x3c7
#define XK_Itilde              0x3a5
#define XK_J                   0x04a
#define XK_Jcircumflex         0x2ac
#define XK_K                   0x04b
#define XK_Kcedilla            0x3d3
#define XK_L                   0x04c




#define XK_Lacute              0x1c5
#define XK_Lcaron              0x1a5
#define XK_Lcedilla            0x3a6
#define XK_Lstroke             0x1a3
#define XK_M                   0x04d

#define XK_Macedonia_DSE                               0x6b5
#define XK_Macedonia_GJE                               0x6b2
#define XK_Macedonia_KJE                               0x6bc
#define XK_Macedonia_dse                               0x6a5
#define XK_Macedonia_gje                               0x6a2
#define XK_Macedonia_kje                               0x6ac
#define XK_N                   0x04e
#define XK_Nacute              0x1d1
#define XK_Ncaron              0x1d2
#define XK_Ncedilla            0x3d1
#define XK_Ntilde              0x0d1
#define XK_O                   0x04f
#define XK_Oacute              0x0d3
#define XK_Ocircumflex         0x0d4
#define XK_Odiaeresis          0x0d6
#define XK_Odoubleacute        0x1d5
#define XK_Ograve              0x0d2
#define XK_Omacron             0x3d2
#define XK_Ooblique            0x0d8
#define XK_Otilde              0x0d5
#define XK_P                   0x050
#define XK_Q                   0x051
#define XK_R                   0x052
#define XK_Racute              0x1c0
#define XK_Rcaron              0x1d8
#define XK_Rcedilla            0x3a3
#define XK_S                   0x053
#define XK_Sacute              0x1a6
#define XK_Scaron              0x1a9
#define XK_Scedilla            0x1aa
#define XK_Scircumflex         0x2de
#define XK_Serbian_DJE                                 0x6b1
#define XK_Serbian_DZE                                 0x6bf  
#define XK_Serbian_JE                                  0x6b8  
#define XK_Serbian_LJE                                 0x6b9  
#define XK_Serbian_NJE                                 0x6ba  
#define XK_Serbian_TSHE                                0x6bb
#define XK_Serbian_dje                                 0x6a1
#define XK_Serbian_dze                                 0x6af  
#define XK_Serbian_je                                  0x6a8  
#define XK_Serbian_lje                                 0x6a9  
#define XK_Serbian_nje                                 0x6aa  
#define XK_Serbian_tshe                                0x6ab
#define XK_T                   0x054
#define XK_THORN               0x0de
#define XK_Tcaron              0x1ab
#define XK_Tcedilla            0x1de
#define XK_Thai_maihanakat_maitho   			0xdde
#define XK_Thorn               0x0de	
#define XK_Tslash              0x3ac
#define XK_U                   0x055
#define XK_Uacute              0x0da
#define XK_Ubreve              0x2dd
#define XK_Ucircumflex         0x0db
#define XK_Udiaeresis          0x0dc
#define XK_Udoubleacute        0x1db
#define XK_Ugrave              0x0d9
#define XK_Ukrainian_I                                 0x6b6
#define XK_Ukrainian_IE                                0x6b4
#define XK_Ukrainian_YI                                0x6b7
#define XK_Ukrainian_i                                 0x6a6
#define XK_Ukrainian_ie                                0x6a4
#define XK_Ukrainian_yi                                0x6a7
#define XK_Ukranian_I                                  0x6b6  
#define XK_Ukranian_JE                                 0x6b4  
#define XK_Ukranian_YI                                 0x6b7  
#define XK_Ukranian_i                                  0x6a6  
#define XK_Ukranian_je                                 0x6a4  
#define XK_Ukranian_yi                                 0x6a7  
#define XK_Umacron             0x3de
#define XK_Uogonek             0x3d9
#define XK_Uring               0x1d9
#define XK_Utilde              0x3dd
#define XK_V                   0x056
#define XK_W                   0x057
#define XK_X                   0x058

#define XK_Y                   0x059
#define XK_Yacute              0x0dd
#define XK_Z                   0x05a
#define XK_Zabovedot           0x1af
#define XK_Zacute              0x1ac
#define XK_Zcaron              0x1ae
#define XK_a                   0x061
#define XK_aacute              0x0e1
#define XK_abovedot            0x1ff
#define XK_abreve              0x1e3
#define XK_acircumflex         0x0e2
#define XK_acute               0x0b4
#define XK_adiaeresis          0x0e4
#define XK_ae                  0x0e6
#define XK_agrave              0x0e0
#define XK_amacron             0x3e0
#define XK_ampersand           0x026
#define XK_aogonek             0x1b1
#define XK_apostrophe          0x027
#define XK_approximate                                 0x8c8
#define XK_aring               0x0e5
#define XK_asciicircum         0x05e
#define XK_asciitilde          0x07e
#define XK_asterisk            0x02a
#define XK_at                  0x040
#define XK_atilde              0x0e3
#define XK_b                   0x062
#define XK_backslash           0x05c
#define XK_ballotcross                                 0xaf4
#define XK_bar                 0x07c
#define XK_blank                                       0x9df
#define XK_botintegral                                 0x8a5
#define XK_botleftparens                               0x8ac
#define XK_botleftsqbracket                            0x8a8
#define XK_botleftsummation                            0x8b2
#define XK_botrightparens                              0x8ae
#define XK_botrightsqbracket                           0x8aa
#define XK_botrightsummation                           0x8b6
#define XK_bott                                        0x9f6
#define XK_botvertsummationconnector                   0x8b4
#define XK_braceleft           0x07b
#define XK_braceright          0x07d
#define XK_bracketleft         0x05b
#define XK_bracketright        0x05d
#define XK_breve               0x1a2
#define XK_brokenbar           0x0a6
#define XK_c                   0x063
#define XK_cabovedot           0x2e5
#define XK_cacute              0x1e6
#define XK_careof                                      0xab8
#define XK_caret                                       0xafc
#define XK_caron               0x1b7
#define XK_ccaron              0x1e8
#define XK_ccedilla            0x0e7
#define XK_ccircumflex         0x2e6
#define XK_cedilla             0x0b8
#define XK_cent        	       0x0a2
#define XK_checkerboard                                0x9e1
#define XK_checkmark                                   0xaf3
#define XK_circle                                      0xbcf
#define XK_club                                        0xaec
#define XK_colon               0x03a
#define XK_comma               0x02c
#define XK_copyright           0x0a9
#define XK_cr                                          0x9e4
#define XK_crossinglines                               0x9ee
#define XK_currency            0x0a4
#define XK_cursor                                      0xaff
#define XK_d                   0x064
#define XK_dagger                                      0xaf1
#define XK_dcaron              0x1ef
#define XK_decimalpoint                                0xabd
#define XK_degree              0x0b0
#define XK_diaeresis           0x0a8
#define XK_diamond                                     0xaed
#define XK_digitspace                                  0xaa5
#define XK_division            0x0f7
#define XK_dollar              0x024
#define XK_doubbaselinedot                             0xaaf
#define XK_doubleacute         0x1bd
#define XK_doubledagger                                0xaf2
#define XK_doublelowquotemark                          0xafe
#define XK_downarrow                                   0x8fe
#define XK_downcaret                                   0xba8
#define XK_downshoe                                    0xbd6
#define XK_downstile                                   0xbc4
#define XK_downtack                                    0xbc2
#define XK_dstroke             0x1f0
#define XK_e                   0x065
#define XK_eabovedot           0x3ec
#define XK_eacute              0x0e9
#define XK_ecaron              0x1ec
#define XK_ecircumflex         0x0ea
#define XK_ediaeresis          0x0eb
#define XK_egrave              0x0e8
#define XK_ellipsis                                    0xaae
#define XK_em3space                                    0xaa3
#define XK_em4space                                    0xaa4
#define XK_emacron             0x3ba
#define XK_emdash                                      0xaa9
#define XK_emfilledcircle                              0xade
#define XK_emfilledrect                                0xadf
#define XK_emopencircle                                0xace
#define XK_emopenrectangle                             0xacf
#define XK_emspace                                     0xaa1
#define XK_endash                                      0xaaa
#define XK_enfilledcircbullet                          0xae6
#define XK_enfilledsqbullet                            0xae7
#define XK_eng                 0x3bf
#define XK_enopencircbullet                            0xae0
#define XK_enopensquarebullet                          0xae1
#define XK_enspace                                     0xaa2
#define XK_eogonek             0x1ea
#define XK_equal               0x03d
#define XK_eth                 0x0f0
#define XK_exclam              0x021
#define XK_exclamdown          0x0a1
#define XK_f                   0x066
#define XK_femalesymbol                                0xaf8
#define XK_ff                                          0x9e3
#define XK_figdash                                     0xabb
#define XK_filledlefttribullet                         0xadc
#define XK_filledrectbullet                            0xadb
#define XK_filledrighttribullet                        0xadd
#define XK_filledtribulletdown                         0xae9
#define XK_filledtribulletup                           0xae8
#define XK_fiveeighths                                 0xac5
#define XK_fivesixths                                  0xab7
#define XK_fourfifths                                  0xab5
#define XK_function                                    0x8f6
#define XK_g                   0x067
#define XK_gabovedot           0x2f5
#define XK_gbreve              0x2bb
#define XK_gcedilla            0x3bb
#define XK_gcircumflex         0x2f8
#define XK_grave               0x060
#define XK_greater             0x03e
#define XK_greaterthanequal                            0x8be
#define XK_guillemotleft       0x0ab	
#define XK_guillemotright      0x0bb	
#define XK_h                   0x068
#define XK_hairspace                                   0xaa8
#define XK_hcircumflex         0x2b6
#define XK_heart                                       0xaee
#define XK_hebrew_aleph                                0xce0
#define XK_hebrew_ayin                                 0xcf2
#define XK_hebrew_bet                                  0xce1
#define XK_hebrew_beth                                 0xce1  
#define XK_hebrew_chet                                 0xce7
#define XK_hebrew_dalet                                0xce3
#define XK_hebrew_daleth                               0xce3  
#define XK_hebrew_doublelowline                        0xcdf
#define XK_hebrew_finalkaph                            0xcea
#define XK_hebrew_finalmem                             0xced
#define XK_hebrew_finalnun                             0xcef
#define XK_hebrew_finalpe                              0xcf3
#define XK_hebrew_finalzade                            0xcf5
#define XK_hebrew_finalzadi                            0xcf5  
#define XK_hebrew_gimel                                0xce2
#define XK_hebrew_gimmel                               0xce2  
#define XK_hebrew_he                                   0xce4
#define XK_hebrew_het                                  0xce7  
#define XK_hebrew_kaph                                 0xceb
#define XK_hebrew_kuf                                  0xcf7  
#define XK_hebrew_lamed                                0xcec
#define XK_hebrew_mem                                  0xcee
#define XK_hebrew_nun                                  0xcf0
#define XK_hebrew_pe                                   0xcf4
#define XK_hebrew_qoph                                 0xcf7
#define XK_hebrew_resh                                 0xcf8
#define XK_hebrew_samech                               0xcf1
#define XK_hebrew_samekh                               0xcf1  
#define XK_hebrew_shin                                 0xcf9
#define XK_hebrew_taf                                  0xcfa  
#define XK_hebrew_taw                                  0xcfa
#define XK_hebrew_tet                                  0xce8
#define XK_hebrew_teth                                 0xce8  
#define XK_hebrew_waw                                  0xce5
#define XK_hebrew_yod                                  0xce9
#define XK_hebrew_zade                                 0xcf6
#define XK_hebrew_zadi                                 0xcf6  
#define XK_hebrew_zain                                 0xce6
#define XK_hebrew_zayin                                0xce6  
#define XK_hexagram                                    0xada
#define XK_horizconnector                              0x8a3
#define XK_horizlinescan1                              0x9ef
#define XK_horizlinescan3                              0x9f0
#define XK_horizlinescan5                              0x9f1
#define XK_horizlinescan7                              0x9f2
#define XK_horizlinescan9                              0x9f3
#define XK_hstroke             0x2b1
#define XK_ht                                          0x9e2
#define XK_hyphen              0x0ad
#define XK_i                   0x069
#define XK_iacute              0x0ed
#define XK_icircumflex         0x0ee
#define XK_identical                                   0x8cf
#define XK_idiaeresis          0x0ef
#define XK_idotless            0x2b9
#define XK_ifonlyif                                    0x8cd
#define XK_igrave              0x0ec
#define XK_imacron             0x3ef
#define XK_implies                                     0x8ce
#define XK_includedin                                  0x8da
#define XK_includes                                    0x8db
#define XK_infinity                                    0x8c2
#define XK_integral                                    0x8bf
#define XK_intersection                                0x8dc
#define XK_iogonek             0x3e7
#define XK_itilde              0x3b5
#define XK_j                   0x06a
#define XK_jcircumflex         0x2bc
#define XK_jot                                         0xbca
#define XK_k                   0x06b
#define XK_kana_A                                      0x4b1
#define XK_kana_CHI                                    0x4c1
#define XK_kana_E                                      0x4b4
#define XK_kana_FU                                     0x4cc
#define XK_kana_HA                                     0x4ca
#define XK_kana_HE                                     0x4cd
#define XK_kana_HI                                     0x4cb
#define XK_kana_HO                                     0x4ce
#define XK_kana_HU                                     0x4cc  
#define XK_kana_I                                      0x4b2
#define XK_kana_KA                                     0x4b6
#define XK_kana_KE                                     0x4b9
#define XK_kana_KI                                     0x4b7
#define XK_kana_KO                                     0x4ba
#define XK_kana_KU                                     0x4b8
#define XK_kana_MA                                     0x4cf
#define XK_kana_ME                                     0x4d2
#define XK_kana_MI                                     0x4d0
#define XK_kana_MO                                     0x4d3
#define XK_kana_MU                                     0x4d1
#define XK_kana_N                                      0x4dd
#define XK_kana_NA                                     0x4c5
#define XK_kana_NE                                     0x4c8
#define XK_kana_NI                                     0x4c6
#define XK_kana_NO                                     0x4c9
#define XK_kana_NU                                     0x4c7
#define XK_kana_O                                      0x4b5
#define XK_kana_RA                                     0x4d7
#define XK_kana_RE                                     0x4da
#define XK_kana_RI                                     0x4d8
#define XK_kana_RO                                     0x4db
#define XK_kana_RU                                     0x4d9
#define XK_kana_SA                                     0x4bb
#define XK_kana_SE                                     0x4be
#define XK_kana_SHI                                    0x4bc
#define XK_kana_SO                                     0x4bf
#define XK_kana_SU                                     0x4bd
#define XK_kana_TA                                     0x4c0
#define XK_kana_TE                                     0x4c3
#define XK_kana_TI                                     0x4c1  
#define XK_kana_TO                                     0x4c4
#define XK_kana_TSU                                    0x4c2
#define XK_kana_TU                                     0x4c2  
#define XK_kana_U                                      0x4b3
#define XK_kana_WA                                     0x4dc
#define XK_kana_WO                                     0x4a6
#define XK_kana_YA                                     0x4d4
#define XK_kana_YO                                     0x4d6
#define XK_kana_YU                                     0x4d5
#define XK_kana_a                                      0x4a7
#define XK_kana_closingbracket                         0x4a3
#define XK_kana_comma                                  0x4a4
#define XK_kana_conjunctive                            0x4a5
#define XK_kana_e                                      0x4aa
#define XK_kana_fullstop                               0x4a1
#define XK_kana_i                                      0x4a8
#define XK_kana_middledot                              0x4a5  
#define XK_kana_o                                      0x4ab
#define XK_kana_openingbracket                         0x4a2
#define XK_kana_switch          0xFF7E  
#define XK_kana_tsu                                    0x4af
#define XK_kana_tu                                     0x4af  
#define XK_kana_u                                      0x4a9
#define XK_kana_ya                                     0x4ac
#define XK_kana_yo                                     0x4ae
#define XK_kana_yu                                     0x4ad
#define XK_kappa               0x3a2	
#define XK_kcedilla            0x3f3
#define XK_kra                 0x3a2
#define XK_l                   0x06c
#define XK_lacute              0x1e5
#define XK_latincross                                  0xad9
#define XK_lcaron              0x1b5
#define XK_lcedilla            0x3b6
#define XK_leftanglebracket                            0xabc
#define XK_leftarrow                                   0x8fb
#define XK_leftcaret                                   0xba3
#define XK_leftdoublequotemark                         0xad2
#define XK_leftmiddlecurlybrace                        0x8af
#define XK_leftopentriangle                            0xacc
#define XK_leftpointer                                 0xaea
#define XK_leftradical                                 0x8a1
#define XK_leftshoe                                    0xbda
#define XK_leftsinglequotemark                         0xad0
#define XK_leftt                                       0x9f4
#define XK_lefttack                                    0xbdc
#define XK_less                0x03c
#define XK_lessthanequal                               0x8bc
#define XK_lf                                          0x9e5
#define XK_logicaland                                  0x8de
#define XK_logicalor                                   0x8df
#define XK_lowleftcorner                               0x9ed
#define XK_lowrightcorner                              0x9ea
#define XK_lstroke             0x1b3
#define XK_m                   0x06d
#define XK_macron              0x0af
#define XK_malesymbol                                  0xaf7
#define XK_maltesecross                                0xaf0
#define XK_marker                                      0xabf
#define XK_masculine           0x0ba
#define XK_minus               0x02d
#define XK_minutes                                     0xad6
#define XK_mu                  0x0b5
#define XK_multiply            0x0d7
#define XK_musicalflat                                 0xaf6
#define XK_musicalsharp                                0xaf5
#define XK_n                   0x06e
#define XK_nabla                                       0x8c5
#define XK_nacute              0x1f1
#define XK_ncaron              0x1f2
#define XK_ncedilla            0x3f1
#define XK_nl                                          0x9e8
#define XK_nobreakspace        0x0a0
#define XK_notequal                                    0x8bd
#define XK_notsign             0x0ac
#define XK_ntilde              0x0f1
#define XK_numbersign          0x023
#define XK_numerosign                                  0x6b0
#define XK_o                   0x06f
#define XK_oacute              0x0f3
#define XK_ocircumflex         0x0f4
#define XK_odiaeresis          0x0f6
#define XK_odoubleacute        0x1f5
#define XK_ogonek              0x1b2
#define XK_ograve              0x0f2
#define XK_omacron             0x3f2
#define XK_oneeighth                                   0xac3
#define XK_onefifth                                    0xab2
#define XK_onehalf             0x0bd
#define XK_onequarter          0x0bc
#define XK_onesixth                                    0xab6
#define XK_onesuperior         0x0b9
#define XK_onethird                                    0xab0
#define XK_openrectbullet                              0xae2
#define XK_openstar                                    0xae5
#define XK_opentribulletdown                           0xae4
#define XK_opentribulletup                             0xae3
#define XK_ordfeminine         0x0aa
#define XK_oslash              0x0f8
#define XK_otilde              0x0f5
#define XK_overbar                                     0xbc0
#define XK_p                   0x070
#define XK_paragraph           0x0b6
#define XK_parenleft           0x028
#define XK_parenright          0x029
#define XK_partialderivative                           0x8ef
#define XK_percent             0x025
#define XK_period              0x02e
#define XK_periodcentered      0x0b7
#define XK_phonographcopyright                         0xafb
#define XK_plus                0x02b
#define XK_plusminus           0x0b1
#define XK_prescription                                0xad4
#define XK_prolongedsound                              0x4b0
#define XK_punctspace                                  0xaa6
#define XK_q                   0x071
#define XK_quad                                        0xbcc
#define XK_question            0x03f
#define XK_questiondown        0x0bf
#define XK_quotedbl            0x022
#define XK_quoteleft           0x060	
#define XK_quoteright          0x027	
#define XK_r                   0x072
#define XK_racute              0x1e0
#define XK_radical                                     0x8d6
#define XK_rcaron              0x1f8
#define XK_rcedilla            0x3b3
#define XK_registered          0x0ae
#define XK_rightanglebracket                           0xabe
#define XK_rightarrow                                  0x8fd
#define XK_rightcaret                                  0xba6
#define XK_rightdoublequotemark                        0xad3
#define XK_rightmiddlecurlybrace                       0x8b0
#define XK_rightmiddlesummation                        0x8b7
#define XK_rightopentriangle                           0xacd
#define XK_rightpointer                                0xaeb
#define XK_rightshoe                                   0xbd8
#define XK_rightsinglequotemark                        0xad1
#define XK_rightt                                      0x9f5
#define XK_righttack                                   0xbfc
#define XK_s                   0x073
#define XK_sacute              0x1b6
#define XK_scaron              0x1b9
#define XK_scedilla            0x1ba
#define XK_scircumflex         0x2fe
#define XK_script_switch        0xFF7E  
#define XK_seconds                                     0xad7
#define XK_section             0x0a7
#define XK_semicolon           0x03b
#define XK_semivoicedsound                             0x4df
#define XK_seveneighths                                0xac6
#define XK_signaturemark                               0xaca
#define XK_signifblank                                 0xaac
#define XK_similarequal                                0x8c9
#define XK_singlelowquotemark                          0xafd
#define XK_slash               0x02f
#define XK_soliddiamond                                0x9e0
#define XK_space               0x020
#define XK_ssharp              0x0df
#define XK_sterling            0x0a3
#define XK_t                   0x074
#define XK_tcaron              0x1bb
#define XK_tcedilla            0x1fe
#define XK_telephone                                   0xaf9
#define XK_telephonerecorder                           0xafa
#define XK_therefore                                   0x8c0
#define XK_thinspace                                   0xaa7
#define XK_thorn               0x0fe
#define XK_threeeighths                                0xac4
#define XK_threefifths                                 0xab4
#define XK_threequarters       0x0be
#define XK_threesuperior       0x0b3
#define XK_topintegral                                 0x8a4
#define XK_topleftparens                               0x8ab
#define XK_topleftradical                              0x8a2
#define XK_topleftsqbracket                            0x8a7
#define XK_topleftsummation                            0x8b1
#define XK_toprightparens                              0x8ad
#define XK_toprightsqbracket                           0x8a9
#define XK_toprightsummation                           0x8b5
#define XK_topt                                        0x9f7
#define XK_topvertsummationconnector                   0x8b3
#define XK_trademark                                   0xac9
#define XK_trademarkincircle                           0xacb
#define XK_tslash              0x3bc
#define XK_twofifths                                   0xab3
#define XK_twosuperior         0x0b2
#define XK_twothirds                                   0xab1
#define XK_u                   0x075
#define XK_uacute              0x0fa
#define XK_ubreve              0x2fd
#define XK_ucircumflex         0x0fb
#define XK_udiaeresis          0x0fc
#define XK_udoubleacute        0x1fb
#define XK_ugrave              0x0f9
#define XK_umacron             0x3fe
#define XK_underbar                                    0xbc6
#define XK_underscore          0x05f
#define XK_union                                       0x8dd
#define XK_uogonek             0x3f9
#define XK_uparrow                                     0x8fc
#define XK_upcaret                                     0xba9
#define XK_upleftcorner                                0x9ec
#define XK_uprightcorner                               0x9eb
#define XK_upshoe                                      0xbc3
#define XK_upstile                                     0xbd3
#define XK_uptack                                      0xbce
#define XK_uring               0x1f9
#define XK_utilde              0x3fd
#define XK_v                   0x076
#define XK_variation                                   0x8c1
#define XK_vertbar                                     0x9f8
#define XK_vertconnector                               0x8a6
#define XK_voicedsound                                 0x4de
#define XK_vt                                          0x9e9
#define XK_w                   0x077
#define XK_x                   0x078
#define XK_y                   0x079
#define XK_yacute              0x0fd
#define XK_ydiaeresis          0x0ff
#define XK_yen                 0x0a5
#define XK_z                   0x07a
#define XK_zabovedot           0x1bf
#define XK_zacute              0x1bc
#define XK_zcaron              0x1be
#define CHALLENGESIZE 16
#define FALSE 0
#define                INADDR_NONE     ((in_addr_t) 0xffffffff)
#  define LIBVNCSERVER_WORDS_BIGENDIAN 1
#define MAXPWLEN 8
#define MAX_ENCODINGS 64

#define RFB_INVALID_SOCKET (-1)
#define SOCKET int 
#define TRUE -1
#define Z_NULL NULL
#define rfbARD 30
#define rfbBell 2
#define rfbButton1Mask 1
#define rfbButton2Mask 2
#define rfbButton3Mask 4
#define rfbButton4Mask 8
#define rfbButton5Mask 16
#define rfbClientCutText 6
#define rfbCloseSocket close
#define rfbConnFailed 0
#define rfbEncodingCache                 0xFFFF0000
#define rfbEncodingCacheEnable           0xFFFF0001
#define rfbEncodingCacheZip              0xFFFF0007
#define rfbEncodingCoRRE 4
#define rfbEncodingCompressLevel0  0xFFFFFF00
#define rfbEncodingCompressLevel1  0xFFFFFF01
#define rfbEncodingCompressLevel2  0xFFFFFF02
#define rfbEncodingCompressLevel3  0xFFFFFF03
#define rfbEncodingCompressLevel4  0xFFFFFF04
#define rfbEncodingCompressLevel5  0xFFFFFF05
#define rfbEncodingCompressLevel6  0xFFFFFF06
#define rfbEncodingCompressLevel7  0xFFFFFF07
#define rfbEncodingCompressLevel8  0xFFFFFF08
#define rfbEncodingCompressLevel9  0xFFFFFF09
#define rfbEncodingCopyRect 1
#define rfbEncodingExtDesktopSize     0xFFFFFECC
#define rfbEncodingFineQualityLevel0   0xFFFFFE00
#define rfbEncodingFineQualityLevel100 0xFFFFFE64
#define rfbEncodingH264               0x48323634
#define rfbEncodingHextile 5
#define rfbEncodingKeyboardLedState   0xFFFE0000
#define rfbEncodingLastRect           0xFFFFFF20
#define rfbEncodingNewFBSize          0xFFFFFF21
#define rfbEncodingPointerPos      0xFFFFFF18
#define rfbEncodingQualityLevel0   0xFFFFFFE0
#define rfbEncodingQualityLevel1   0xFFFFFFE1
#define rfbEncodingQualityLevel2   0xFFFFFFE2
#define rfbEncodingQualityLevel3   0xFFFFFFE3
#define rfbEncodingQualityLevel4   0xFFFFFFE4
#define rfbEncodingQualityLevel5   0xFFFFFFE5
#define rfbEncodingQualityLevel6   0xFFFFFFE6
#define rfbEncodingQualityLevel7   0xFFFFFFE7
#define rfbEncodingQualityLevel8   0xFFFFFFE8
#define rfbEncodingQualityLevel9   0xFFFFFFE9
#define rfbEncodingRRE 2
#define rfbEncodingRaw 0
#define rfbEncodingRichCursor      0xFFFFFF11
#define rfbEncodingServerIdentity     0xFFFE0003
#define rfbEncodingSolMonoZip            0xFFFF0008
#define rfbEncodingSolidColor            0xFFFF0005
#define rfbEncodingSubsamp16X          0xFFFFFD05
#define rfbEncodingSubsamp1X           0xFFFFFD00
#define rfbEncodingSubsamp2X           0xFFFFFD02
#define rfbEncodingSubsamp4X           0xFFFFFD01
#define rfbEncodingSubsamp8X           0xFFFFFD04
#define rfbEncodingSubsampGray         0xFFFFFD03
#define rfbEncodingSupportedEncodings 0xFFFE0002
#define rfbEncodingSupportedMessages  0xFFFE0001
#define rfbEncodingTRLE 15
#define rfbEncodingTight 7
#define rfbEncodingTightPng 0xFFFFFEFC 
#define rfbEncodingUltra 9
#define rfbEncodingUltraZip              0xFFFF0009
#define rfbEncodingXCursor         0xFFFFFF10
#define rfbEncodingXOREnable             0xFFFF0006
#define rfbEncodingXORMonoColor_Zlib     0xFFFF0003
#define rfbEncodingXORMultiColor_Zlib    0xFFFF0004
#define rfbEncodingXOR_Zlib              0xFFFF0002
#define rfbEncodingXvp 			 0xFFFFFECB
#define rfbEncodingZRLE 16
#define rfbEncodingZYWRLE 17
#define rfbEncodingZlib 6
#define rfbEncodingZlibHex 8
#define rfbExtDesktopSize_ClientRequestedChange 1
#define rfbExtDesktopSize_GenericChange 0
#define rfbExtDesktopSize_InvalidScreenLayout 3
#define rfbExtDesktopSize_OtherClientRequestedChange 2
#define rfbExtDesktopSize_OutOfResources 2
#define rfbExtDesktopSize_ResizeProhibited 1
#define rfbExtDesktopSize_Success 0
#define rfbFileTransfer 7
#define rfbFileTransferVersion  2 
#define rfbFixColourMapEntries 1	
#define rfbFramebufferUpdate 0
#define rfbFramebufferUpdateRequest 3
#define rfbHextileExtractH(byte) (((byte) & 0xf) + 1)
#define rfbHextileExtractW(byte) (((byte) >> 4) + 1)
#define rfbHextileExtractX(byte) ((byte) >> 4)
#define rfbHextileExtractY(byte) ((byte) & 0xf)
#define rfbHextilePackWH(w,h) ((((w)-1) << 4) | ((h)-1))
#define rfbHextilePackXY(x,y) (((x) << 4) | (y))
#define rfbKeyEvent 4
#define rfbKeyboardMaskAlt          8
#define rfbKeyboardMaskAltGraph   512
#define rfbKeyboardMaskCapsLock     2
#define rfbKeyboardMaskControl      4
#define rfbKeyboardMaskHyper       64
#define rfbKeyboardMaskMeta        16
#define rfbKeyboardMaskNumLock    128
#define rfbKeyboardMaskScrollLock 256
#define rfbKeyboardMaskShift        1
#define rfbKeyboardMaskSuper       32
#define rfbMSLogon 0xfffffffa
#define rfbMax(a,b) (((a)>(b))?(a):(b))
#define rfbNoAuth 1
#define rfbPalmVNCReSizeFrameBuffer 0xF
#define rfbPalmVNCSetScaleFactor 0xF
#define rfbPointerEvent 5
#define rfbProtocolMajorVersion 3
#define rfbProtocolMinorVersion 8
#define rfbProtocolVersionFormat "RFB %03d.%03d\n"
#define rfbRA2 5
#define rfbRA2ne 6
#define rfbRErrorUnknownCmd     1  
#define rfbResizeFrameBuffer 4
#define rfbSASL 20
#define rfbSSPI 7
#define rfbSSPIne 8
#define rfbSecTypeInvalid 0
#define rfbSecTypeNone 1
#define rfbSecTypeVncAuth 2
#define rfbServerCutText 3
#define rfbSetColourMapEntries 1
#define rfbSetDesktopSize 251
#define rfbSetEncodings 2
#define rfbSetPixelFormat 0
#define rfbSetScale 8
#define rfbSocket int
#define rfbTLS 18
#define rfbTextChatFinished 0xFFFFFFFD  
#define rfbTight 16
#define rfbTightExplicitFilter         0x04
#define rfbTightFill                   0x08
#define rfbTightFilterCopy             0x00
#define rfbTightFilterGradient         0x02
#define rfbTightFilterPalette          0x01
#define rfbTightJpeg                   0x09
#define rfbTightMaxSubencoding         0x0A
#define rfbTightNoZlib                 0x0A
#define rfbTightPng                    0x0A
#define rfbUltra 17
#define rfbVeNCrypt 19
#define rfbVeNCryptPlain 256
#define rfbVeNCryptTLSNone 257
#define rfbVeNCryptTLSPlain 259
#define rfbVeNCryptTLSSASL 264
#define rfbVeNCryptTLSVNC 258
#define rfbVeNCryptX509None 260
#define rfbVeNCryptX509Plain 262
#define rfbVeNCryptX509SASL 263
#define rfbVeNCryptX509VNC 261
#define rfbVncAuth 2
#define rfbVncAuthFailed 1
#define rfbVncAuthOK 0
#define rfbVncAuthTooMany 2
#define rfbWheelDownMask rfbButton5Mask
#define rfbWheelUpMask rfbButton4Mask
#define rfbXvp 250
#define rfbXvp_Fail 0
#define rfbXvp_Init 1
#define rfbXvp_Reboot 3
#define rfbXvp_Reset 4
#define rfbXvp_Shutdown 2
#define rfbZRLETileHeight 64
#define rfbZRLETileWidth 64
#define rfbZipDirectoryPrefix   "!UVNCDIR-\0" 
#define strncasecmp _strnicmp
#define sz_rfbBellMsg 1
#define sz_rfbCacheRect 2
#define sz_rfbClientCutTextMsg 8
#define sz_rfbClientInitMsg 1
#define sz_rfbCoRRERectangle 4
#define sz_rfbCopyRect 4
#define sz_rfbExtDesktopScreen (16)
#define sz_rfbExtDesktopSizeMsg (4)
#define sz_rfbFixColourMapEntriesMsg 6
#define sz_rfbFramebufferUpdateMsg 4
#define sz_rfbFramebufferUpdateRectHeader (sz_rfbRectangle + 4)
#define sz_rfbFramebufferUpdateRequestMsg 10
#define sz_rfbKeyEventMsg 8
#define sz_rfbPalmVNCReSizeFrameBufferMsg (12)
#define sz_rfbPalmVNCSetScaleFactorMsg (4)
#define sz_rfbPixelFormat 16
#define sz_rfbPointerEventMsg 6
#define sz_rfbProtocolVersionMsg 12
#define sz_rfbRREHeader 4
#define sz_rfbRectangle 8
#define sz_rfbResizeFrameBufferMsg 6
#define sz_rfbServerCutTextMsg 8
#define sz_rfbServerInitMsg (8 + sz_rfbPixelFormat)
#define sz_rfbSetColourMapEntriesMsg 6
#define sz_rfbSetDesktopSizeMsg (8)
#define sz_rfbSetEncodingsMsg 4
#define sz_rfbSetPixelFormatMsg (sz_rfbPixelFormat + 4)
#define sz_rfbSetSWMsg 6
#define sz_rfbSetScaleMsg 4
#define sz_rfbSetServerInputMsg 4
#define sz_rfbSupportedMessages 64
#define sz_rfbTextChatMsg 8
#define sz_rfbXCursorColors 6
#define sz_rfbXvpMsg (4)
#define sz_rfbZRLEHeader 4
#define sz_rfbZipDirectoryPrefix 9 
#define sz_rfbZlibHeader 4
